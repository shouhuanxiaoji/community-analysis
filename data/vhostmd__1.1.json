{"master": [{"commit_oid": "51b7105ab2685da11ca7218939228e4a427261fc", "commit_date": "2023-06-23T21:22:12Z", "commit_message": "Change actions to retrieve vendor and product info\n\nOn a KVM host, the action to report VirtualizationVendor checks the\nvendor of the libvirt RPM, which is typically a meta-package that pulls\nin all of libvirt. This is undesirable on a minimalistic hypervisor.\nChange the action to check the vendor of the package owning\n/etc/os-release, which should be available on even the most minimal\nsystems and works for both Xen and KVM.\n\nThe VirtualizationProductInfo action reports inconsistent information\nbetween Xen and KVM. On a Xen host the Xen version is reported, whereas\nthe libvirt version is reported on a KVM host. Change the action to\nreport the \"Running hypervisor\" as reported by 'virsh version'.\n\nFixes: https://github.com/vhostmd/vhostmd/issues/7\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "27d6cbf362e0f1d553986bb6df22adea6e3d5fd3", "commit_date": "2023-06-23T20:41:13Z", "commit_message": "Add a 'unit' attribute to the metrics element\n\nAdd an optional 'unit' attribute to the <metrics> element. The\nvalue of 'unit' provided in a <metric> definition is opaque to vhostmd\nand returned as is when reporting the metric value.\n\nFixes: https://github.com/vhostmd/vhostmd/issues/8\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5896b548fe4a8218270253911999c647110a43a8", "commit_date": "2022-10-06T19:56:46Z", "commit_message": "Merge pull request #10 from srowe/master\n\nvif-stats.py: convert to Python3", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f397523515a109acd0d24821124b70ac7839e770", "commit_date": "2022-10-06T14:03:08Z", "commit_message": "vif-stats.py: convert to Python3\n\nPython2 has been EOL for nearly three years.\n\nSigned-off-by: Simon Rowe <simon.rowe@nutanix.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "99995e4ba138f43b277620bd43a096c72f354548", "commit_date": "2020-01-14T23:22:48Z", "commit_message": "virtio: Fix strncpy length parameter\n\nLeave an extra byte for null-terminator in call to strncpy. From\ncoverity scan\n\nvhostmd-1.1/vhostmd/virtio.c:194: buffer_size_warning: Calling \"strncpy\" with a maximum size argument of 108 bytes on destination array \"address.sun_path\" of size 108 bytes might leave the destination string unterminated.\n  192|       address.sun_family = AF_LOCAL;\n  193|\n  194|->     strncpy(address.sun_path, c->uds_name, SUN_PATH_LEN);\n  195|\n  196|       if ((c->fd = socket(AF_LOCAL, SOCK_STREAM, 0)) == -1)\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ff6959fd9203c667f6b4c95fa812621cc91dc42e", "commit_date": "2020-01-14T23:11:37Z", "commit_message": "vhostmd: Fix memory leak in vhostmd_run\n\nExample from coverity scan\n\nvhostmd-1.1/vhostmd/vhostmd.c:940: alloc_arg: \"vu_buffer_create\" allocates memory that is stored into \"buf\".\nvhostmd-1.1/vhostmd/vhostmd.c:959: leaked_storage: Variable \"buf\" going out of scope leaks the storage it points to.\n  957|            vu_log(VHOSTMD_ERR, \"Failed to start virtio thread '%s'\\n\",\n  958|                   strerror(rc));\n  959|->          return -1;\n  960|         }\n  961|      }\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d86c51d98ce8b891f3948f8aa54fc9634e6a8c67", "commit_date": "2020-01-14T23:04:09Z", "commit_message": "vhostmd: Check for valide file handle before calling close\n\nFrom coverity scan\n\nvhostmd-1.1/vhostmd/vhostmd.c:778: var_tested_neg: Assigning: \"fd\" = a negative value.\nvhostmd-1.1/vhostmd/vhostmd.c:845: negative_returns: \"fd\" is passed to a parameter that cannot be negative.\n  843|      free(dir);\n  844|      free(buf);\n  845|->    close(fd);\n  846|      return -1;\n  847|   }\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4f7b23e19c88c92d834d5f975c846b47eaa03c79", "commit_date": "2020-01-14T22:33:39Z", "commit_message": "vhostmd: Check return value of file functions\n\nCheck return value of ftruncate, lseek, and write functions as\nreported by coverity. Example from coverity scan\n\nvhostmd-1.1/vhostmd/vhostmd.c: scope_hint: In function 'metrics_disk_create'\nvhostmd-1.1/vhostmd/vhostmd.c:821:4: warning: ignoring return value of 'ftruncate', declared with attribute warn_unused_result [-Wunused-result]\n    ftruncate(fd, mdisk_size);\n    ^~~~~~~~~~~~~~~~~~~~~~~~~\n  819|\n  820|      /* truncate to a possible new size */\n  821|->    ftruncate(fd, mdisk_size);\n  822|\n  823|      /* zero fill metrics data */\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d9eeede678521776d327784d0307de6c98920bb8", "commit_date": "2020-01-14T22:12:28Z", "commit_message": "vhostmd: Remove unsafe XML_PARSE_NOENT option\n\nFrom coverity scan\n\nvhostmd-1.1/vhostmd/vhostmd.c:553: unsafe_xml_parse_config: XML parse option should not have flag \"XML_PARSE_NOENT\" set, which is vulnerable to XML external entty attack.\n  551|\n  552|      xml = xmlCtxtReadFile(pctxt, filename, NULL,\n  553|->                          XML_PARSE_NOENT | XML_PARSE_NONET |\n  554|                            XML_PARSE_NOWARNING);\n  555|      if (!xml) {\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "71a94a18c470ebbd870253b8aedbb7b3b24a274b", "commit_date": "2020-01-14T22:08:54Z", "commit_message": "vhostmd: Fix memory leak in parse_transports\n\nFrom coverity scan\n\nvhostmd-1.1/vhostmd/vhostmd.c:455: alloc_fn: Storage is returned from allocation function \"xmlXPathEval\".\nvhostmd-1.1/vhostmd/vhostmd.c:455: var_assign: Assigning: \"obj\" = storage returned from \"xmlXPathEval((xmlChar *)\"//vhostmd/globals/transport\", ctxt)\".\nvhostmd-1.1/vhostmd/vhostmd.c:474: leaked_storage: Variable \"obj\" going out of scope leaks the storage it points to.\n  472|   #else\n  473|   \t     vu_log (VHOSTMD_ERR, \"No support for xenstore transport in this vhostmd\");\n  474|-> \t     return -1;\n  475|   #endif\n  476|   \t }\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1771ddb83fe8a8cb38e7bee212bdfa3d1927cfc5", "commit_date": "2020-01-07T18:52:23Z", "commit_message": "Check return value of asprintf\n\nExample from coverity scan\n\nvhostmd-1.1/vhostmd/util.c: scope_hint: In function 'vu_append_string'\nvhostmd-1.1/vhostmd/util.c:484:7: warning: ignoring return value of 'asprintf', declared with attribute warn_unused_result [-Wunused-result]\n       asprintf(&cp, \"%s,%s\", *dest, str);\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4350fcf7a5c4cb7d803db1a0df2b757230b90e25", "commit_date": "2020-01-07T18:47:33Z", "commit_message": "util: Check return value of strstr\n\nFrom coverity scan\n\nvhostmd-1.1/vhostmd/util.c:421: returned_null: \"strstr\" returns \"NULL\" (checked 6 out of 7 times).\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b39f7cc778903e9cda8aa46d170b9efe80efda89", "commit_date": "2020-01-07T18:42:01Z", "commit_message": "util: Fix potential memory leak\n\nFrom coverity scan\n\nvhostmd-1.1/vhostmd/util.c:415:14: warning: Potential leak of memory pointed to by 'cp'\n      return(NULL);\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "69fcc2075d7cb1f16eb7d27ae3559fa3c77f5514", "commit_date": "2020-01-07T18:36:56Z", "commit_message": "util: Add missing call to va_end\n\nFrom coverity scan\n\nError: VARARGS (CWE-237):\nvhostmd-1.1/vhostmd/util.c:209: va_init: Initializing va_list \"argptr\".\nvhostmd-1.1/vhostmd/util.c:218: missing_va_end: va_end was not called for \"argptr\".\n  216|           grow_size = (count > 1000) ? count : 1000;\n  217|           if (buffer_grow(buf, grow_size) < 0)\n  218|->             return;\n  219|\n  220|           size = buf->size - buf->use - 1;\n\nError: VARARGS (CWE-237):\nvhostmd-1.1/vhostmd/util.c:209: va_init: Initializing va_list \"argptr\".\nvhostmd-1.1/vhostmd/util.c:226: missing_va_end: va_end was not called for \"argptr\".\n  224|       buf->use += count;\n  225|       buf->content[buf->use] = '\\0';\n  226|-> }\n  227|\n  228|   /*\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cba4dddebc56886034038f907085da3c6b50baab", "commit_date": "2020-01-07T01:59:18Z", "commit_message": "libmetrics: Fix potential leak of FILE pointer\n\nFrom coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c:892: alloc_fn: Storage is returned from allocation function \"fopen\".\nvhostmd-1.1/libmetrics/libmetrics.c:892: var_assign: Assigning: \"fp\" = storage returned from \"fopen(dest_file, \"w\")\".\nvhostmd-1.1/libmetrics/libmetrics.c:900: noescape: Resource \"fp\" is not freed or pointed-to in \"fwrite\".\nvhostmd-1.1/libmetrics/libmetrics.c:909: leaked_storage: Variable \"fp\" going out of scope leaks the storage it points to.\n  907|           free(response);\n  908|\n  909|->     return 0;\n  910|\n  911|     error:\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bc5da0b99699bbeb653b86398a7112bc0885c31e", "commit_date": "2020-01-07T01:51:40Z", "commit_message": "libmetrics: Use proper conversion specifier when calling log function\n\nFrom coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c:817: invalid_type: Argument \"5L\" to format specifier \"%u\" was expected to have type \"unsigned int\" but has type \"long\".\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2cbce5fcb652226bf159f9cd9649f5869d76f6b7", "commit_date": "2020-01-07T01:40:33Z", "commit_message": "libmetrics: Fix potential memory leak\n\nFrom coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c:613:18: warning: Potential leak of memory pointed to by 'pmdef.context'\n         errno = ENOMEM;\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "855326a8c9ec1a599354f743fb5391a2766a2a9c", "commit_date": "2020-01-07T00:47:10Z", "commit_message": "libmetrics: Ensure libmetrics mutex is unlocked in error paths\n\nFrom coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c:595: missing_unlock: Returning without unlocking \"libmetrics_mutex\".\n  593|          if (mdisk_alloc() == NULL) {\n  594|              errno = ENOMEM;\n  595|->            return -1;\n  596|          }\n  597|          read_mdisk(mdisk);\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3d4f3acdfc9f937bea946bb1c7dfad1f3516a6ce", "commit_date": "2020-01-07T00:42:39Z", "commit_message": "libmetrics: Remove unsafe XML_PARSE_NOENT option\n\nFrom coverity scan\n\nError: UNSAFE_XML_PARSE_CONFIG:\nvhostmd-1.1/libmetrics/libmetrics.c:412: unsafe_xml_parse_config: XML parse option should not have flag \"XML_PARSE_NOENT\" set, which is vulnerable to XML external entity attack.\n  410|      mdisk->doc = xmlCtxtReadMemory(mdisk->pctxt, mdisk->buffer,\n  411|              mdisk->length, \"mdisk.xml\", NULL,\n  412|->            XML_PARSE_NOENT | XML_PARSE_NONET |\n  413|              XML_PARSE_NOWARNING);\n  414|      if (!mdisk->doc) {\n\nIt should be safe to remove the option.\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f659ec774221532cc5452a07418e2ab1385f162c", "commit_date": "2020-01-06T23:52:30Z", "commit_message": "libmetrics: Check return value of asprintf\n\nExmaple from coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c: scope_hint: In function 'get_mdef'\nvhostmd-1.1/libmetrics/libmetrics.c:231:4: warning: ignoring return value of 'asprintf', declared with attribute warn_unused_result [-Wunused-result]\n    asprintf(&xpath, \"//metrics/metric[name='%s'][@context='%s']\", pmdef->name, pmdef->context);\n    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9db959c9e3f83cb2a4fc07534462e769990d9631", "commit_date": "2020-01-06T23:48:07Z", "commit_message": "libmetrics: Initialize local variable 'ret' to failure\n\nThe get_mdef() and dump_xenstore_metrics() functions have local variables\nnamed 'ret' that are initialized to zero, meaning success. In failure paths\n'ret' is set to -1 before jumping to the 'out' label. Invert this logic by\ninitializing 'ret' to -1 and only setting it to success after the function\nbodies have successfully executed.\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "06e73264b2338d20aa6e3f17b9820be3768439bf", "commit_date": "2020-01-06T23:14:18Z", "commit_message": "libmetrics: Set pointer NULL after free\n\nFrom a coverity scan\n\nvhostmd-1.1/libmetrics/libmetrics.c:185:10: warning: Attempt to free released memory\n         free(mdisk->buffer);\n\nSome error conditions will call mdisk_content_free(), which could result\nin a double-free when the entire mdisk is freed and mdisk_content_free()\nis called again. Protect agains these potential double-frees by setting\nthe mdisk contents NULL after freeing them.\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "83cc269f6892852be94467cea771b3ad1da8a369", "commit_date": "2019-10-09T02:56:18Z", "commit_message": "Relax virtio requirement in config file\n\nWhen the virtio transport was introduced the schema was changed to\nrequire a <virtio> transport in vhostmd.conf. When updating existing\ndeployments without a virtio transport specified in vhostmd.conf,\nvhostmd fails to start\n\n/usr/sbin/vhostmd -d\n/etc/vhostmd/vhostmd.conf:41: element globals: validity error : Element\nglobals content does not follow the DTD, expecting (disk , virtio ,\nupdate_period , path , transport+), got (disk update_period path transport )\nvalidate_config_file(): Failed to validate :/etc/vhostmd/vhostmd.conf\nConfig file: /etc/vhostmd/vhostmd.conf, fails DTD validation\n\nRelax the requirement for virtio transport in the schema. With the\nintroduction of multiple transports perhaps the others shoud be optional\nas well, but requiring virtio is clearly a regression.\n\nSigned-off-by: Jim Fehlig <jfehlig@suse.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}]}