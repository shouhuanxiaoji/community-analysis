{"dependabot/submodules/composefs-cca8be4": [{"commit_oid": "7916cfb68decf04a70d675e0029d4fc71e335a5a", "commit_date": "2023-09-18T12:18:47Z", "commit_message": "build(deps): bump composefs from `af86742` to `cca8be4`\n\nBumps [composefs](https://github.com/containers/composefs) from `af86742` to `cca8be4`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/af867425799db92c92d35feb51d2c957f3e16ac7...cca8be49843385ce556fccf51f75821f70fb7769)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "92d25eb56bcb17ee117ef5b877de86dc828e823f", "commit_date": "2023-09-12T13:10:11Z", "commit_message": "Merge pull request #3039 from cgwalters/rust-switch-include", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "26dcd4f575ca36996904a76569344cdf59fc3598", "commit_date": "2023-09-11T21:16:41Z", "commit_message": "rust: Switch to using `include`\n\nThis way we don't randomly pick up bits from the C library\nunintentionally as things change on that side.\n\nI think the support for `!` in `include` may be relatively new\nand that's why the original author here chose to do things\nvia `exclude`.  But using `include` with a few specific exclusions\nis just way better.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b7e39eba074bae071545fe06738b710ffeacddb8", "commit_date": "2023-09-11T13:41:13Z", "commit_message": "Merge pull request #2054 from jlebon/pr/static-delta-fetch-no-scan\n\nlib/pull: Don't scan commit objects we fetch via deltas", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cd116a1e63aa9c7114b3ca5ee804fdafa57360af", "commit_date": "2023-09-11T02:17:13Z", "commit_message": "lib/pull: Drop static delta superblocks references\n\nWe don't need them long-lived anymore. They were just used for reporting\nat this point, but we can use the new `static_delta_targets` hash table\nsize for that now.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2fe88f80fae83e206f811003a072c73ceebcea59", "commit_date": "2023-09-09T01:09:09Z", "commit_message": "ci: Run cosa unprivileged\n\nAs a workaround for a virtiofs bug:\nhttps://gitlab.com/virtio-fs/virtiofsd/-/merge_requests/197\n\nxref coreos/coreos-assembler#3428 (comment)\n\nJust like in https://github.com/coreos/rpm-ostree/pull/4585.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fc5aef6fe6332fa7ddc057064afcabc3d6d680f4", "commit_date": "2023-09-08T21:49:25Z", "commit_message": "lib/pull: Don't scan commit objects we fetch via deltas\n\nWhen we're fetching a commit via static delta, we already take care of\nfetching the full commit, so there's no need to also scan it using the\nregular object workflow.\n\nCloses: #2053", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c8ed1c7a871c0cfe5ec1e4c0b0971f1433b62992", "commit_date": "2023-09-08T21:49:25Z", "commit_message": "lib/pull: Fix miscounting of missing metadata\n\nIf e.g. detached metadata or a parent commit is missing, we\ndon't consider it an error but we erroneously still increment the\n`n_fetched_metadata` counter, causing it to be higher than it should.\n\nThis will implicitly be tested by a test added in the next patch.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c2587b619a268bd83ab4924a905e0b325250b73", "commit_date": "2023-09-08T19:07:29Z", "commit_message": "app/pull-local: Add `--disable-static-delta`\n\nFor completeness with `pull`.\n\nPrep for using it in testing to assert we'll never use static deltas.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0ac8795686ab3c8ad4d7f993bea6ed69b39e9334", "commit_date": "2023-09-08T16:03:21Z", "commit_message": "Merge pull request #3038 from cgwalters/rust-drop-composefs\n\nrust: Drop composefs from crate", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6a948567293d9ed55cb8e05be52d47b038e5c8a0", "commit_date": "2023-09-08T11:52:44Z", "commit_message": "Merge pull request #3037 from cgwalters/add-labeler-flow\n\nci: Add an automatic labeler action", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2db17d210712079ba9cd145703739d8ec803719d", "commit_date": "2023-09-08T11:38:31Z", "commit_message": "rust: Drop composefs from crate\n\nThis greatly reduces the size.  TODO: switch to using `include`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "749857df67a4cc76b72c4684dd9e4f85f38b0ffc", "commit_date": "2023-09-08T11:24:56Z", "commit_message": "Merge pull request #3035 from cgwalters/release-rust\n\nrust/sys: Also bump semver for this", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "129969482ec305c25f3a097cd13c30070f2fb84a", "commit_date": "2023-09-07T21:38:59Z", "commit_message": "ci: Add an automatic labeler action\n\nTo automate a bit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1714e8371f7b12b492dbc17964fc26466df7ca56", "commit_date": "2023-09-07T20:21:39Z", "commit_message": "Merge pull request #3030 from ostreedev/dependabot/submodules/composefs-af86742\n\nbuild(deps): bump composefs from `d085fbf` to `af86742`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e52530b5e05864662103ea9abe942912b2fd5e9e", "commit_date": "2023-09-07T18:54:56Z", "commit_message": "rust/sys: Also bump semver for this\n\nSince we bumped the glib major.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4d3621db08473013e328d88d45f8610b0a71f405", "commit_date": "2023-09-06T13:39:35Z", "commit_message": "build(deps): bump composefs from `d085fbf` to `af86742`\n\nBumps [composefs](https://github.com/containers/composefs) from `d085fbf` to `af86742`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/d085fbf6c8364f3781de7988b13c0f6dbf9e975b...af867425799db92c92d35feb51d2c957f3e16ac7)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "00c04aefd3070aa6119f725e81b231daead0f7e3", "commit_date": "2023-09-06T13:32:33Z", "commit_message": "Merge pull request #3028 from ostreedev/dependabot/submodules/composefs-d085fbf\n\nbuild(deps): bump composefs from `597a766` to `d085fbf`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b0e328114d95f408b64dad18245e573db6ec7561", "commit_date": "2023-09-06T13:06:04Z", "commit_message": "Merge pull request #3029 from cgwalters/bump-glib\n\nrust: Port to glib 0.18", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aee1ab2c99697d977695ecc7abbc928797ee5881", "commit_date": "2023-09-01T12:44:25Z", "commit_message": "rust: Bump semver to 0.19\n\n- New glib 0.18 dependency\n- Drop cap-std APIs and features\n- Other minor changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cccc0f1a5b79e2c9d447ee04f123336abe9f1519", "commit_date": "2023-09-01T12:44:25Z", "commit_message": "rust: Port to glib 0.18\n\n- Also rolls up a few other changes in the C API\n- Drop `&mut` from `OstreeKernelArgs`; it now confuses type inference.\n  More generally while using `&mut` here was well intentioned, it\n  goes against the glib standard of mapping everything to `&` and\n  accepting interior mutability.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b60036dd92eaf10480a618179bb7b4c2baa078d3", "commit_date": "2023-09-01T12:27:47Z", "commit_message": "build(deps): bump composefs from `597a766` to `d085fbf`\n\nBumps [composefs](https://github.com/containers/composefs) from `597a766` to `d085fbf`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/597a76609574cf9133d1e17ec0a7b99877a0b709...d085fbf6c8364f3781de7988b13c0f6dbf9e975b)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5fe050f51a660d60cebe401de42c829f3247a955", "commit_date": "2023-08-31T21:48:15Z", "commit_message": "Merge pull request #3027 from cgwalters/drop-cap-std-public\n\nDrop cap-std from our public APIs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9121297e7b549d94fc5a5451ecf826e31507ef64", "commit_date": "2023-08-31T20:33:07Z", "commit_message": "ci: Move lints into main build\n\nAnd drop another hardcoded MSRV.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "242a9015248026a2335df3b503d320dd91d7b5cb", "commit_date": "2023-08-31T19:34:26Z", "commit_message": "rust: Bump rust-version = 1.70\n\nTo pick up the new `AsFd` etc.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "eec67ec109d63b516f7ba1991f343bb82ff41bb4", "commit_date": "2023-08-31T19:34:26Z", "commit_message": "Drop cap-std from our public APIs\n\nSince it bumped semver (when I didn't expect it to; xref\nhttps://github.com/bytecodealliance/cap-std/commit/963eebf3ab52b04a2e8b9ba88ce6308bbed5cbd0#r121651362\n\nIt's not load-bearing enough here to matter versus just passing\nan untyped file descriptor.\n\nThis mainly means that it will be the `glib` ecosystem which\nforces transitive semver bumps for us, not both.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e93ebd738598406cd8a8e57fdc341cf1f1d9baae", "commit_date": "2023-08-31T16:16:50Z", "commit_message": "Merge pull request #3018 from ostreedev/dependabot/submodules/composefs-597a766\n\nbuild(deps): bump composefs from `1aed878` to `597a766`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8d838230f188622b27909997f23e6415df132b44", "commit_date": "2023-08-31T15:30:26Z", "commit_message": "Merge pull request #3012 from cgwalters/default-early-prune\n\nsysroot: Promote the \"early prune\" behavior to default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d5cfbed5bc8e9f9e1884bad7e43831292bb872fc", "commit_date": "2023-08-31T14:25:59Z", "commit_message": "sysroot: Promote the \"early prune\" behavior to default\n\nI think we have enough testing for this, let's default it to\non, and change the variable to allow opt-out in case it does\nintroduce a regression.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c0014e0003e3411a2c1d2e183ac938100d21deed", "commit_date": "2023-08-30T20:24:37Z", "commit_message": "Merge pull request #2968 from cgwalters/drop-global-syncfs-by-default\n\ndeploy: Remove global `sync` by default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d976ec5657b6b8aa67241e21bfacca5b9ed857c4", "commit_date": "2023-08-30T20:14:28Z", "commit_message": "Merge pull request #3024 from cgwalters/clang-analyzer-fixes-5\n\nClang analyzer fixes 5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0d7b8ebc6b9ffaabf57a13361132a700deeb4f29", "commit_date": "2023-08-30T17:23:13Z", "commit_message": "build(deps): bump composefs from `1aed878` to `597a766`\n\nBumps [composefs](https://github.com/containers/composefs) from `1aed878` to `597a766`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/1aed8781d6ce617234175d5d3b0458f91a6e38f3...597a76609574cf9133d1e17ec0a7b99877a0b709)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "52dbed4d77698b9eeb829662c3ec300e8d258db1", "commit_date": "2023-08-30T13:58:01Z", "commit_message": "Merge pull request #3023 from ostreedev/dependabot/submodules/libglnx-54ad67d\n\nbuild(deps): bump libglnx from `c02eb59` to `54ad67d`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4eb3caca6962f9a9eb657292a2baef39a8fc71c3", "commit_date": "2023-08-30T13:23:13Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e1b6983291d08e7ef2e803ea105704038d22dab", "commit_date": "2023-08-30T13:19:42Z", "commit_message": "keyfile-utils: Quiet a clang-analyzer warning\n\nIt complains that we could leak memory if the return value\npointer isn't set.  That's actually a nonsensical case, there's\nno reason to call this and ignore the return value.\n\nSo change things to require it be set, and also change the\n`g_return_val_if_fail` to be hard assertions per our new policy.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3001ef2817b0eab887597457f9bdaa3a3569a362", "commit_date": "2023-08-30T12:21:09Z", "commit_message": "build(deps): bump libglnx from `c02eb59` to `54ad67d`\n\nBumps libglnx from `c02eb59` to `54ad67d`.\n\n---\nupdated-dependencies:\n- dependency-name: libglnx\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "03a198888fec714c30a7d01435086044e1574b5b", "commit_date": "2023-08-29T16:25:42Z", "commit_message": "Merge pull request #3020 from cgwalters/less-return-if-fail-1\n\nmutable-tree: Change some `g_return_if_fail` to `g_assert()`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5837f27ff52658c63e02a72c6fb5d6f2ed10cc04", "commit_date": "2023-08-29T16:25:24Z", "commit_message": "Merge pull request #3019 from cgwalters/more-analyzer-fixes-4\n\nmutable-tree: Quiet clang-analyzer warning", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "886f58005ffd8f214966b305a9f390703c556381", "commit_date": "2023-08-29T14:16:42Z", "commit_message": "mutable-tree: Change some `g_return_if_fail` to `g_assert()`\n\nWe did this in some prior patches because it's better for\nstatic analyzers; code is either reachable or not, and we don't\nwant the default desktop-style behavior of \"try to stumble on\nwithout crashing\".  It's just likely to lead to a crash somewhere\nelse.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "db4ca6e7acfb9e62764a3c1c006c49e13e225e7b", "commit_date": "2023-08-29T14:09:25Z", "commit_message": "mutable-tree: Quiet clang-analyzer warning\n\nThe warning here was about a use-after-free which is serious, but\nI don't think it was reachable in practice, because we'd only\nenter the second conditional if `contents_checksum != self->contents_checksum`,\nyet we made them the same thing here.\n\nNevertheless, refactor the code to do a direct return in this\ncase because that's basically what happened before, and doing\nso is a lot clearer.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d001729bef1217594dd10a005c9e6649f022dab3", "commit_date": "2023-08-29T04:11:36Z", "commit_message": "Merge pull request #3017 from cgwalters/more-analyzer-fixes-3\n\nMore analyzer fixes 3", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6538b1702bf45b427cf6827407da3cd3a2876fb0", "commit_date": "2023-08-28T21:29:57Z", "commit_message": "repo: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "369e4ddd934e2e702e594c5eb277052726ee4ac1", "commit_date": "2023-08-28T21:28:59Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5fc9eac0baf7c159ab21990f1a036713f72b5796", "commit_date": "2023-08-28T21:28:20Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bfb7482a2464d7cd9c267dcefed4485f71c4b1f7", "commit_date": "2023-08-28T21:27:04Z", "commit_message": "lib/commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ee8c13b160add030d2ff94ad714cede2f4ca9179", "commit_date": "2023-08-28T21:26:28Z", "commit_message": "lib/delta: Remove dead code\n\nFound by clang-analyzer.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3acdbac000da8110b6fba727c7ef976d7755fe06", "commit_date": "2023-08-28T20:10:58Z", "commit_message": "Merge pull request #3016 from cgwalters/more-analyzer-fixes-2\n\nMore analyzer fixes 2", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "89e13a954cfbb0256bf8ebcd286f68f133b7ec9e", "commit_date": "2023-08-28T14:44:15Z", "commit_message": "Merge pull request #2994 from cgwalters/refactor-composefs-warnings\n\nRefactor composefs warnings", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0beaf5c9acf54fe7b4052159b85ee74b0eb2d4eb", "commit_date": "2023-08-26T17:51:22Z", "commit_message": "pull: Quiet clang-analyzer warning\n\nJust used for side-effects.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e2779a7cf71587e02d0c70c064e013b498418774", "commit_date": "2023-08-26T16:26:39Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nThis is just another instance of the \"conditionally owned\"\npattern.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b40d4bbbadb6af84b57b1282596cb58d147484b", "commit_date": "2023-08-26T16:24:10Z", "commit_message": "pull: Add assertions to quiet clang-analyzer\n\nIt's warning the value can be NULL, but I don't think that's true.\nI believe we're just hitting analysis limit (the path length is 119).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0cfa5e86004bd5f79fe87155bc3448a60993e0e6", "commit_date": "2023-08-26T16:23:26Z", "commit_message": "lib/repo-finder: Squash memory leak\n\nWe want to free this value on each iteration; it's moved below\nif the value is used.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f8549a9e0233e15eb9086820d98277cb9518fc28", "commit_date": "2023-08-26T16:10:55Z", "commit_message": "Merge pull request #3013 from cgwalters/more-analyzer-fixes\n\n2023.6 coverity minor fixes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7c13631af52cb8ba7e87e2f8420d3d31b7d6c858", "commit_date": "2023-08-26T12:13:24Z", "commit_message": "Merge pull request #3006 from cgwalters/misc-c99-style-5\n\nMisc c99 style 5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1a16a7d6845d36c0810963f75243ad43ea69c593", "commit_date": "2023-08-25T20:59:28Z", "commit_message": "switchroot: Use g_new/g_free consistently\n\nCoverity complains about this, even though they're the same thing.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d3ede20ba00ddee262d1a53db1f63dd20aa9125f", "commit_date": "2023-08-25T20:57:12Z", "commit_message": "sign/ed25519: Fix two memory leaks\n\nSpotted by coverity.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a87789e818dddfad26d9870592ff441b765f2afc", "commit_date": "2023-08-25T20:56:07Z", "commit_message": "commit: Drop dead code\n\nCoverity points out that since we're now *always* initializing\nmetadata, the `create_empty_gvariant_dict()` is unreachable.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d36bf35c10a91d75e829f255f75ba16127943bbd", "commit_date": "2023-08-25T19:59:34Z", "commit_message": "switchroot: Lower config parser to otcore, add unit tests\n\nPart of the continuation of unit testing coverage.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "38880bff01a4ed858b8b3d53aa00057b27d5bfc9", "commit_date": "2023-08-25T19:23:06Z", "commit_message": "composefs: Hard error except on ENOENT even in \"optional\" case\n\nSince we enabled composefs at build time, the default (non-composefs)\ncase now always prints\n`composefs: Optional support failed: No such file or directory`\nBut that's normal and expected.\n\nRework things here so that in the very special case where\nwe are in \"maybe/optional\" mode and we get ENOENT, then we\noutput a much more normal-looking message that doesn't include\nthe string \"failed\".\n\nNow on the flip side - if I have explicitly enabled signature\nchecking, I think we *do* want to make that fatal even if\ncomposefs is in \"maybe\" mode.\n\n(This part is more debatable; perhaps we should just disallow\n the case of \"maybe\" + signatures at all; but I think this is\n an improvement in that direction)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e952b1bf1413feb21eb0cc9e2514eb9e1895f2cf", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Fold together composefs signature cases\n\nNow that we don't support digest-but-not-signature verification\nfor composefs, the logic here was unnecessarily complicated.\nWith a prior prep patch that moved the composefs option\ninitialization up, we can just have everything related to signature\nverification in a single conditonal.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1d316e31093e33eff6c3ae7f8081547ef93e72ed", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Init composefs options earlier\n\nPrep for a later patch.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa9b7c3b1b5866eb107e403f8c56d859fc4e22cb", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Drop redundant print about signature/digest\n\nWe print if we're doing a signature+digest verification; its absence is\nsufficient in the other case.  The goal here is to avoid polluting\nthe logs when signatures are not enabled.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4dd3cb3520a051536910441a06d2ef891ce48966", "commit_date": "2023-08-25T15:11:17Z", "commit_message": "Merge pull request #3005 from cgwalters/release\n\nRelease", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "97d83e6225c15763d4450f73f5f194f0b0ba2f3b", "commit_date": "2023-08-25T01:18:02Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "dab8051fd8b9aa464bd05b6401bf676ef9b1fcb5", "commit_date": "2023-08-25T01:18:02Z", "commit_message": "Release 2023.6", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bd91fda636075c05655b4336434bc036e6b92df9", "commit_date": "2023-08-25T01:13:07Z", "commit_message": "Merge pull request #3010 from cgwalters/more-composefs-fixes\n\nbuild-sys: Really fix composefs check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3648c5ae29ce823592708cc1b9cca4f202d282a4", "commit_date": "2023-08-24T23:58:20Z", "commit_message": "build-sys: Really fix composefs check\n\nThe ordering of the includes apparently matters...and I didn't\nactually check that the previous change enables composefs on c9s.\nBut I did now.  For reals.\n\nWhile we have the patient open, I switched to `AC_LANG_PROGRAM`\nbecause I originally thought the bug had something to do with that.\nAs far as I understand, more cleanly separating the includes\nfrom the injected body text is a useful thing in `AC_LANG_PROGRAM`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "db3b286d6ba1252ad87c2524de632c1ad736fb6e", "commit_date": "2023-08-24T23:38:22Z", "commit_message": "Merge pull request #3009 from cgwalters/c9s-ci\n\nC9s CI && composefs build detection fix", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bcd4d0260659eec066a9ee2928a458e2191258cf", "commit_date": "2023-08-24T22:01:26Z", "commit_message": "Merge pull request #3007 from cgwalters/optin-new-bootloader-naming\n\ndeploy: Add bootloader-naming-2 opt-in", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "33ef4ae620a1854d8f146b4506dcb5a5c5709cd0", "commit_date": "2023-08-24T21:25:14Z", "commit_message": "build-sys: Look for both linux/mount.h and sys/mount.h\n\nSince that's what composefs uses.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bd8339bda257d1d868be8817e076921600b99ea6", "commit_date": "2023-08-24T21:24:07Z", "commit_message": "ci: Add c9s build\n\nSince it's an active target of this project.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cbe36c3a3585f1fe849a6547a4caff72266360db", "commit_date": "2023-08-24T15:45:22Z", "commit_message": "Merge pull request #3008 from ostreedev/maybe_ostree\n\nprepare-root: If composefs is configured as \"maybe\" don't fail", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "29423a893c2a179eb7f64afd9800a474cda71d5a", "commit_date": "2023-08-24T14:20:25Z", "commit_message": "prepare-root: If composefs is configured as \"maybe\" don't fail\n\nIf composefs is configured as \"maybe\", we should continue even if\ncomposefs support is not built in.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "02d419079d649f18a62ee64542b3f3f28ea14edb", "commit_date": "2023-08-24T13:40:54Z", "commit_message": "deploy: Add bootloader-naming-2 opt-init\n\nI've verified that this fixes compatibility with GRUB, which\nparses the filename:\nhttps://github.com/ostreedev/ostree/issues/2961\n\nHowever, out of a large degree of conservatism I've made this\nan opt-in behavior for now.\n\nMy plan is to test it out in the FCOS development streams first.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fb06d59e75b720c0957148c04e488000a8e6af91", "commit_date": "2023-08-24T08:59:46Z", "commit_message": "Merge pull request #3003 from cgwalters/prepare-root-oscore-and-units\n\nMove prepare-root karg helpers into otcore, add unit tests", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cce1814c50d1062001df6c51e0fde454e7109b95", "commit_date": "2023-08-24T01:22:49Z", "commit_message": "cmd/show-remote-url: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "116fdc3c585fd6c71a175c8dc05a7035787649e8", "commit_date": "2023-08-24T01:21:01Z", "commit_message": "cmd/log: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e578c019c5d20348663e0371ad2d5bc4664f76ed", "commit_date": "2023-08-24T01:17:27Z", "commit_message": "cmd/export: Fold libarchive error handling\n\nThe helper function here doesn't quite carry its weight; this\nbrings us inline with having single line (no braces) error\nreturn paths.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88334b8f33792de715cdcfd64431608ccb41ce2f", "commit_date": "2023-08-24T01:14:53Z", "commit_message": "cmd/export: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "20b8cb174c3e3aa482a856f0a4323849ce7b05de", "commit_date": "2023-08-23T21:11:10Z", "commit_message": "Move prepare-root karg helpers into otcore, add unit tests\n\nAdd long overdue unit testing coverage for this, which\nat least slightly closes out the android boot CI gap.\n\nActually, this *copies* the karg parsing code into otcore because\nit now uses glib, which we're not yet using in the static\nprepare-root.  It's pretty tempting to drop support for the\nstatic prepare root entirely.  But for now we'll live with some\ncode duplication.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "445194921365d5552a052e8b91f51812799ac764", "commit_date": "2023-08-23T14:38:16Z", "commit_message": "Merge pull request #2997 from cgwalters/test-cleanups-1\n\ntests/destructive: Port more to xshell", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "37f247da02b391ce3c8c429ba4413820adcea314", "commit_date": "2023-08-23T14:37:48Z", "commit_message": "Merge pull request #2999 from cgwalters/add-oscore-units\n\ntests: Add otcore unit tests", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa8ad204d549743286ab73366bcf657dec23c9ed", "commit_date": "2023-08-22T23:06:14Z", "commit_message": "Merge pull request #3001 from cgwalters/misc-c99-style-4\n\nMisc c99 style 4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "75a43deb306e602b6e96d971ea305e7f62ac2355", "commit_date": "2023-08-22T21:51:33Z", "commit_message": "cmd/grub2-generate: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "767ca134b55ee057fd2100ae44c3adafb64854d9", "commit_date": "2023-08-22T21:49:28Z", "commit_message": "cmd/init: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3ef72ea8a385417d1c740c91ff701c7aac515c3", "commit_date": "2023-08-22T20:56:46Z", "commit_message": "Merge pull request #3000 from cgwalters/test-inst-update\n\ntests/inst: Update to latest ostree-ext", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6eeb8b5623659290af3b7f1d85746bab367cd77b", "commit_date": "2023-08-22T20:41:00Z", "commit_message": "Merge pull request #2995 from ostreedev/dependabot/submodules/composefs-1aed878\n\nbuild(deps): bump composefs from `a6e827d` to `1aed878`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e751dd9a7bc5752f7d80671dff271ebf6844e703", "commit_date": "2023-08-22T19:08:26Z", "commit_message": "Merge pull request #2998 from cgwalters/disable-composefs-too-old\n\nbuild-sys: Disable composefs on too-old Linux headers", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "facb9a1a60dd1e0cffb9cb3e2afa1f7ef7daef09", "commit_date": "2023-08-22T18:23:56Z", "commit_message": "tests/inst: Update to latest ostree-ext\n\n(And glib, etc.)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7c82340d082ea416c55763971e59150f08f3a388", "commit_date": "2023-08-22T18:11:50Z", "commit_message": "Merge pull request #2975 from ostreedev/androidboot-single-slot-mode\n\nprepare-root: On a non-A/B androidboot system, boot system slot a", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3f0c4d49cb3607c5b40b9e89650f2cc02ea24ff", "commit_date": "2023-08-22T17:04:46Z", "commit_message": "tests: Add otcore unit tests\n\nThis just stubs out the basic infrastructure, to be expanded upon.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "90e54619df34b33b8e3110cd94b2f0a390bbbce5", "commit_date": "2023-08-22T16:48:06Z", "commit_message": "build-sys: Disable composefs on too-old Linux headers\n\nThis should fix the build with Google OSS-fuzz which currently\nuses an old Ubuntu.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6e9e50d87c8869882de920c096125af36218ae06", "commit_date": "2023-08-22T15:43:20Z", "commit_message": "prepare-root: Changes made to find_proc_cmdline_key\n\nUsed strspn based on feedback from similar function.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "650a053795d53d3f5e3054a03b3341e828f58b2c", "commit_date": "2023-08-22T15:43:20Z", "commit_message": "prepare-root: On a non-A/B androidboot system, boot system slot a\n\nSometimes android bootloaders boot in a nonab way:\n\n  https://source.android.com/docs/core/ota/nonab\n\nIn this case, \"androidboot.\" kargs are present but not\n\"androidboot.slot_suffix\" specifically.\n\nIn this case, rather than getting stuck in a partially booted\nenvironment, boot system slot a.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "16b97d8a40c827b6d508b68b3779cca1d595547b", "commit_date": "2023-08-22T15:08:10Z", "commit_message": "Merge pull request #2996 from cgwalters/misc-c99-style-3\n\ncli/set-origin: Port to C99 style", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "578c87e7ef107b524ca38dd1bdad13db15328d19", "commit_date": "2023-08-22T13:52:43Z", "commit_message": "tests/destructive: Port more to xshell\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8f302f2a462a7df87b124a1df751d9299affea68", "commit_date": "2023-08-22T13:44:39Z", "commit_message": "cli/set-origin: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "69d7d837bedfa5e8498fc0f6c9c47d2596e9971e", "commit_date": "2023-08-22T12:59:46Z", "commit_message": "build(deps): bump composefs from `a6e827d` to `1aed878`\n\nBumps [composefs](https://github.com/containers/composefs) from `a6e827d` to `1aed878`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/a6e827df2dbebb65d6d19a7211f2fb4a61d989ac...1aed8781d6ce617234175d5d3b0458f91a6e38f3)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ee1e585ee9524e7a672e6b7725596dbb1d5e23f1", "commit_date": "2023-08-18T21:12:24Z", "commit_message": "Merge pull request #2993 from cgwalters/misc-c99-style-2\n\nMisc c99 style 2", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "22b47781fba21059372ec31ab6b2dd7b37eca583", "commit_date": "2023-08-18T19:39:45Z", "commit_message": "checkout: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "27266f90d92e2d42aea364d607eb30615da09ce3", "commit_date": "2023-08-18T01:49:33Z", "commit_message": "lzma: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "722fc2d060a884de17c086113b1ce8f5433c6ef1", "commit_date": "2023-08-17T23:19:21Z", "commit_message": "Merge pull request #2991 from cgwalters/misc-c99-style\n\nMisc c99 style", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9f39f78e838605b7bcf626083199fc5b7ebc71b6", "commit_date": "2023-08-17T21:03:17Z", "commit_message": "remote-add: Port to c99 style\n\n- Drop `goto out`\n- Use declare-and-initialize", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9036c96a045df1aba8653815879da9da68c6bb33", "commit_date": "2023-08-17T20:59:41Z", "commit_message": "admin: Port to c99 style\n\n- Drop `goto out`\n- Use declare-and-initialize", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9ac938c4ff1ef814de135696b85f969ecc139860", "commit_date": "2023-08-17T13:38:30Z", "commit_message": "Merge pull request #2989 from cgwalters/lock-timeout-longer\n\nrepo: Bump lock timeout to 5 minutes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f4b420492f3b529edbded78f04e405e38d4918ee", "commit_date": "2023-08-17T13:36:20Z", "commit_message": "Merge pull request #2973 from ostreedev/dependabot/submodules/composefs-a6e827d\n\nbuild(deps): bump composefs from `1704f82` to `a6e827d`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e88ec69eefa1e53ae7d660cb7be3c5a399ec4a22", "commit_date": "2023-08-17T12:28:16Z", "commit_message": "repo: Bump lock timeout to 5 minutes\n\nAnd update the doc text to talk about having a timeout at all\nby default being a mistake.\n\nTimeouts are really best handled at a higher level; if two processes\nare contending for the ostree lock and one is actually frozen,\nresolving this is something an admin may want to handle and introspect/debug\ninstead of having the waiter error out.\n\nMost people using ostree are doing it in a way in which they have\nhigher level timeouts (e.g. on a container pod).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "55121cc4df5cc713bbc1891b6046181374575cac", "commit_date": "2023-08-16T22:20:15Z", "commit_message": "Merge pull request #2988 from cgwalters/prepare-root-binding-key\n\nprepare-root: Minor clarifications", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d648eea6316d4e26f10ea3358bb8b759ceba8b2d", "commit_date": "2023-08-16T21:37:06Z", "commit_message": "Merge pull request #2987 from cgwalters/prefix-stage-deploy\n\ndeploy: Add some error prefixing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "94cb37cb3080cb0377e0f922e84411ba256190a7", "commit_date": "2023-08-16T20:56:12Z", "commit_message": "prepare-root: Minor clarifications\n\nNo functional changes.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "25a458b94b89b1d97fae1fdf763776a47575ee29", "commit_date": "2023-08-16T20:16:24Z", "commit_message": "deploy: Add some error prefixing\n\nWe saw a bare\n`Txn Rebase on <osname> failed: Failed to find kernel in /usr/lib/modules, /usr/lib/ostree-boot or /boot`\nwhich isn't bad, but it'd be better to be a bit more specific.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8712a46756e25260f47ee45f4e35dc3903761527", "commit_date": "2023-08-16T18:31:35Z", "commit_message": "Merge pull request #2985 from cgwalters/cleanup-proc-cmdline\n\nswitchroot,generator: Only read /proc/cmdline once", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "083bad8cf22981831879995dfeb7c3124921831c", "commit_date": "2023-08-16T13:05:39Z", "commit_message": "Merge pull request #2984 from alexlarsson/prepare-root-no-raw-key\n\nprepare-root: Only support base64 formated public key files", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "28aed49d87902aff650d1df90e3b72d64c70729d", "commit_date": "2023-08-16T13:05:19Z", "commit_message": "switchroot,generator: Only read /proc/cmdline once\n\nChange the helper function to parse an existing cmdline instead\nof potentially reading `/proc/cmdline` multiple times.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0a79b3b1e298117d5d951e171caa569b041ec627", "commit_date": "2023-08-16T09:00:43Z", "commit_message": "prepare-root: Only support base64 formated public key files\n\nI've updated the automotive samples to not use the raw format, so\nthere is no use anymore to support both formats, as base64 is strictly\nbetter.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c94388f3dd0e4617f6183f74288e8827e06e61f7", "commit_date": "2023-08-16T08:56:20Z", "commit_message": "Merge pull request #2980 from cgwalters/prepare-root-minor\n\nPrepare root minor", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "871d32a591a256c4d0077c1d921b5d9d6e01903c", "commit_date": "2023-08-14T18:36:50Z", "commit_message": "prepare-root: Use ptrarray, not linked list\n\nLinked lists are a data structure with only very obscure\nuse cases, and this is a classic one where since we're appending\nit's O(N^2) behavior.\n\nAlso we were leaking the memory.\n\nIt's more ergonomic, clearer and efficient to use a ptrarray.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "678bfcd934e135a28fef172db675a0ae81ae85b1", "commit_date": "2023-08-14T18:30:42Z", "commit_message": "prepare-root: Check for empty string, not strlen > 0\n\nNo point in doing a full strlen, we can just check the first byte.\nAlso, invert the conditional using `continue` to avoid another\nlevel of indentation.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bea5d897a810302263779fcd1542310481626368", "commit_date": "2023-08-14T18:29:39Z", "commit_message": "prepare-root: Use declare-and-initialize\n\nThis is our default style.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3620d3c709a4083a7bd63323b24bd17db4f3ed4b", "commit_date": "2023-08-14T15:47:05Z", "commit_message": "Merge pull request #2979 from cgwalters/enabled-discussions\n\nREADME.md: Drop dead mailing list, link to GH discussions", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d324f6843b4dd459501d18f11990224428873be8", "commit_date": "2023-08-14T15:46:38Z", "commit_message": "Merge pull request #2974 from alexlarsson/composefs-config-file\n\nRead composefs configuration from initrd instead of commandline", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f1c1f819ff8632b9bdac8d859c54be4c09ab6d62", "commit_date": "2023-08-14T13:49:41Z", "commit_message": "README.md: Drop dead mailing list, link to GH discussions\n\nWhile I resisted taking the next step in binding ourselves\nmore to GH with discussions...it's way, way better than answering\nquestions out of band in private (also proprietary) chats.\n\nWe haven't been successful in using the GNOME discussion forums.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "81fa21415566ed45aa8aa154819b02955dc750a8", "commit_date": "2023-08-14T10:27:47Z", "commit_message": "Read composefs configuration from initrd instead of commandline\n\nThis drops the `ot-composefs` kernel commandline in favour\nof a `[composefs]` section in the `prepare-rootfs.conf` file.\n\nYou can set `composefs.enabled` to `signed`, `yes`, `no` or `maybe`,\nwith `maybe` being the default.\n\nYou can also set `composefs.keypath` (or rely on the default\n`/etc/ostree/initramfs-root-binding.key`) to point to ed25519 public\nkeys, one of which which the commit must be signed with, or boot\nfails.\n\nThe ostree dracut module adds `/etc/ostree/initramfs-root-binding.key`\nto the initrd if it exists.\n\nNOTE: This drop the option to define a digest in the commandline.\nHowever, that was currently unused\n(i.e. ComposefsConfig.expected_digest was never read).\n\nAdditionally it very hard to actually store the composefs digest in\nthe initrd, as the initrd is typically part of the commit and thus the\ncomposefs. It may be possible to handle this, but lets add it back\nwhen we know exactly how that will work.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2cc6b531996d016b3c6d114deb1c3f6f29162d02", "commit_date": "2023-08-08T13:24:35Z", "commit_message": "Merge pull request #2966 from cgwalters/ostree-admin-edit\n\nAdd `admin set-default`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b108e24c3191eadb85a99bc23f4e28182a0becc4", "commit_date": "2023-08-08T12:05:10Z", "commit_message": "build(deps): bump composefs from `1704f82` to `a6e827d`\n\nBumps [composefs](https://github.com/containers/composefs) from `1704f82` to `a6e827d`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/1704f823db41b1056cabfba51254f8afa8bae41d...a6e827df2dbebb65d6d19a7211f2fb4a61d989ac)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c57c00569c5ebb982882bdda9f399f1ad181df6a", "commit_date": "2023-08-05T15:48:28Z", "commit_message": "Merge pull request #2958 from cgwalters/deploy-loosen-etc-usretc\n\ndeploy: Support an empty `/etc` and populated `/usr/etc`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7f70614a1ac1950ebde3df0e26cc9ab1d72b2f1f", "commit_date": "2023-08-04T15:34:13Z", "commit_message": "Merge pull request #2969 from cgwalters/fix-sync-pthreads\n\ndeploy: Fix mutex locking for global sync timeout", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a31f7798716c071c12e4a91153ca6d5bcddb3834", "commit_date": "2023-08-04T09:07:09Z", "commit_message": "Merge pull request #2967 from cgwalters/drop-trivial-httpd-entrypoint\n\nMore fully drop `trivial-httpd` entrypoint", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "402e04280b54c058ad47be99fe6a9326caf2ae00", "commit_date": "2023-08-04T03:10:06Z", "commit_message": "deploy: Fix mutex locking for global sync timeout\n\nThe locking here was always too long - by holding the mutex\nduring the `sync()` call, it means `g_cond_wait_until()` can\nnever wake up (because its API requires the mutex to be locked).\n\nConfusingly though of course we do still print the \"timed out\"\nmessage, and I think that tricked us when we were doing testing\nhere.\n\nWe only need to lock the mutex when we're manipulating shared\nstate, which basically boils down to the `gboolean success`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "60b4655677b39bf4a69da9f395f787ed5a95fe3c", "commit_date": "2023-08-03T19:10:11Z", "commit_message": "More fully drop `trivial-httpd` entrypoint\n\nIt's just part of the tests and we should no longer\nsupport `ostree trivial-httpd`.\n\nThis is a followup cleanup to previous work.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3cd3251aa1bd8986b1a46ddaaf98563d149bf4d3", "commit_date": "2023-08-03T19:09:57Z", "commit_message": "Add `admin set-default`\n\nA core underlying primitive in the C library is the ability\nto arbitrarily reorder bootloader entries.\n\nLet's expose the basic functionality here with the ability to pick\nan arbitrarily deployment for the next boot.\n\nCloses: https://github.com/ostreedev/ostree/issues/2965", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "09160c1a2b553e39e417a64c254f62470ce2dce5", "commit_date": "2023-08-02T19:41:32Z", "commit_message": "Merge pull request #2962 from cgwalters/os-init-remount\n\nos-init: Create a mount namespace", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ac42e29d667d88858f44f2260b1153873e9261be", "commit_date": "2023-08-02T18:32:22Z", "commit_message": "os-init: Create a mount namespace\n\nToday on anything using readonly sysroot `os-init` fails, because\nwe don't create a mount namespace if the `UNLOCKED` flag is specified\nbecause we assume it's a readonly operation.\n\nSince technically this is a mutation, let's just lock the sysroot\nand use the tested path.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "113e575e8ed189d3fd5bfa793026f61992294343", "commit_date": "2023-08-02T17:44:05Z", "commit_message": "Merge pull request #2963 from cgwalters/more-gfileinfo-fix\n\ncomposefs: Only call `_get_symlink_target()` on symlinks", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "15cb0b47b1fa0f21fe1c935baa23ec4cde77f1cc", "commit_date": "2023-08-02T01:29:04Z", "commit_message": "composefs: Only call `_get_symlink_target()` on symlinks\n\nThis fixes a warning from newer glib that we're now seeing\nin the Debian testing CI runs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f44909f8a2ed084da241a9f241376b9b5ef98be7", "commit_date": "2023-07-31T15:04:26Z", "commit_message": "Merge pull request #2960 from ostreedev/dependabot/submodules/libglnx-c02eb59\n\nbuild(deps): bump libglnx from `07e3e49` to `c02eb59`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a16a14a67b673aa5db90810fc2c7a16a0514928f", "commit_date": "2023-07-31T12:29:54Z", "commit_message": "build(deps): bump libglnx from `07e3e49` to `c02eb59`\n\nBumps libglnx from `07e3e49` to `c02eb59`.\n\n---\nupdated-dependencies:\n- dependency-name: libglnx\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fd968d5939afdb601715d93db5e7da08ab9fe524", "commit_date": "2023-07-31T09:55:39Z", "commit_message": "Merge pull request #2957 from cgwalters/transaction-test-suppress-global-sync\n\ntests/destructive: Turn off global sync()", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0406fd3912d6e54f94698c2ad2a6da6c477a4eba", "commit_date": "2023-07-29T12:47:54Z", "commit_message": "deploy: Support an empty `/etc` and populated `/usr/etc`\n\nIn preparation for support for a transient `/etc`:\nhttps://github.com/ostreedev/ostree/issues/2868\nparticularly in combination with composefs.\n\nBasically it's just much more elegant if we can directly mount\nan overlayfs on the *empty* `etc` directory, using `usr/etc` as\nthe lower.\n\nIn the composefs case, we'd have to mount the composefs overlayfs\nitself writable (and call `mkdir`) *just* so we can make that\nempty `etc` directory which is ugly.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6470429b2b7ba720a3723533625db8f1296a0c7e", "commit_date": "2023-07-28T21:59:28Z", "commit_message": "tests/destructive: Turn off global sync()\n\nLet's verify that things work with that off, as they should.\n\nPreviously:\nhttps://github.com/ostreedev/ostree/pull/2519/commits/cb731294837736e957ee595ce11ab115277dbb36\n\"deploy: Add a 5s max timeout on global filesystem sync()\"\n\nBut we may still have problems even with that, see\nhttps://issues.redhat.com/browse/OCPBUGS-15917\nwhere it might be that even a thread doesn't work because\nwe're locked in the kernel.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a2663e8041ffadb764c71a055dd63dba4e7ff378", "commit_date": "2023-07-28T15:16:57Z", "commit_message": "Merge pull request #2956 from cgwalters/finalize-more-verbose\n\ndeploy: Be way more verbose about what we're doing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3d881fee4154636ca572e2b0b25dbccc22b771d5", "commit_date": "2023-07-27T18:08:15Z", "commit_message": "deploy: Be way more verbose about what we're doing\n\nThis will help us debug bugs like https://issues.redhat.com/browse/OCPBUGS-15917\nin the future.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1aed5d7cf9075199a4ab9b82cad3dc565c2d54e1", "commit_date": "2023-07-27T14:41:24Z", "commit_message": "Merge pull request #2954 from cgwalters/harden-gvariant-get-data\n\nHarden gvariant get data", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b37259607e476de178fc20753b1083ee89448bf", "commit_date": "2023-07-26T22:09:28Z", "commit_message": "checksum-utils: Add an assertion that `buf != NULL`\n\nAnother hardening against https://bugzilla.redhat.com/show_bug.cgi?id=2217401", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0392b5460276748576da5b4fbc00a361d847b4e3", "commit_date": "2023-07-26T22:09:28Z", "commit_message": "core, switchroot: Harden a bit against `g_variant_get_data() == NULL`\n\nI'm not totally sure this is the cause of\nhttps://bugzilla.redhat.com/show_bug.cgi?id=2217401\nbut analyzing the code a bit it seems the most likely.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d7d661218e556f8baddf888e297f60f046a524d7", "commit_date": "2023-07-26T14:10:27Z", "commit_message": "Merge pull request #2953 from samcday/patch-1\n\ndocs: update boot loader spec link", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "66e425534e99d83137831802ff75c62dd855a6a8", "commit_date": "2023-07-26T09:17:35Z", "commit_message": "Merge pull request #2930 from cgwalters/prepare-root-config3\n\nprepare-root: Introduce ostree/prepare-root.conf && sysroot.readonly improvements", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b5397887e32ccc47db270a3276326de3b184d13c", "commit_date": "2023-07-25T19:42:41Z", "commit_message": "docs: update boot loader spec link", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "af52a88d5fdc077ba43a19e1731614ed8747246f", "commit_date": "2023-07-25T16:36:12Z", "commit_message": "Merge pull request #2952 from cgwalters/silence-variant-lookup\n\ntree-wide: Consistently `(void)g_variant_lookup()`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "13e7ae907de35f364f9e2573175124aa0691c840", "commit_date": "2023-07-25T15:28:23Z", "commit_message": "tree-wide: Consistently `(void)g_variant_lookup()`\n\nCoverity warns when we're checking the return value in most-but-not-all\ninstances.  The code is correct in these instances; we're initializing\nthe values to defaults.  So add a `(void)` cast like we are doing\nin many other places.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "34656260154ad9affcd4d60c568d06c82b7149a6", "commit_date": "2023-07-25T13:15:11Z", "commit_message": "prepare-root: Don't parse target root when composefs enabled\n\nWe shouldn't load anything from the target root filesystem *before*\nverifying its integrity if composefs is enabled.\n\nIn effect, we want to force composefs users to migrate to\n`/usr/lib/ostree/prepare-root.conf` which lives in the initramfs.\n(But because we enable sysroot.readonly=true if composefs is enabled\n too, they don't actually need to)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "83d37d6d3cecf746bd63c0c97bf9154b889e67ba", "commit_date": "2023-07-25T13:15:11Z", "commit_message": "prepare-root: Default sysroot.readonly=true if composefs\n\nNot because it's logically required or anything, but because\nit's just a good idea.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "22b8e4f953ed183a368ec97ce7f74337b1574045", "commit_date": "2023-07-25T13:15:09Z", "commit_message": "prepare-root: Introduce `ostree/prepare-root.conf`\n\nUsing the repository configuration for configuration of this\nprogram was always a bit hacky.\n\nBut actually with composefs, we really must validate\nthe target root *before* we parse anything in it.\n\nLet's add a config file for `ostree-prepare-root` that can live\nin the initramfs, which will already have been verified.\n\nIn the future we'll also add configuration for composefs here.\n\nWe expect OS builders to drop this in `/usr/lib/ostree/prepare-root.conf`,\nbut system local configuration can live in `/etc`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "250c40a671488ac86fea985ec510488cd0fd2bb0", "commit_date": "2023-07-25T09:25:29Z", "commit_message": "Merge pull request #2948 from cgwalters/composefs-more-cleanups\n\ncomposefs: Use lowerdir in /run", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3f594b04aa0aa38bbfef9e0f471afc0b7dbbd12b", "commit_date": "2023-07-24T20:07:28Z", "commit_message": "Merge pull request #2951 from cgwalters/errprefix-sysroot\n\nsysroot: Add a bit more error prefixing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e2eedeec9d0bb307757e4db4f3bab8530ce5f67", "commit_date": "2023-07-24T20:06:59Z", "commit_message": "Merge pull request #2949 from cgwalters/kargs-cleanup\n\nkernel-args: Move private functions out of public header", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cf525ee6198e20adbc014a86de6199d2f34aec29", "commit_date": "2023-07-24T12:54:29Z", "commit_message": "repo: Clarify when we fail to parse a remote\n\nThis would have directly pointed at the failing config file.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "70d790abeab6e8b6a0b7fe20f8cdd80af7028538", "commit_date": "2023-07-24T12:48:51Z", "commit_message": "sysroot: Add a bit more error prefixing\n\nWhile an error message I saw was pretty clear, this would\nbe even more explicit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "82da0e169bf82a24c4510bfa2f41c925694f23eb", "commit_date": "2023-07-24T09:52:41Z", "commit_message": "Merge pull request #2950 from cgwalters/generator-cleanup\n\ngenerator: Some cleanup", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d7fe9e54ed675aa7b82e59808a5ab1bac4b1c4a3", "commit_date": "2023-07-23T17:22:14Z", "commit_message": "kernel-args: Move private functions out of public header\n\nExternal users can't call `_` prefixed APIs, so move them\nto a `-private.h`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "303e7eb2e1191e4fc1798198e16becc925075bca", "commit_date": "2023-07-23T14:47:19Z", "commit_message": "src/generator: Move all logic into libostree-1.so\n\nThis pushes down the code for parsing the `ostree=` cmdline\nin the generator into code that's part of libostree-1.so.\n\nThis is prep for using logic shared in libotcore.la.\n\nBut in general it's just cleaner to also keep the binary\nentrypoint to just be a trampoline into the C library.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ec1109c7a93a2ed07503b12ffecf7048cf7cc0d0", "commit_date": "2023-07-23T14:40:20Z", "commit_message": "generator: Stop creating `/run/ostree-booted`\n\nThis must have always been dead code.  We're trying to iterate\ntowards a place where it's only `ostree-prepare-root.c` which\nparses the `ostree=` kernel argument, and canonically sets up\n`/run/ostree-booted`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "64afbcdeb0cb101ce302ae28f1c0852a9d73b907", "commit_date": "2023-07-22T20:46:17Z", "commit_message": "composefs: Use lowerdir in /run\n\nI just noticed that this was another constant string duplicated\nbetween prepare-root.c and libostree-1.so, and I went to make\nit a common `#define` in libotcore.la.\n\nBut then I thought \"it's ugly to have this directory mixed into\nthe deployment namespace\" because in some theoretical world\nit could also be in the ostree commit, which would cause weird\nbehavior.\n\nI think this is transient state that is better in `/run`, so move\nit there.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4c0e5b1ef7aa877c242e3ce20003392a585d4a25", "commit_date": "2023-07-20T20:58:11Z", "commit_message": "Merge pull request #2942 from ostreedev/android-bootloader-parsing\n\nbootloader: fold all Android Bootloader specific logic into prepare-root", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a035c2e21cdef1a8d57627bdd8c556c3d08a3c70", "commit_date": "2023-07-20T19:12:31Z", "commit_message": "Merge pull request #2946 from cgwalters/add-inode-fix-feature\n\nAdd an always-on `inode64` feature", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8ce7bbe1994366667e770986d11bc02a31655084", "commit_date": "2023-07-20T17:50:25Z", "commit_message": "Add an always-on `inode64` feature\n\nAs I (and others) will be backporting the fix in\nhttps://github.com/ostreedev/ostree/pull/2874/commits/de6fddc6adee09a93901243dc7074090828a1912\npretty far, I want a way for sysadmins and OS builders to\nbe able to reliably see when their version of ostree has this fix\n(Because comparing version numbers isn't portable).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c89baaed771f604475b452f687f84e10e1565915", "commit_date": "2023-07-20T11:31:01Z", "commit_message": "bootloader: fold all Android Bootloader specific logic into prepare-root\n\nNow that we use androidboot.slot_suffix karg to determine whether we\nboot into /ostree/root.a or /ostree/root.b, we can use ostree= karg\nsimply for parsing the stateroot, although we will still boot into\nwhat's pointed to by /ostree/root.a or /ostree/root.b.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "559361655d164134379e9c395e3009ee0d2a9b96", "commit_date": "2023-07-19T14:35:27Z", "commit_message": "Merge pull request #2943 from cgwalters/mount-cleanup\n\nprepare-root: Drop code mounting `/proc`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "253e7758d379e99fe28846b7f6ac8213b7dea5cf", "commit_date": "2023-07-19T14:34:46Z", "commit_message": "Merge pull request #2944 from cgwalters/prepare-root-more-cleanup\n\nprepare-root: Drop more dead code", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e61226a8d74d026385ed5932e793133c96f7d1d7", "commit_date": "2023-07-19T13:13:53Z", "commit_message": "prepare-root: Drop more dead code\n\nMost of this was used for the old composefs signature model.  We\nnow reuse the core signature code and link to glib, so we don't\nneed reimplementations of hex strings and reading files.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "41cda3bd2abec6dc2786e141b15b9d5ce238db86", "commit_date": "2023-07-19T13:12:10Z", "commit_message": "prepare-root: Drop code mounting `/proc`\n\nThis must be done by the init process here; it was always\ndead code in the initramfs path.\n\nWe keep the copy of this code in the now-forked -static.c.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b258375f05d71133c9c818ee9771989d77c40392", "commit_date": "2023-07-18T13:35:45Z", "commit_message": "Merge pull request #2938 from cgwalters/dedup-ostree-parsing\n\ngenerator: Deduplicate ostree= karg parsing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b548ff74a26df21978e8675d8ab9ad23b9cdbcc8", "commit_date": "2023-07-18T13:33:58Z", "commit_message": "Merge pull request #2939 from cgwalters/ed25519-cleanups\n\nsign-ed25519: Minor cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6966979c5e3a216fccfb3312e11cb959ac4e4b30", "commit_date": "2023-07-18T12:29:09Z", "commit_message": "generator: Deduplicate ostree= karg parsing\n\nAvoid having two copies of a regular expression for parsing\nthe `ostree=` kernel argument.  Because the `ostree-system-generator`\nbinary already has access to the internals because it's implemented\nin the shared library, expose the sysroot version internally\nand use that.\n\nMotivated by an attempt to change one of these copies but not\nthe other.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fc303da67d9f5998b7b996c37e4738313978d589", "commit_date": "2023-07-18T12:25:36Z", "commit_message": "sign-ed25519: Don't set sk unless we've validated it\n\nThe semantics of this function now keep the key assigned\neven if we fail to validate it, which is ugly.  Only assign\nthe key after verifying its length.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3a18a5570d9f741ba2b883cd9da1f526b60a9bec", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "sign-ed25519: Add some comments for data structure\n\nLike poor man's generics.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fb40e559903491bf1ff106a4fdb63b815280550a", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "sign-ed25519: More verbose errors for invalid length\n\nAdd a helper to compare lengths which includes the found\nand expected values.  Use it consistently.\n\nThe error message \"Incorrect\" is misleading; one might think\none had the *wrong* key.  \"Ill-formed\" makes it clearer that\nwe're not parsing it at all.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1a2fac371b3535f612b083fca1bf99b86a7c5306", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "tests: Remove dead references to \"SEED\"\n\nNothing uses this.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1c0fd7d458066a965244c4551903e48b8e10359b", "commit_date": "2023-07-17T13:46:02Z", "commit_message": "Merge pull request #2937 from ericcurtin/ostree2androidboot.slot_suffix\n\nandroid-boot: Remove dependency on ostree= karg, use androidboot.slot_suffix=", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "355cd727055959337fcdbe0617aae66f5d7ef433", "commit_date": "2023-07-17T12:23:27Z", "commit_message": "Remove steal_pointer and steal_pointer_impl as we link in glib now\n\nThese were necessary to keep initramfs small, but now we link in glib\nanyway so these functions are now redundant.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6f0a5713443b93c4060991ffa16d58d62c27fa9", "commit_date": "2023-07-17T12:22:49Z", "commit_message": "android-boot: Remove dependency on ostree= karg, use androidboot.slot_suffix=\n\nGiven the kernel argument androidboot.slot_suffix= is required in\nAndroid AB updates [1] there is no need to check for ostree= or ostree=aboot\nat all in the aboot case. This also ensures if the dependancy on ostree=\nis removed, the android-boot technique will work regardless.\n\n[1]: https://source.android.com/docs/core/ota/ab/ab_implement", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "27a9fe30b34315e68bc30c69238721df0241c7c3", "commit_date": "2023-07-16T21:22:20Z", "commit_message": "Merge pull request #2936 from cgwalters/sign-from-file\n\ncommit: Add `--sign-from-file`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7bbe13cabbc442fa610e63521cf63b1bb0d2bd83", "commit_date": "2023-07-16T20:59:32Z", "commit_message": "Merge pull request #2931 from cgwalters/prepare-root-man\n\nman: Add ostree-prepare-root", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "de81a7e71ac2cfdab27051cb00720027196895d8", "commit_date": "2023-07-15T16:33:56Z", "commit_message": "Merge pull request #2929 from cgwalters/prepare-root-drop-pivot\n\nprepare-root: Drop dead `pivot_root` code", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8302a8add09946f2b731cc3ecebede4f33637aa3", "commit_date": "2023-07-15T16:31:53Z", "commit_message": "Merge pull request #2927 from cgwalters/sysroot-errprefix-bootlinks\n\nsysroot: Add some error prefixing for bootversion", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "845d68d1d4441c9f2662eb77612ec6b7a6b7ec39", "commit_date": "2023-07-15T13:52:11Z", "commit_message": "Merge pull request #2935 from cgwalters/prepare-root-config4\n\nprepare-root: Refactor composefs config handling", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "82d934916b6ececb8f9e5f975723bbf487b894cb", "commit_date": "2023-07-15T13:50:40Z", "commit_message": "commit: Add `--sign-from-file`\n\nPassing the private key via a direct command line argument\nis just a bad idea because it's highly likely to get logged\nor appear in `ps`.\nSpotted in review of work for composefs signatures.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d4ca834b0904166fb7691ddbb1e1e2ea8f76c55f", "commit_date": "2023-07-14T18:37:03Z", "commit_message": "prepare-root: Refactor composefs config handling\n\n- Convert the current enum into a struct, using `OtTristate` and\n  two member variables (expected signature and digest)\n- Factor out a helper function to parse this config\n- Clean up the logging by consistently using `composefs:` as a prefix\n- Add more assertions to more strictly verify our runtime state\n  since this is security relevant", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "18d6f5979331e8f890bf4b12473384b63754c450", "commit_date": "2023-07-14T15:40:42Z", "commit_message": "Merge pull request #2934 from cgwalters/enable-composefs-default\n\nbuild-sys: Enable composefs at *build time* by default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "592351d1b09f3afca92a388263c87a2c3338518c", "commit_date": "2023-07-14T14:34:46Z", "commit_message": "build-sys: Enable composefs at *build time* by default\n\nThere's no additional dependencies, and it's a small amount\nof new code.\n\nThe riskiest thing is the changes to ostree-prepare-root, but\nI believe that things are in a good state now there.\n\nAgain, this just enables it at *build time* - it's still\noff at runtime by default.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3d29f89c0ecc98bae8a4faa7dc7ee69944dca87f", "commit_date": "2023-07-14T14:26:25Z", "commit_message": "Merge pull request #2928 from cgwalters/prepare-root-config\n\nMore prepare-root cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c1ac6bc3460521e0b336cf8e36befc995892a6e5", "commit_date": "2023-07-14T12:48:17Z", "commit_message": "Merge pull request #2932 from cgwalters/aboot-fix-nullderef\n\nmount: Fix gcc -fanalyzer warning for parsing androidboot.slot_suffix", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c078e8bea381349dfc2c3a34188603764b0161ff", "commit_date": "2023-07-14T10:51:34Z", "commit_message": "mount: Fix gcc -fanalyzer warning for parsing androidboot.slot_suffix\n\nIf the karg wasn't present, we'd do a NULL deref which is undefined\nbehavior.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c4f1d18a30ec954042551700e4deaa6c537b3f93", "commit_date": "2023-07-13T21:53:10Z", "commit_message": "Merge pull request #2920 from ostreedev/dependabot/submodules/composefs-1704f82\n\nbuild(deps): bump composefs from `ac729b5` to `1704f82`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1e4cb30c6862c7ef3b10579925e1daf65942a90b", "commit_date": "2023-07-13T21:24:52Z", "commit_message": "man: Add ostree-prepare-root\n\nAdd an overdue man page that describes this.  Prep for also\ndocumenting composefs things here.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0eda15ceff5e75a6f0614219a45a537d69fccbe1", "commit_date": "2023-07-13T17:58:25Z", "commit_message": "Use /run/ostree-booted metadata for sysroot-ro state passing\n\nJust like we did with composefs, use the new metadata instead\nof a \"stamp file\".", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "79806a683edf80e9bc709e544369a59967003385", "commit_date": "2023-07-13T12:28:49Z", "commit_message": "prepare-root: Drop dead `pivot_root` code\n\nI think this was only ever used in the \"static pid1\" path which\nis now split out into a separate file.\n\nWe always expect that e.g. systemd does the switchroot in\nthe initramfs, so drop this dead code.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b8d66964a83617359e9878e7e0cbacdd4ca91fd1", "commit_date": "2023-07-13T11:57:18Z", "commit_message": "remount: Use new metadata in `/run/ostree-booted` for composefs\n\nSince we now have a generalized more structured way of serializing\nstate in the initramfs instead of \"stamp files\", use it for\npassing the composefs state.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "77acad246e104a1e553dad4c86ab333e884f8df5", "commit_date": "2023-07-13T11:28:39Z", "commit_message": "remount: Don't overwrite /run/ostree-booted\n\nSince it should always be written in the initramfs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "93699cc54611fef1214966cd8292f565f6b7b11e", "commit_date": "2023-07-13T11:28:39Z", "commit_message": "prepare-root: Add metadata for composefs to `/run/ostree-booted`\n\nParticularly for the signature case, having this metadata\nacts as a reliable \"proof of execution\" of the signature verification\ncode (as opposed to parsing a log file or so).\n\nBesides that, this is also just a stronger check for \"we're using\ncomposefs\" instead of checking for \"overlayfs on /\".", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bafb551275b22fbd5c9f227e368b841bc91b3569", "commit_date": "2023-07-13T11:28:39Z", "commit_message": "prepare-root: Use constant for ed25519 signature\n\nMinor cleanup.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6cdc5ce595deca6bf7f14171d35258ee4c38cc53", "commit_date": "2023-07-13T11:10:59Z", "commit_message": "Merge pull request #2926 from cgwalters/otcore-cfs-constants\n\nprepare-root: A few cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "18cc447230c2ed43d0834d771b03a8d41300c920", "commit_date": "2023-07-12T11:56:17Z", "commit_message": "prepare-root: Drop unused verity flag querying\n\nThis logic got pushed down into libcomposefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2b738a995d00761caf3cfcbd2651bdf415aa56ca", "commit_date": "2023-07-12T11:56:17Z", "commit_message": "prepare-root: Use otutil and g_print\n\nNow that we link to libotutil (and glib) we don't need separate\nhandling for conditionalizing on the presence of systemd.\n\nFurther, there's no value in `sd_journal_send(MESSAGE=)` over\njust printing to stdout.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1b7b4fbd2bbd9010b0e3e1ad4f6f391f9f0f22fd", "commit_date": "2023-07-11T21:50:43Z", "commit_message": "Add an internal constant for the composefs image name\n\nJust a minor cleanup.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c0c2c9bd800da8eeb72801a0007248a15080662b", "commit_date": "2023-07-11T19:31:14Z", "commit_message": "Merge pull request #2924 from cgwalters/drop-syntax-check\n\nbuild: Drop `make syntax-check`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6591210661b55baf2f24c654b0581d1a4daf274c", "commit_date": "2023-07-11T18:17:05Z", "commit_message": "build: Drop `make syntax-check`\n\nAs of lately it emits a ton of errors from `grep` about having `*`\nat the start of a line, but more generally it's only generally\nfound papercut-style issues that aren't worth carrying a distinct\nchecking system for.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "57fe33f07ef1e6beac466edc00cac9c38d2883ff", "commit_date": "2023-07-11T18:09:07Z", "commit_message": "Merge pull request #2921 from alexlarsson/composefs-sign-v2\n\nostree-prepare-root: Validate ed25519 signatures when requested", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c29f4193cd7e431f0f49a3af98df9830e5fea8c5", "commit_date": "2023-07-11T18:08:33Z", "commit_message": "ostree-prepare-root: Validate ed25519 signatures when requested\n\nIf requested, by specifying ot-composefs=signed=/path/to/pub.key then\nthe commit object is validated against the specified ed25519 public\nkey, and if valid, the composefs digest from the commit object is used\nto ensure we boot the right digest.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b8ff2109413a123111eba30f0ae776956d56e081", "commit_date": "2023-07-11T18:08:32Z", "commit_message": "Factor out a libotcore\n\nThis will contain logic shared between ostree-prepare-root\nand libostree-1.so.  It will just link to libgio.so, so as\nto avoid pulling in e.g. libcurl and other things.\n\nIn other words, `ostree-prepare-root` will not link to `libostree-1.so`,\nbut will pull in just what it needs from this library.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "265cf7d786ffa3972d1698aeeb8bb4e5b50385b5", "commit_date": "2023-07-08T19:42:12Z", "commit_message": "build-sys: Add libsodium to OT_DEP_CRYPTO\n\nThere's no reason to have these distinct really.  If we're using\nlibsodium, we want it in the same places we're using openssl.\n\nPrep for further refactoring.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6d9c714c64a4bfee02154800257715827b10d4b", "commit_date": "2023-07-07T19:25:27Z", "commit_message": "Merge pull request #2922 from alexlarsson/openssl-ed25519\n\nImplement ed255519 using openssl too", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "744967a6e4118ddb3b70ba30623e639fde1a77f9", "commit_date": "2023-07-07T18:19:59Z", "commit_message": "libotutil: Link to crypto libs\n\nThe checksum utils uses the crypto lib, but we're not explicitly linking\nto it. I think this is why the CI got this error when using openssl\non debian, during ostree binary linking:\n\n/usr/bin/ld: ./.libs/libotutil.a(libotutil_la-ot-checksum-utils.o): undefined reference to symbol 'EVP_DigestInit_ex@@OPENSSL_3.0.0'\n/usr/bin/ld: /lib/x86_64-linux-gnu/libcrypto.so.3: error adding symbols: DSO missing from command line\ncollect2: error: ld returned 1 exit status", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "474c2b100bd31aac00cb3e2bfec4a5591c4c626d", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "CI: Enable --with-crypto=openssl on debian testing to test openssl signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7b85adfbbd97054e4b14ca4365c11fbadf97c70c", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "sign-ed25519: Implement sign and verify using openssl\n\nlibsodium is used if configured to keep the old behaviour, but if\nit is not enabled, and openssl is used, then ed25519 is now supported.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "501575c1e44cf2a7d58c39944da405f802023325", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "sign-ed25519: Drop some uses of libsodium\n\nThis adds some defines for ed25519 key sizes and drops uses\nof the libsodium defines for these, as well as replacing sodium_bin2hex\nuse with ot_bin2hex. Some code that wes optionally built before are now\nalways built.\n\nThe goal for this is to support both libsodium and openssl.\n\nAlso fixes return value of _load_pk_from_stream(). It used\nto always return FALSE.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b7277513b951c7fe352b53d1d90fbcd7c4b5597", "commit_date": "2023-07-07T15:12:52Z", "commit_message": "Merge pull request #2923 from alexlarsson/fix-composefs-test\n\ntests: Fix composefs test", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "62e4f376536a86ca8d707a75ffc62a3c728389c3", "commit_date": "2023-07-07T13:57:00Z", "commit_message": "tests: Fix composefs test\n\n- Was using the wrong metadata key\n- We were missing setting the canonical commit args which assigns\n  e.g. owner uid 0, which is important for reproducibility\n- Use the new --print-hex to make things easier to read", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "eb01112083e7ce45239fc711b9cda311085302ca", "commit_date": "2023-07-07T13:22:30Z", "commit_message": "show: Add --print-hex\n\nThe default GVariant output for byte arrays is illegible to humans,\nand byte arrays are super common for us.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6056ec130ffff4ac310583f4f4ebffef64919fc3", "commit_date": "2023-07-06T00:00:30Z", "commit_message": "Merge pull request #2913 from cgwalters/tmpfile-not-on-revokefs\n\nfetcher: Always open tmpfiles in repo (except on FUSE)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "43fb27877225a89a69fbcf3d4f5c455c9559067d", "commit_date": "2023-07-05T10:26:42Z", "commit_message": "Merge pull request #2918 from ostreedev/dependabot/submodules/composefs-ac729b5\n\nbuild(deps): bump composefs from `412cb5e` to `ac729b5`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "25120bd7adf9c4167e9b2bd76f6daded65518d0d", "commit_date": "2023-07-05T09:47:05Z", "commit_message": "Merge pull request #2912 from cgwalters/itest-transactionality-debug\n\ntests/inst: A few small patches", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "61720180904655b9adab80bf2aecd7a20e809b70", "commit_date": "2023-07-05T08:51:29Z", "commit_message": "Merge pull request #1633 from cgwalters/pkglibexec-tests\n\nDrop \"ostree trivial-httpd\" CLI, move to tests directory", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ba9c9dedffb953738c609fda6502b9b37ee1b6ba", "commit_date": "2023-07-05T08:27:36Z", "commit_message": "fetcher: Always open tmpfiles in repo (except on FUSE)\n\nThis reverts commit 4e61e6f7d0d6aebd6abcdc455ec53164afe39e8d\nand re-instates the fix for ensuring that we download temporary\nfiles into the repository location.\n\nHowever in order to ensure we don't re-introduce\nhttps://github.com/ostreedev/ostree/issues/2900\nwe detect the case where we're writing to a FUSE mount\nand keep the prior behavior.\n\nI've verified that this works with flatpak.\n\nNote a downside of this is the change needs to be triplicated\nacross the 3 http backends.\n\nThis then again\nCloses: https://github.com/ostreedev/ostree/issues/2571", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9104c54f2b9356e693b97a007dfbc9f3fe3c23ce", "commit_date": "2023-07-04T13:05:31Z", "commit_message": "Merge pull request #2905 from cgwalters/prepare-root-static-split\n\nSeparate prepare-root static path + link to glib", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "01be14e6c045b64974541230e215722c17b383dd", "commit_date": "2023-07-04T12:25:19Z", "commit_message": "build(deps): bump composefs from `412cb5e` to `ac729b5`\n\nBumps [composefs](https://github.com/containers/composefs) from `412cb5e` to `ac729b5`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/412cb5e6aaf516c5e2a7f67e426a25ed2926e101...ac729b579dd332938c6ad43ba83b2b896631dad4)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c36e8143d3c95d454b65c38f923cf71d08d5eb7", "commit_date": "2023-07-04T12:18:24Z", "commit_message": "Drop \"ostree trivial-httpd\" CLI, move to tests directory\n\nSee https://github.com/ostreedev/ostree/issues/1593\n\nBasically this makes it easier for people packaging, as the trivial-httpd\nis only for tests, and this way the binary will live with the tests.\n\nAlso at this point nothing should depend on `ostree trivial-httpd`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8ad8a79c2a8551d08a296e9dc16e7d38683aa0a8", "commit_date": "2023-06-30T19:07:15Z", "commit_message": "Merge pull request #2916 from cgwalters/release\n\nRelease 2023.5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b2cfee722e82821c76e26dd3606417c49a86d50c", "commit_date": "2023-06-30T15:49:30Z", "commit_message": "Merge pull request #2914 from cgwalters/doc-usergroups\n\ndocs: Update user and group section", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5aadb6ec26b07ac29f84b08b6d458079e1aedb14", "commit_date": "2023-06-30T15:10:25Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "26b833e90a1dcd3d40e06e43f5597a9951df8641", "commit_date": "2023-06-30T15:07:18Z", "commit_message": "Release 2023.5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7d192d079ac656893b7056f054f2596592592b0d", "commit_date": "2023-06-30T15:01:59Z", "commit_message": "Merge pull request #2899 from ostreedev/dependabot/submodules/composefs-412cb5e\n\nbuild(deps): bump composefs from `08bdb03` to `412cb5e`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "875915f6c977d359ca1e3e818a1b3b8286f6b6bc", "commit_date": "2023-06-30T09:18:23Z", "commit_message": "prepare-root: Link to glib\n\nSince we've split off the \"prepare root as init\" code\ninto a separate file, we can now use glib to parse\nthe config file again, which is a lot less hacky.\n\nThis is particularly motivated by composefs, where\nwe want to do more in the initramfs.  Future patches\nmay also link to parts of libostree.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d6799ecc243befcf714bcf54dbbd41da13a6e290", "commit_date": "2023-06-30T09:18:23Z", "commit_message": "Separate prepare-root static path\n\nWe should have done this a long time ago.  We don't have any test\ncoverage for the no-initramfs path, and I think it's not long\nterm supportable as we want to add more features like composefs.\n\nParticularly now that there's good support for embedding an\ninitramfs in a kernel image, I see little value in a path for\nhaving custom static linking for this prepare root flow.\n\nThat said, we will continue to make a best-effort \"it compiles\"\nattempt to support it.\n\nFork the \"pid 1\" prepare root code into a new\n`ostree-prepare-root-static.c` file, and drop the runtime conditionals.\n\nWe can drop the composefs logic from `-static.c` which ends up\nkeeping that file much smaller.\n\nA further next step here will be to actually fold the\n`prepare-root.c` logic into the main `ostree` binary which we\ncan then just include in the initramfs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6e5753f574779e7762802d1c5b04682efcde8200", "commit_date": "2023-06-30T09:13:46Z", "commit_message": "build(deps): bump composefs from `08bdb03` to `412cb5e`\n\nBumps [composefs](https://github.com/containers/composefs) from `08bdb03` to `412cb5e`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/08bdb030fcff4f55ef63aa828b09b57a6cd4d234...412cb5e6aaf516c5e2a7f67e426a25ed2926e101)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "786e64ced799dcd1571d5dff42cb80bab999cc5c", "commit_date": "2023-06-29T15:05:31Z", "commit_message": "docs: Update user and group section\n\n- mention `DynamicUser=yes`\n- mention the recent systemd JSON bits\n- mention sysusers.doc\n\nAnd briefly talk about the tradeoffs in these.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c2ad2d23aeb23c474f01ee64adee8953559773ab", "commit_date": "2023-06-29T08:16:52Z", "commit_message": "Merge pull request #2911 from cgwalters/fix-generator-regression\n\nFix return value of generator on non-ostree systems", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8999d41127572d27ab12474f1754d1ae0c19f187", "commit_date": "2023-06-29T06:38:00Z", "commit_message": "Merge pull request #2910 from cgwalters/more-ci-fixes\n\nci: Fix executability", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8bba482bc8b40a0601f7997ecf00f020c1b09cca", "commit_date": "2023-06-29T06:11:09Z", "commit_message": "tests: Enable mtime test\n\nI think this just accidentally was never enabled.\n\nWhile looking at the code, add a sleep here to be resilient to\nfilesystems with only second mtime granularity.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0b519c25732adfbc19b159e1d9173dd7f83f86e7", "commit_date": "2023-06-29T06:09:51Z", "commit_message": "tests: Drop unused alias", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "54c731554ea2f73bd0553d22628fb0d438d1ee96", "commit_date": "2023-06-29T06:08:56Z", "commit_message": "tests/transactionality: Port a bit to xshell\n\nThis will give us more useful error messages which should\nhelp debug a flake.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a0d17a730da4b5661eb5eb1f2563f3e69e35430f", "commit_date": "2023-06-28T23:44:52Z", "commit_message": "Merge pull request #2907 from cgwalters/test-composefs\n\ntests: Source libtest before exiting", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aeef8221c430a3b7ae86bfbedc01b82848d4430a", "commit_date": "2023-06-28T15:58:20Z", "commit_message": "test-composefs: Sync flow with other tests\n\nI am not sure why this is failing on older Debian systems,\nbut I'm wildly guessing that something being done in `libtest.sh`\nis setting up automake in a way that we need.  This is done\nin other tests.\n\nOr maybe it's the missing `$CMD_PREFIX`?  Let's see...", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c76d03af24de5ac8fa3a834fde8e8d11179021c", "commit_date": "2023-06-28T15:45:15Z", "commit_message": "Fix return value of generator on non-ostree systems\n\nCommit aa72caffb540114a0e8635ab2990b9c8b0b8f9db\nregressed the `ostree-system-generator` on non-ostree systems.\nIf there's no `ostree=` karg, we need to just exit 0.\n\nCloses: https://github.com/ostreedev/ostree/issues/2909\nFixes: aa72caffb540114a0e8635ab2990b9c8b0b8f9db", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "531b4ab055a814566d4fabd9e55e4a842a5d2104", "commit_date": "2023-06-28T06:37:31Z", "commit_message": "ci: Fix executability", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e0e2144e12899d615441e9e13e522d973c5354c9", "commit_date": "2023-06-27T21:16:18Z", "commit_message": "Merge pull request #2904 from cgwalters/prow-ci\n\nci/prow: Build tests before trying to install", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88e399a780731f71e0b6f90b8f02a58a5c939238", "commit_date": "2023-06-27T13:55:15Z", "commit_message": "Merge pull request #2906 from cgwalters/compiletest-static-prepareroot\n\nci: Add \"it compiles\" coverage for --with-static-compiler", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6ed6a7e6990c3f53a1f750be67fd2a8c582dbddb", "commit_date": "2023-06-27T10:36:52Z", "commit_message": "ci: Add \"it compiles\" coverage for --with-static-compiler\n\nPrep for further changes.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e2b5aca40ec50be8948f6250223c28374d452da", "commit_date": "2023-06-27T09:27:23Z", "commit_message": "ci/prow: Build tests before trying to install\n\nOur `install` target doesn't depend on `all` unlike the\nrpm-ostree version; not doing so is arguably better, so let's\nexplicitly build before installing.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "132bb6a82e4e8798be7ee7a1b3e7311352792716", "commit_date": "2023-06-27T06:50:49Z", "commit_message": "Merge pull request #2902 from ericcurtin/ostree-aboot-pass-options\n\nbootloader: Pass \"options\" to aboot bootloader backend", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8deb97a778e486298c91cf94347f9bae673bec1c", "commit_date": "2023-06-27T04:18:17Z", "commit_message": "Merge pull request #2901 from cgwalters/revert-fetcher-change\n\nRevert \"fetcher: Always open tmpfiles in repo location\"", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4e61e6f7d0d6aebd6abcdc455ec53164afe39e8d", "commit_date": "2023-06-27T03:03:10Z", "commit_message": "Revert \"fetcher: Always open tmpfiles in repo location\"\n\nThis reverts commit f7f6f87c513c9f35bc24f35e909779c19cb49d3a.\n\nThis seems to have broken flatpak, so we'll revert and then\ninvestigate.\n\nCloses: https://github.com/ostreedev/ostree/issues/2900", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7a91035c09d300a127521722b50148aad2ea38a7", "commit_date": "2023-06-26T23:08:48Z", "commit_message": "Merge pull request #2903 from dbnicholson/composefs-digest-fix\n\nprepare-root: Adjust to composefs mount struct changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "94b49b41e7b10b550757df77ba32138c0d5a36dd", "commit_date": "2023-06-26T15:47:00Z", "commit_message": "prepare-root: Adjust to composefs mount struct changes\n\nThis fixes a regression from the latest composefs submodule update in\n1582edd1d4a6b26874d3897de8a5586f979a0715. In composefs commit\n7560a4fd388481f479c0b3fc2e6d20c6321d9b74 the struct field was changed\nfrom the generic `expected_digest` with the thought that there may be\nother signatures or digests in the future.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4429923681b8950953adb1f81ed5e73082d370d2", "commit_date": "2023-06-26T10:44:56Z", "commit_message": "bootloader: Pass \"options\" to aboot bootloader backend\n\naboot-deploy must know where the next root filesystem to boot is to set\nup a symlink /ostree/root.a or /ostree/root.b , this location is in the\nostree= part of these passed in options.\n\nSigned-off-by: Eric Curtin <ecurtin@redhat.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "363a1f14a8ca83842a2f27fbc76dd8cc89599b5a", "commit_date": "2023-06-21T12:06:52Z", "commit_message": "Merge pull request #2896 from akiernan/main\n\nlib/deploy: Use off_t not __off_t", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e0342d2da10db5f232a7bd162cf72b5c1dcfd6e2", "commit_date": "2023-06-21T06:31:14Z", "commit_message": "lib/deploy: Use off_t not __off_t\n\nNot clear why this was __off_t which is the sole appearance in the code\nbase, but it breaks musl builds.\n\nSigned-off-by: Alex Kiernan <alex.kiernan@gmail.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "24dd9bbe0292066c7fcf66d835484908c05c84ee", "commit_date": "2023-06-20T16:25:17Z", "commit_message": "Merge pull request #2895 from cgwalters/release\n\nRelease 2023.4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f07c93e167848cae6cc91d2fd186fc5d36178b94", "commit_date": "2023-06-20T16:22:49Z", "commit_message": "Merge pull request #2893 from cgwalters/update-prow-config\n\nci: Add some composefs testing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ebb96242044243bac02b74327898818dce7753c9", "commit_date": "2023-06-20T15:01:57Z", "commit_message": "Merge pull request #2892 from ostreedev/dependabot/submodules/composefs-08bdb03\n\nbuild(deps): bump composefs from `c9188cd` to `08bdb03`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6035125d5b8652fb3f1c06dea4c3fc0a6556e6b", "commit_date": "2023-06-20T13:39:43Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c35149c7e06245bc4fb8b4e210cb3bfcb3c7726", "commit_date": "2023-06-20T13:39:04Z", "commit_message": "Release 2023.4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a113b2be3f597c2e4368f840063da70389e26fb0", "commit_date": "2023-06-20T11:44:38Z", "commit_message": "Merge pull request #2891 from cgwalters/commit-compute-composefs-digest\n\nlib: Rework composefs metadata, drop custom signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6df69880de0399a22aa98f549466a30961331d3d", "commit_date": "2023-06-19T23:07:01Z", "commit_message": "ci: Sync prow config with rpm-ostree, enable composefs there\n\nI want to gain testing over the composefs path; but without\nyet changing the main Jenkins build.  Because we have duplicate/overlapping\nCI systems, we can take advantage of this by testing the composefs\nflow via Prow.\n\nSync the Prow build scripts with what's in coreos/rpm-ostree\nright now.\n\nThen let's test the composefs flow a bit more e2e there.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c7e256cee075e2c43cd5c9b37142423c9a98342", "commit_date": "2023-06-19T23:02:20Z", "commit_message": "tests: Add a sanity check for composefs\n\nPrep for adding some coverage of this flow when booting with\ncomposefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b56da3409d8f1eb6551c9901cbe8bafbe4382d5b", "commit_date": "2023-06-19T21:29:31Z", "commit_message": "docs/composefs: Updates\n\n- fix URL\n- Document requirements\n- Document kernel argument\n- Adjust for recent changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1582edd1d4a6b26874d3897de8a5586f979a0715", "commit_date": "2023-06-19T12:59:34Z", "commit_message": "build(deps): bump composefs from `c9188cd` to `08bdb03`\n\nBumps [composefs](https://github.com/containers/composefs) from `c9188cd` to `08bdb03`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/c9188cd1f80374d0785e90d2e4d31749b9f91395...08bdb030fcff4f55ef63aa828b09b57a6cd4d234)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6f2d053c89657a4542286d13460a7ef3c632bb4", "commit_date": "2023-06-17T21:08:46Z", "commit_message": "lib: Rework composefs metadata, drop custom signatures\n\nWe will be switching to handling signature verification of\nthe target ostree commit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "dd47090e2fc3f884cced6245cfa43885b28ea694", "commit_date": "2023-06-17T15:30:49Z", "commit_message": "Merge pull request #2890 from cgwalters/composefs-err-frees\n\ncomposefs: Avoid double free in error path", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "79adccee38afb01d5d410ca61c721aa0ffafde9a", "commit_date": "2023-06-17T13:11:51Z", "commit_message": "composefs: Avoid double unref\n\nThe interaction of `iter_loop` and autofree is way too subtle;\nI happened to be reading this code and noticed we did the NULL\nreset in one path but not another.\n\nThe real fix is Rust...", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1fe2bb9f5a3ee2d138dc04124a34b17a06468525", "commit_date": "2023-06-16T18:26:01Z", "commit_message": "Merge pull request #2885 from cgwalters/doc-composefs\n\ncomposefs: Add some basic docs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "95f2c72c9f76a2514476b7bb574367e6a74809d5", "commit_date": "2023-06-15T21:35:45Z", "commit_message": "Merge pull request #2886 from daissi/wip/daissi/disable-http2\n\nostree-fetcher-curl: explicitly use HTTP1.1 when HTTP2 is disabled", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "186055d6dd962dbb4039529c89294d219e53b426", "commit_date": "2023-06-15T19:25:12Z", "commit_message": "Merge pull request #2888 from cgwalters/more-error-prefixing\n\nAdd more error prefixing when parsing commit objects", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c71fc3d9940a09287e215797926e591cd72f72c6", "commit_date": "2023-06-15T18:39:02Z", "commit_message": "Add more error prefixing when parsing commit objects\n\nI've got more debug information in the error case that motivated\nhttps://github.com/ostreedev/ostree/pull/2884/commits/bae4347abeaa2a66d213758f790058f42cb71fd1\n\"pull: Add error prefixing for corrupt checksums\"\nwhere the sole error is\n\n`error: Invalid checksum of length 0 expected 32`\n\nThis must be coming from the pull code in the case where we've\nalready fetched the commit object.\n\n- Add some error prefixing here in the core commit validation code\n- Ensure that we do the validation immediately after loading, including\n  of the parent commit reference where I think this error must be coming\n  from\n- Then the pull code can just safely call `ostree_commit_get_parent`\n  which already does the hex conversion etc.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d1ec6cdf8632f596da2fae8a105ca24724072bf7", "commit_date": "2023-06-15T13:41:16Z", "commit_message": "ostree-fetcher-curl: explicitly use HTTP1.1 when HTTP2 is disabled\n\nThe current logic to select the HTTP version to be use relies on\nthe fact that curl don't use by default HTTP2. This assumption seems wrong with\nrecent versions of curl.\n\nSigned-off-by: Dylan A\u00efssi <dylan.aissi@collabora.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "91c6b1a6d2c1b7965bbb4f63fb6a343b2b6fb0cf", "commit_date": "2023-06-14T20:41:48Z", "commit_message": "composefs: Add some basic docs\n\nLet's describe the state of things at a high level, independent\nof the tracking issue which has a lot more detail (and hence noise).\n\nThis document keeps things at a high level and describes how to\nenable things today.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ff805f1c4f404c3501bedddc8f70c22aa2b04024", "commit_date": "2023-06-14T18:09:47Z", "commit_message": "Merge pull request #2880 from kraj/main\n\nfix build with lld linker", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c3bd439d3e9c8cfad40a8080d35c5d6b29041039", "commit_date": "2023-06-14T16:39:34Z", "commit_message": "libostree: Link with libgpg-error for gpg_strerror_r API\n\nWith f461c02bb55bf2853a3b81ed5c8618040ab54e98 use of gpg_strerror_r\nwas added this symbol comes from libgpg-error however, therefore its\nneeded to add -lgpg-error to cmdline to resolve this symbol especially\nwith gold and lld linker. Fixes\n\naarch64-yoe-linux-ld.lld: error: undefined reference due to --no-allow-shlib-undefined: gpg_strerror_r\n>>> referenced by ./.libs/libostree-1.so", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c555ad7556ea1a1a5a1fc68926823ccd9243c6ee", "commit_date": "2023-06-14T16:29:46Z", "commit_message": "Merge pull request #2884 from cgwalters/errprefix-pull-checksums\n\npull: Add error prefixing for corrupt checksums", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bae4347abeaa2a66d213758f790058f42cb71fd1", "commit_date": "2023-06-14T15:19:44Z", "commit_message": "pull: Add error prefixing for corrupt checksums\n\nI got a bug report with the bare error\n```\nerror: Invalid checksum of length 0 expected 32\n```\n\nAnd I'm pretty sure it's from here.  Add error prefixing so we\nknow exactly which metadata object was corrupt.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8971bd05ee505bd86d9e0689a31b4ff43235ae55", "commit_date": "2023-06-14T13:36:06Z", "commit_message": "Merge pull request #2881 from ostreedev/dependabot/submodules/composefs-c9188cd\n\nbuild(deps): bump composefs from `af8e1a7` to `c9188cd`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e79591501c3b407c8e0b456272800ffb107784cb", "commit_date": "2023-06-13T22:36:32Z", "commit_message": "Merge pull request #2882 from cgwalters/more-test-concurrency\n\ntest-concurrency: Don't lower timeout", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7892818fb183e9b510e920a6f0658a214e4aa173", "commit_date": "2023-06-13T20:17:16Z", "commit_message": "test-concurrency: Don't lower timeout\n\nI think there's never been a real race condition here.  Instead\nthe problem is:\n\n- We have a timeout on the lock, after which we error out (30s)\n- This test actually *lowers* the timeout\n\nLooking through the failures for test-concurrency what I see\nis\n`error: Locking repo exclusive failed: Resource temporarily unavailable`\nwhich is us hitting the timeout.\n\nHardcoded timeouts are just going to be subject to race conditions.\nI understand not wanting to block forever in some cases, but any\narbitrary timeout is just going to get hit in real world conditions\ntoo.\n\nAnyways for now, stop shooting ourselves in the foot and at least\nkeep the timeout at the default.\n\nCloses: https://github.com/ostreedev/ostree/issues/2038", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "92445188960d03d5b8dd1ad681beb776611984b2", "commit_date": "2023-06-13T15:02:48Z", "commit_message": "Merge pull request #2865 from barthalion/increase-metadata-size\n\nIncrease the metadata size limit to 128MB", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "40c07362c1e6cf81fa949b8c7907c0206466dfb8", "commit_date": "2023-06-13T13:46:56Z", "commit_message": "Update big metadata size in test-pull-large-metadata", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f142b7deeabaee1d1ad70643ef2a0191f4c54769", "commit_date": "2023-06-13T12:58:56Z", "commit_message": "build(deps): bump composefs from `af8e1a7` to `c9188cd`\n\nBumps [composefs](https://github.com/containers/composefs) from `af8e1a7` to `c9188cd`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/af8e1a7cf6864c27e2ceac44cc145bd78734df30...c9188cd1f80374d0785e90d2e4d31749b9f91395)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c4591c2d285a890c0db3789f9d8e1d727aa174af", "commit_date": "2023-06-10T15:36:03Z", "commit_message": "Merge pull request #2879 from alexlarsson/composefs-new-signature-approach\n\ncomposefs: Change how we do signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2d476611a00439e2c3744d0dad2e82156c37fa8c", "commit_date": "2023-06-10T15:13:33Z", "commit_message": "composefs: Change how we do signatures\n\nCurrently we generate a signature for the actual composefs image, and\nthen we apply that when we enable fsverity on the composefs\nimage. However, there are some issues with this.\n\nFirst of all, such a signed fs-verity image file can only be read if\nthe corresponding puiblic keyring is loaded into the fs-verity\nkeyring. In a typical secure setup we will have a per-commit key that\nis loaded from the initrd. Additionally, the keyring is often sealed\nto avoid loading more keys later.\n\nThis means you can only ever mount (or even look at) composefs images\nfrom the current boot. While this is not a huge issue it is something\nof a pain for example when debugging things.\n\nSecondly, and more problematic, during a deploy we can't enable\nfs-verity on the newly created composefs file, because and at that\npoint you need to pass in the signature. Unfortunately this will fail\nif the matching public key is not in the keyring, which will fail for\nsimilar reasons as the first issue.\n\nThe current workaround is to *not* enable fs-verity during deploy, but\nwrite the signature to a file. Then the first time the particular\ncommit is booted we apply the signature to the iamge. This works\naround issue two, but not issue one. But it causes us to do a lot of\nwrites and computation during the first boot as we need to write the\nfs-verity merkle tree to disk. It would be much better and robust if\nthe merkle tree could be written during the deployment of the update\n(i.e. before boot).\n\nThe new apporach is to always deploy an unsigned, but fs-verity\nenabled composefs image. Then we create separate files that contain\nthe expected digest, and a signature of that file. On the first boot\nwe sign the digest file, and on further boots we can just verify\nthat it is signed before using it.\n\nThis fixes issue 1, since all deploys are always readable, and it\nmakes the workaround for issue 2 much less problematic, as we only\nneed to change a much smaller file on the first boot.\n\nLong term I would like to avoid the first-boot writing totally, and\nI've been chatting with David Howells (kernel keyring maintainer) and\nhe proposed adding a new keyring syscall that verifies a PKCS#7\nsignature from userspace directly. This would be exactly what\nfs-verity does, except we wouldn't have to write the digest to disk\nduring boot, we would just read the digest file and the signature file\neach boot and ask the kernel to verify it.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "05faa1d8906c5a6d07dc4da7d1009765ac1a57c1", "commit_date": "2023-06-09T11:56:25Z", "commit_message": "Merge pull request #2877 from ericcurtin/ostree-aboot\n\nAdd ostree=aboot for signed Android Boot Images", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bb4a89e23cb7834956681159d9eac3b76cbe021c", "commit_date": "2023-06-08T17:14:50Z", "commit_message": "Update submodule: composefs\n\nWe will need the new fsverity computation helpers.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "adf60e26ce6e44bbd55d69926ab4a450bac59493", "commit_date": "2023-06-08T14:27:16Z", "commit_message": "Fix read_proc_cmdline_key (\"ot-composefs\") memory leak\n\nMake it an autofree_char rather than a char", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa72caffb540114a0e8635ab2990b9c8b0b8f9db", "commit_date": "2023-06-08T14:27:07Z", "commit_message": "Add ostree=aboot for signed Android Boot Images\n\nSome kernel images are delivered in a signed kernel + cmdline +\ninitramfs + dtb blob. When this is added to the commit server side, only\nafter this do you know what the cmdline is, this creates a recursion\nissue. To avoid this, in the case where we have ostree=aboot karg\nset, create a symlink after deploy to the correct ostree target in the\nrootfs, as the cmdline can't be malleable and secured client-side at\nthe same time.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "59a653c9dd3aa7aa5f0b5b49c6bec288c6cd747a", "commit_date": "2023-06-07T17:34:56Z", "commit_message": "Merge pull request #2875 from cgwalters/tempf-always-repo\n\nfetcher: Always open tmpfiles in repo location", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0a3dd22f83703972a489cd4dd26a6e712aef136c", "commit_date": "2023-06-07T08:52:06Z", "commit_message": "Merge pull request #2872 from cgwalters/composefs-followups\n\nComposefs followups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f7f6f87c513c9f35bc24f35e909779c19cb49d3a", "commit_date": "2023-06-06T21:09:30Z", "commit_message": "fetcher: Always open tmpfiles in repo location\n\nIn an installation environment (like a live ISO) we may\nnot have significant space outside of the target installation\nrepository.\n\nThere's no reason not to always open a linkable tempfile.  In\nthe future we should fix the pull path to verify the checksum\nand then just directly link in the object instead of copying.\n\nCloses: https://github.com/ostreedev/ostree/issues/2571", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8762062648bb72b44a5cb21a83b303bbfcfc2253", "commit_date": "2023-06-06T16:37:41Z", "commit_message": "Merge pull request #2874 from aospan/inode64-fix\n\ncommit: fix ostree deployment on 64-bit inode fs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "de6fddc6adee09a93901243dc7074090828a1912", "commit_date": "2023-06-06T13:37:47Z", "commit_message": "commit: fix ostree deployment on 64-bit inode fs\n\nThis commit addresses a bug that was causing ostree deployment\nto become corrupted on the large fs, when any package was installed using\n'rpm-ostree install'.\n\nIn such instances, multiple files were assigned the same inode. For\nexample, the '/home' directory and a regular file 'pkg-get' were\nassigned the same inode (2147484070), making the deployment unusable.\n\nA root cause analysis was performed, running the process under gdb,\nwhich revealed a lossy conversion from guint64 to guint32, for example\n6442451366 converted to 2147484070:\n\n(gdb) p name\n$10 = 0x7fe9224d2d70 \"home\"\n\n(gdb) p inode\n$73 = 6442451366\n\n(gdb) s\n    device=66311, modifier=0x7fe914791840) at\nsrc/libostree/ostree-repo-commit.c:1590\n\nThe conversion resulted in entirely independent files potentially\nreceiving the same inode.\n\nThe issue was discovered on PoC machine equipped with a large NVME\n(3.4TB), but the bug can be easily reproduced using `cosa run -m 4000\n--qemu-size +3TB', followed by installation of any package using\n`rpm-ostree install`. The resulting deployment will be unusable due to\nmany files being \"corrupted\" by the aforementioned issue.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "12b7f328e226f151caecb26af06081da85d40744", "commit_date": "2023-06-05T17:17:58Z", "commit_message": "prepare-root: More logging in composefs, minor cleanup\n\n- Hoist the `.ostree.cfs` to a shared constant\n- Add more logging in general for extra visibility", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "624b1084ab93181ede31571db8226e4322a6171c", "commit_date": "2023-06-02T17:10:12Z", "commit_message": "prepare-root: Add another missing O_CLOEXEC", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "624512f9a7b53d31f0f6b26a9d285bc08309c477", "commit_date": "2023-06-02T14:59:34Z", "commit_message": "composefs: Factor out a shared helper for setting error\n\nTo keep the error messages consistent.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1f9607a8e92603d505f1709ee3e7c4424614edbd", "commit_date": "2023-06-02T13:28:19Z", "commit_message": "mount-util: Add missing O_CLOEXEC\n\nSeen in review.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b6c054e1fa7d64be8c7d3ed1b815f9c82e6ceb16", "commit_date": "2023-06-02T13:26:04Z", "commit_message": "Merge pull request #2640 from alexlarsson/composefs\n\nAdd initial composefs integration", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "67929db1dc3e60e958220a018ff0665c8052b4ee", "commit_date": "2023-06-01T14:34:13Z", "commit_message": "Merge pull request #2871 from dustymabe/dusty-fallocate-einval\n\nlib/deploy: skip fallocate call when requested size is 0", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "68d1d9a7fc08c281174f57b638fa06f7aea73601", "commit_date": "2023-06-01T13:25:35Z", "commit_message": "lib/deploy: skip fallocate call when requested size is 0\n\nIf the requested size is 0 then of course we have enough room \ud83d\ude42\n\nThis avoids the fallocate call returning an EINVAL.\n\nCloses: #2869", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5eacc96df321039e36bd237824d0c1b7ed8af6ef", "commit_date": "2023-06-01T12:24:48Z", "commit_message": "Merge pull request #2870 from dustymabe/dusty-log-messages\n\nlib/deploy: Disambiguate error messages for early prune space check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a51535b0cd9f64702c35a04d54f42b2998403b67", "commit_date": "2023-06-01T04:00:28Z", "commit_message": "lib/deploy: Disambiguate error messages for early prune space check\n\nHaving the same error message in multiple places means it's not\nclear which case failed. Let's make them unique.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "733380394922f441f743ee57d626ad631f418d5c", "commit_date": "2023-05-31T16:35:44Z", "commit_message": "composefs: When using signatures, delay application until first boot\n\nWe can't safely apply the fs-verity with signature until we have\nbooted with the new initrd, because the public key that matches the\nsignature is loaded from it. So, instead we save the .sig file next\nto the compoosefs, and on the first boot we detect that it is there, and\nthe composefs file isn't fs-verity, so we apply it.\n\nThings get a bit more complex due to having to temporarily make\n/sysroot read-write for the fsverity operation too.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6d2dc959686e530dfd0b4e1ef8c4b480d9a01e1b", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "CI: Build with composefs on some versions\n\nThis enables --with-composefs on:\n * Fedora Latest\n * Debian Testing\n * Ubuntu Latest\n\nThese all should have new enough version of dependencies.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3be4ee52acc4079eaae6e87ffe7f210763e76ad", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "Update submodule: composefs\n\nInstead of using pkg-config, etc we just include composefs.\nIn the end the library is just 5 c source files, and it is set up\nto be easy to use as a submodule.\n\nFor now, composefs support is disabled by default.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f9bdc66649a90e8834d5fa9adb65ede9b2453b8b", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "ostree-remount: Don't skip remount if root is composefs\n\nWhen using composefs the root fs will always be read-only, but in this\ncase we should still continue remounting /sysroot. So, we record a\n/run/ostree-composefs-root.stamp file in ostree-prepare-root if composefs\nis used, and then react to it in ostree-remount.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d47a90347ba4e72ae223d4eb59287a42d32a5df0", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "sysroot: Ensure deployment detection works when using composefs\n\nIn the case of composefs, we cannot compare the devino of the rootfs\nand the deploy dir, because the root is the composefs mount, not a\nbind mount. Instead we check the devino of the etc subdir of the\ndeploy, because this is a bind mount even when using composefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "11d7587e403c897ad918ed8bc6d437e17f86c4c0", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "prepare-root: Support using composefs as root filesystem\n\nThis changes ostree-prepare-root to use the .ostree.cfs image as a\ncomposefs filesystem, instead of the checkout.\n\nBy default, composefs is used if support is built in and the .ostree.cfs\nfile exists in the deploy dir, otherwise we fall back to the old\nmethod. However, if the ot-composefs kernel option is specified this\ncan be tweaked as per:\n * off: Never use composefsz\n * maybe: Use if possible\n * on: Fail if not possible\n * signed: Fail if the cfs image is not fs-verity signed with\n   a key in the keyring.\n * digest=....: Fail if the cfs image does not match the specified\n   digest.\n\nThe final layout when composefs is active is:\n\n /        ro overlayfs mount for composefs\n /sysroot \"real\" root\n /etc     rw bind mount to $deploydir/etc\n /var     rw bind mount to $vardir\n\nWe also specify the $deploydir/.ostree-mnt directory as the (internal)\nmountpoint for the erofs mount for composefs. This can be used to map\nthe root fs back to the deploy id/dir in use,\n\nA further note: I didn't test the .usr-ovl-work overlayfs case, but a\ncomment mentions that you can't mount overlayfs on top of a readonly\nmount. That seems incompatible with composefs. If this is needed we\nhave to merge that with the overlayfs that composefs itself sets up,\nwhich is possible with the libcomposefs APIs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bba3109fe2a746b59424369f839c8380fb9b35a7", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "switchroot: Make read_proc_cmdline_ostree() take a key argument\n\nThis changes it into read_proc_cmdline_key(), as this will later be\nused to read additional keys.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3fcebe454ed78df378b656af2013e43c648dbe46", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "composefs deploy: Store cfs signature in .ostree.cfs.sig file\n\nIn many cases, such as when using osbuild, we are not preparing the final\ndeployment but rather a rootfs tree that will eventually be copied to the\nfinal location. In that case we don't want to apply the signature directly\nbut when the deployment is copied in place.\n\nTo make this situateion workable we also write the signature to a file\nnext to the composefs image file. Then whatever mechanism that does\nthe final copy can apply the signature.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c988ff79387b5b61a1134c5f0d91010b0a280fd6", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "deploy: Write a .ostree.cfs composefs image in the deploy dir\n\nThis can be used as a composefs source for the root fs instead of\nthe checkout by pointing the basedir to /ostree/repo/objects.\n\nWe only write the file is `composefs` is enabled.\n\nWe enable ensure_rootfs_dirs when building the image which adds the\nrequired root dirs to the image. In particular, this includes /etc\nwhich often isn't in ostree commits in use.\n\nWe also create an (empty) .ostree.mnt directory, where composefs\nwill mount the erofs image that will be used as overlayfs lowerdir\nfor the root overlayfs mount. This way we can find the deploy\ndir from the root overlayfs mount options.\n\nIf the commit has composefs digests recorded we verify those with the\ncreated file. It also applies the fs-verity signature if it is\nrecorded, unless this is disabled with the\nex-integrity.composefs-apply-sign=false option.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c3d9894be1f1fa0a825aa7b16c119b72c4edc7e", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "Commit: Add composefs digest and sig to the commit metadata\n\nIf `composefs-apply-sig` is enabled (default no) we add an\nostree.composefs digest to the commit metadata. This can be verified\non deploy.\n\nThis is a separate option from the generic `composefs` option which\ncontrols whether composefs is used during deploy. It is separate\nbecause we want to not have to force use of fs-verity, etc during the\nbuild.\n\nIf the `composefs-certfile` and `composefs-keyfile` keys in the\nex-integrity group are set, then the commit metadata also gets a\nostree.composefs-sig containing the signature of the composefs file.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e2956e2c08fb3e11e249b540db3a5b760dd04fac", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "lib: Add (private) API for checking out commits into a composefs image\n\nThis supports checking out a commit into a tree which is then\nconverted into a composefs image containing fs-verity digests for all\nthe regular files, and payloads that are relative to a the\n`repo/objects` directory of a bare ostree repo.\n\nSome specal files are always created in the image. This ensures that\nvarious directories (usr, etc, boot, var, sysroot) exists in the\ncreated image, even if they were not in the source commit. These are\nneeded (as bindmount targets) if you want to boot from the image. In\nthe non-composefs case these are just created as needed in the checked\nout deploydir, but we can't do that here.\n\nThis is all controlled by the new ex-integrity config section, which\nhas the following layout:\n\n```\n[ex-integrity]\nfsverity=yes/no/maybe\ncomposefs=yes/no/maybe\ncomposefs-apply-sig=yes/no\ncomposefs-add-metadata=yes/no\ncomposefs-keyfiile=/a/path\ncomposefs-certfile=/a/path\n```\n\nThe `fsverity` key overrides the old `ex-fsverity` section if\nspecified.  The default for all these is for the new behaviour to be\ndisabled. Additionally, enabling composefs implies fsverity defaults\nto `maybe`, to avoid having to set both.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9ba98cd8e98ae9501dc1c03ff69920b94f8cd429", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "fsverity: Support passing a signature when enabling fs-verity\n\nThe composefs code will need this.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c6ed5cc7b2e09730fda8d7c0b2502774796020e8", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "fsverity: Add _ostree_fsverity_sign helper\n\nThis code signs a fsverity digest (using openssl) such that the\nresulting signature can be used with the FS_IOC_ENABLE_VERITY ioctl.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "02d24d2a3854185cb1f4174f04efa59f1c6d53e9", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "Add ot_keyfile_get_tristate_with_default() helper\n\nThis parses keys like yes/no/maybe. The introduced OtTristate type\nis compatible with the existing _OstreeFeatureSupport type.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0dd2788410be83a588501e3589947f5ce70f6d37", "commit_date": "2023-05-30T13:15:40Z", "commit_message": "Merge pull request #2864 from cgwalters/prepare-root-prepare-composefs\n\nprepare-root: Move sysroot.tmp creation earlier", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f903d6af6735289abc6b0c50a742f1d29df22df6", "commit_date": "2023-05-30T12:38:16Z", "commit_message": "Merge pull request #2866 from jlebon/pr/autoprune-tweaks\n\nlib/deploy: Use `fallocate` for early prune space check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "193ef29f3f0886e3d59e6580e394f8817f2f123e", "commit_date": "2023-05-29T16:17:05Z", "commit_message": "lib/deploy: Use `fallocate` for early prune space check\n\nThe `f_bfree` member of the `statvfs` struct is documented as the\n\"number of free blocks\". However, different filesystems have different\ninterpretations of this. E.g. on XFS, this is truly the number of blocks\nfree for allocating data. On ext4 however, it includes blocks that\nare actually reserved by the filesystem and cannot be used for file\ndata. (Note this is separate from the distinction between `f_bfree` and\n`f_bavail` which isn't relevant to us here since we're privileged.)\n\nIf a kernel and initrd is sized just right so that it's still within the\n`f_bfree` limit but above what we can actually allocate, the early prune\ncode won't kick in since it'll think that there is enough space. So we\nend up hitting `ENOSPC` when we actually copy the files in.\n\nRework the early prune code to instead use `fallocate` which guarantees\nus that a file of a certain size can fit on the filesystem. `fallocate`\nrequires filesystem support, but all the filesystems we care about for\nthe bootfs support it (including even FAT).\n\n(There's technically a TOCTOU race here that existed also with the\n`statvfs` code where free space could change between when we check\nand when we copy. Ideally we'd be able to pass down that fd to the\ncopying bits, but anyway in practice the bootfs is pretty much owned by\nlibostree and one doesn't expect concurrent writes during a finalization\noperation.)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "76649127d1f415abdfd2e8de62ce8a2beef5f412", "commit_date": "2023-05-28T22:39:03Z", "commit_message": "lib/deploy: Rename variable for clarity\n\n`size_to_remove` looks cryptic in contrast to\n`new_new_bootcsum_dirs_total_size`. Rename it in the style of the latter\nfor easier reading.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a3c0d6a3fee7958ebfb6f8bc3c70f053be5c3085", "commit_date": "2023-05-28T22:38:53Z", "commit_message": "lib/deploy: Log case when auto-pruning is hopeless\n\nFor easier diagnostics.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "115d5cf0730cd39b3a27799bd15dfb17ba97c9b4", "commit_date": "2023-05-28T22:38:38Z", "commit_message": "lib/deploy: Drop unused variable\n\nNoticed this diagnostic in my editor with clangd hooked up.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "632ffa430205473e6727e3402016ad8077164dea", "commit_date": "2023-05-27T14:38:14Z", "commit_message": "lib/deploy: Initialize var to pacify gcc static analysis\n\nClassic case of analysis getting confused by variables initialized by\na function.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c22576c41de469637b4e6098644295ba65d7e21d", "commit_date": "2023-05-24T19:50:38Z", "commit_message": "prepare-root: Move sysroot.tmp creation earlier\n\nMain motivation is prep for composefs in\nhttps://github.com/ostreedev/ostree/pull/2640\nIn the interest of that, we add a `bool using_composefs` but\nit's currently always `false`.\n\nCo-authored-by: Alexander Larsson <alexl@redhat.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "50790b285e5b5c72c76ea4017850cafa26f40e51", "commit_date": "2023-05-22T17:37:10Z", "commit_message": "Merge pull request #2860 from cgwalters/xshell2\n\ntests: A bit more xshell porting", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b5b3ef78af6c6a52a7ac11c06f80cb8eea67782b", "commit_date": "2023-05-18T21:09:04Z", "commit_message": "Merge pull request #2859 from jmarrero/release-2023.3\n\nRelease 2023.3", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88e8b671ce03135b30411a129664f9ac46e24adb", "commit_date": "2023-05-18T12:14:50Z", "commit_message": "tests: A bit more xshell porting\n\nPart of https://github.com/ostreedev/ostree/issues/2857", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88fe600ff8e498e0648258d9a56fd4008808ea33", "commit_date": "2023-05-17T20:32:43Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}], "main": [{"commit_oid": "13be0786bb8b451112518acb6ba8568c645b9712", "commit_date": "2023-09-21T23:50:05Z", "commit_message": "Merge pull request #3021 from cgwalters/insttest-composefs-binding\n\ntests: Add an integration test for composefs signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "46b7821d0cbffceabc5020aa99f034282164ea58", "commit_date": "2023-09-21T17:13:27Z", "commit_message": "Merge pull request #3053 from ericcurtin/add_overlay_and_erofs_to_initrd\n\nboot/dracut: Add erofs and overlayfs kernel modules", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cecb59dd534b4adffce785a2777c4f9544f5c8c1", "commit_date": "2023-09-21T16:03:07Z", "commit_message": "boot/dracut: Add erofs and overlayfs kernel modules\n\nThese kernel modules are required for composefs usage in the initramfs.\n\nThe composefs use-case as of today uses an overlayfs on top of EROFS.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "372cbd7a64c9137524e30ee4fd98a7ac85559820", "commit_date": "2023-09-21T11:53:19Z", "commit_message": "tests: Add an integration test for composefs signatures\n\nEnsure we have some automated test coverage for this.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cd606aa6fe369ea7730965f5ecbb194a202ace68", "commit_date": "2023-09-20T13:18:31Z", "commit_message": "Merge pull request #3051 from cgwalters/rust-tests-update\n\nrust/tests: Adjust for new ostree", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "87c43678061276894af2d0c26a8f7958863de424", "commit_date": "2023-09-20T12:48:17Z", "commit_message": "Merge pull request #3052 from cgwalters/switch-libglnx-source\n\ngitmodules: Use github GNOME mirror", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "01a847a2d1c86df57e3e21d11df103eb34cd465a", "commit_date": "2023-09-20T11:58:44Z", "commit_message": "gitmodules: Use github GNOME mirror\n\ngitlab.gnome.org is down right now, but it's been somewhat\nflaky in the past.  Our CI uptime becomes an *intersection*\nof all systems it depends on, and by cutting out gitlab.gnome.org\nwe increase its reliability.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3291ccce9d32415e5058786ff991e7d5b800f4b", "commit_date": "2023-09-19T20:52:13Z", "commit_message": "tests: Rework detection of trivial-httpd\n\nBecause it's now at the toplevel.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "878d601665fd15781adf774d99dd86e9a172cb92", "commit_date": "2023-09-18T15:08:13Z", "commit_message": "Merge pull request #3047 from ostreedev/dependabot/submodules/libglnx-aff1eea", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ff73bebc74aa6dc0ed72355f408729c40ae115ca", "commit_date": "2023-09-18T12:18:48Z", "commit_message": "build(deps): bump libglnx from `54ad67d` to `aff1eea`\n\nBumps libglnx from `54ad67d` to `aff1eea`.\n\n---\nupdated-dependencies:\n- dependency-name: libglnx\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "92d25eb56bcb17ee117ef5b877de86dc828e823f", "commit_date": "2023-09-12T13:10:11Z", "commit_message": "Merge pull request #3039 from cgwalters/rust-switch-include", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "26dcd4f575ca36996904a76569344cdf59fc3598", "commit_date": "2023-09-11T21:16:41Z", "commit_message": "rust: Switch to using `include`\n\nThis way we don't randomly pick up bits from the C library\nunintentionally as things change on that side.\n\nI think the support for `!` in `include` may be relatively new\nand that's why the original author here chose to do things\nvia `exclude`.  But using `include` with a few specific exclusions\nis just way better.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b7e39eba074bae071545fe06738b710ffeacddb8", "commit_date": "2023-09-11T13:41:13Z", "commit_message": "Merge pull request #2054 from jlebon/pr/static-delta-fetch-no-scan\n\nlib/pull: Don't scan commit objects we fetch via deltas", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cd116a1e63aa9c7114b3ca5ee804fdafa57360af", "commit_date": "2023-09-11T02:17:13Z", "commit_message": "lib/pull: Drop static delta superblocks references\n\nWe don't need them long-lived anymore. They were just used for reporting\nat this point, but we can use the new `static_delta_targets` hash table\nsize for that now.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2fe88f80fae83e206f811003a072c73ceebcea59", "commit_date": "2023-09-09T01:09:09Z", "commit_message": "ci: Run cosa unprivileged\n\nAs a workaround for a virtiofs bug:\nhttps://gitlab.com/virtio-fs/virtiofsd/-/merge_requests/197\n\nxref coreos/coreos-assembler#3428 (comment)\n\nJust like in https://github.com/coreos/rpm-ostree/pull/4585.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fc5aef6fe6332fa7ddc057064afcabc3d6d680f4", "commit_date": "2023-09-08T21:49:25Z", "commit_message": "lib/pull: Don't scan commit objects we fetch via deltas\n\nWhen we're fetching a commit via static delta, we already take care of\nfetching the full commit, so there's no need to also scan it using the\nregular object workflow.\n\nCloses: #2053", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c8ed1c7a871c0cfe5ec1e4c0b0971f1433b62992", "commit_date": "2023-09-08T21:49:25Z", "commit_message": "lib/pull: Fix miscounting of missing metadata\n\nIf e.g. detached metadata or a parent commit is missing, we\ndon't consider it an error but we erroneously still increment the\n`n_fetched_metadata` counter, causing it to be higher than it should.\n\nThis will implicitly be tested by a test added in the next patch.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c2587b619a268bd83ab4924a905e0b325250b73", "commit_date": "2023-09-08T19:07:29Z", "commit_message": "app/pull-local: Add `--disable-static-delta`\n\nFor completeness with `pull`.\n\nPrep for using it in testing to assert we'll never use static deltas.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0ac8795686ab3c8ad4d7f993bea6ed69b39e9334", "commit_date": "2023-09-08T16:03:21Z", "commit_message": "Merge pull request #3038 from cgwalters/rust-drop-composefs\n\nrust: Drop composefs from crate", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6a948567293d9ed55cb8e05be52d47b038e5c8a0", "commit_date": "2023-09-08T11:52:44Z", "commit_message": "Merge pull request #3037 from cgwalters/add-labeler-flow\n\nci: Add an automatic labeler action", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2db17d210712079ba9cd145703739d8ec803719d", "commit_date": "2023-09-08T11:38:31Z", "commit_message": "rust: Drop composefs from crate\n\nThis greatly reduces the size.  TODO: switch to using `include`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "749857df67a4cc76b72c4684dd9e4f85f38b0ffc", "commit_date": "2023-09-08T11:24:56Z", "commit_message": "Merge pull request #3035 from cgwalters/release-rust\n\nrust/sys: Also bump semver for this", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "129969482ec305c25f3a097cd13c30070f2fb84a", "commit_date": "2023-09-07T21:38:59Z", "commit_message": "ci: Add an automatic labeler action\n\nTo automate a bit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1714e8371f7b12b492dbc17964fc26466df7ca56", "commit_date": "2023-09-07T20:21:39Z", "commit_message": "Merge pull request #3030 from ostreedev/dependabot/submodules/composefs-af86742\n\nbuild(deps): bump composefs from `d085fbf` to `af86742`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e52530b5e05864662103ea9abe942912b2fd5e9e", "commit_date": "2023-09-07T18:54:56Z", "commit_message": "rust/sys: Also bump semver for this\n\nSince we bumped the glib major.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4d3621db08473013e328d88d45f8610b0a71f405", "commit_date": "2023-09-06T13:39:35Z", "commit_message": "build(deps): bump composefs from `d085fbf` to `af86742`\n\nBumps [composefs](https://github.com/containers/composefs) from `d085fbf` to `af86742`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/d085fbf6c8364f3781de7988b13c0f6dbf9e975b...af867425799db92c92d35feb51d2c957f3e16ac7)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "00c04aefd3070aa6119f725e81b231daead0f7e3", "commit_date": "2023-09-06T13:32:33Z", "commit_message": "Merge pull request #3028 from ostreedev/dependabot/submodules/composefs-d085fbf\n\nbuild(deps): bump composefs from `597a766` to `d085fbf`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b0e328114d95f408b64dad18245e573db6ec7561", "commit_date": "2023-09-06T13:06:04Z", "commit_message": "Merge pull request #3029 from cgwalters/bump-glib\n\nrust: Port to glib 0.18", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aee1ab2c99697d977695ecc7abbc928797ee5881", "commit_date": "2023-09-01T12:44:25Z", "commit_message": "rust: Bump semver to 0.19\n\n- New glib 0.18 dependency\n- Drop cap-std APIs and features\n- Other minor changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cccc0f1a5b79e2c9d447ee04f123336abe9f1519", "commit_date": "2023-09-01T12:44:25Z", "commit_message": "rust: Port to glib 0.18\n\n- Also rolls up a few other changes in the C API\n- Drop `&mut` from `OstreeKernelArgs`; it now confuses type inference.\n  More generally while using `&mut` here was well intentioned, it\n  goes against the glib standard of mapping everything to `&` and\n  accepting interior mutability.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b60036dd92eaf10480a618179bb7b4c2baa078d3", "commit_date": "2023-09-01T12:27:47Z", "commit_message": "build(deps): bump composefs from `597a766` to `d085fbf`\n\nBumps [composefs](https://github.com/containers/composefs) from `597a766` to `d085fbf`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/597a76609574cf9133d1e17ec0a7b99877a0b709...d085fbf6c8364f3781de7988b13c0f6dbf9e975b)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5fe050f51a660d60cebe401de42c829f3247a955", "commit_date": "2023-08-31T21:48:15Z", "commit_message": "Merge pull request #3027 from cgwalters/drop-cap-std-public\n\nDrop cap-std from our public APIs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9121297e7b549d94fc5a5451ecf826e31507ef64", "commit_date": "2023-08-31T20:33:07Z", "commit_message": "ci: Move lints into main build\n\nAnd drop another hardcoded MSRV.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "242a9015248026a2335df3b503d320dd91d7b5cb", "commit_date": "2023-08-31T19:34:26Z", "commit_message": "rust: Bump rust-version = 1.70\n\nTo pick up the new `AsFd` etc.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "eec67ec109d63b516f7ba1991f343bb82ff41bb4", "commit_date": "2023-08-31T19:34:26Z", "commit_message": "Drop cap-std from our public APIs\n\nSince it bumped semver (when I didn't expect it to; xref\nhttps://github.com/bytecodealliance/cap-std/commit/963eebf3ab52b04a2e8b9ba88ce6308bbed5cbd0#r121651362\n\nIt's not load-bearing enough here to matter versus just passing\nan untyped file descriptor.\n\nThis mainly means that it will be the `glib` ecosystem which\nforces transitive semver bumps for us, not both.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e93ebd738598406cd8a8e57fdc341cf1f1d9baae", "commit_date": "2023-08-31T16:16:50Z", "commit_message": "Merge pull request #3018 from ostreedev/dependabot/submodules/composefs-597a766\n\nbuild(deps): bump composefs from `1aed878` to `597a766`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8d838230f188622b27909997f23e6415df132b44", "commit_date": "2023-08-31T15:30:26Z", "commit_message": "Merge pull request #3012 from cgwalters/default-early-prune\n\nsysroot: Promote the \"early prune\" behavior to default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d5cfbed5bc8e9f9e1884bad7e43831292bb872fc", "commit_date": "2023-08-31T14:25:59Z", "commit_message": "sysroot: Promote the \"early prune\" behavior to default\n\nI think we have enough testing for this, let's default it to\non, and change the variable to allow opt-out in case it does\nintroduce a regression.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c0014e0003e3411a2c1d2e183ac938100d21deed", "commit_date": "2023-08-30T20:24:37Z", "commit_message": "Merge pull request #2968 from cgwalters/drop-global-syncfs-by-default\n\ndeploy: Remove global `sync` by default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d976ec5657b6b8aa67241e21bfacca5b9ed857c4", "commit_date": "2023-08-30T20:14:28Z", "commit_message": "Merge pull request #3024 from cgwalters/clang-analyzer-fixes-5\n\nClang analyzer fixes 5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0d7b8ebc6b9ffaabf57a13361132a700deeb4f29", "commit_date": "2023-08-30T17:23:13Z", "commit_message": "build(deps): bump composefs from `1aed878` to `597a766`\n\nBumps [composefs](https://github.com/containers/composefs) from `1aed878` to `597a766`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/1aed8781d6ce617234175d5d3b0458f91a6e38f3...597a76609574cf9133d1e17ec0a7b99877a0b709)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "52dbed4d77698b9eeb829662c3ec300e8d258db1", "commit_date": "2023-08-30T13:58:01Z", "commit_message": "Merge pull request #3023 from ostreedev/dependabot/submodules/libglnx-54ad67d\n\nbuild(deps): bump libglnx from `c02eb59` to `54ad67d`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4eb3caca6962f9a9eb657292a2baef39a8fc71c3", "commit_date": "2023-08-30T13:23:13Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e1b6983291d08e7ef2e803ea105704038d22dab", "commit_date": "2023-08-30T13:19:42Z", "commit_message": "keyfile-utils: Quiet a clang-analyzer warning\n\nIt complains that we could leak memory if the return value\npointer isn't set.  That's actually a nonsensical case, there's\nno reason to call this and ignore the return value.\n\nSo change things to require it be set, and also change the\n`g_return_val_if_fail` to be hard assertions per our new policy.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3001ef2817b0eab887597457f9bdaa3a3569a362", "commit_date": "2023-08-30T12:21:09Z", "commit_message": "build(deps): bump libglnx from `c02eb59` to `54ad67d`\n\nBumps libglnx from `c02eb59` to `54ad67d`.\n\n---\nupdated-dependencies:\n- dependency-name: libglnx\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "03a198888fec714c30a7d01435086044e1574b5b", "commit_date": "2023-08-29T16:25:42Z", "commit_message": "Merge pull request #3020 from cgwalters/less-return-if-fail-1\n\nmutable-tree: Change some `g_return_if_fail` to `g_assert()`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5837f27ff52658c63e02a72c6fb5d6f2ed10cc04", "commit_date": "2023-08-29T16:25:24Z", "commit_message": "Merge pull request #3019 from cgwalters/more-analyzer-fixes-4\n\nmutable-tree: Quiet clang-analyzer warning", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "886f58005ffd8f214966b305a9f390703c556381", "commit_date": "2023-08-29T14:16:42Z", "commit_message": "mutable-tree: Change some `g_return_if_fail` to `g_assert()`\n\nWe did this in some prior patches because it's better for\nstatic analyzers; code is either reachable or not, and we don't\nwant the default desktop-style behavior of \"try to stumble on\nwithout crashing\".  It's just likely to lead to a crash somewhere\nelse.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "db4ca6e7acfb9e62764a3c1c006c49e13e225e7b", "commit_date": "2023-08-29T14:09:25Z", "commit_message": "mutable-tree: Quiet clang-analyzer warning\n\nThe warning here was about a use-after-free which is serious, but\nI don't think it was reachable in practice, because we'd only\nenter the second conditional if `contents_checksum != self->contents_checksum`,\nyet we made them the same thing here.\n\nNevertheless, refactor the code to do a direct return in this\ncase because that's basically what happened before, and doing\nso is a lot clearer.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d001729bef1217594dd10a005c9e6649f022dab3", "commit_date": "2023-08-29T04:11:36Z", "commit_message": "Merge pull request #3017 from cgwalters/more-analyzer-fixes-3\n\nMore analyzer fixes 3", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6538b1702bf45b427cf6827407da3cd3a2876fb0", "commit_date": "2023-08-28T21:29:57Z", "commit_message": "repo: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "369e4ddd934e2e702e594c5eb277052726ee4ac1", "commit_date": "2023-08-28T21:28:59Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5fc9eac0baf7c159ab21990f1a036713f72b5796", "commit_date": "2023-08-28T21:28:20Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bfb7482a2464d7cd9c267dcefed4485f71c4b1f7", "commit_date": "2023-08-28T21:27:04Z", "commit_message": "lib/commit: Quiet clang-analyzer warning\n\nAnother conditional ownership.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ee8c13b160add030d2ff94ad714cede2f4ca9179", "commit_date": "2023-08-28T21:26:28Z", "commit_message": "lib/delta: Remove dead code\n\nFound by clang-analyzer.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3acdbac000da8110b6fba727c7ef976d7755fe06", "commit_date": "2023-08-28T20:10:58Z", "commit_message": "Merge pull request #3016 from cgwalters/more-analyzer-fixes-2\n\nMore analyzer fixes 2", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "89e13a954cfbb0256bf8ebcd286f68f133b7ec9e", "commit_date": "2023-08-28T14:44:15Z", "commit_message": "Merge pull request #2994 from cgwalters/refactor-composefs-warnings\n\nRefactor composefs warnings", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0beaf5c9acf54fe7b4052159b85ee74b0eb2d4eb", "commit_date": "2023-08-26T17:51:22Z", "commit_message": "pull: Quiet clang-analyzer warning\n\nJust used for side-effects.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e2779a7cf71587e02d0c70c064e013b498418774", "commit_date": "2023-08-26T16:26:39Z", "commit_message": "commit: Quiet clang-analyzer warning\n\nThis is just another instance of the \"conditionally owned\"\npattern.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b40d4bbbadb6af84b57b1282596cb58d147484b", "commit_date": "2023-08-26T16:24:10Z", "commit_message": "pull: Add assertions to quiet clang-analyzer\n\nIt's warning the value can be NULL, but I don't think that's true.\nI believe we're just hitting analysis limit (the path length is 119).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0cfa5e86004bd5f79fe87155bc3448a60993e0e6", "commit_date": "2023-08-26T16:23:26Z", "commit_message": "lib/repo-finder: Squash memory leak\n\nWe want to free this value on each iteration; it's moved below\nif the value is used.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f8549a9e0233e15eb9086820d98277cb9518fc28", "commit_date": "2023-08-26T16:10:55Z", "commit_message": "Merge pull request #3013 from cgwalters/more-analyzer-fixes\n\n2023.6 coverity minor fixes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7c13631af52cb8ba7e87e2f8420d3d31b7d6c858", "commit_date": "2023-08-26T12:13:24Z", "commit_message": "Merge pull request #3006 from cgwalters/misc-c99-style-5\n\nMisc c99 style 5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1a16a7d6845d36c0810963f75243ad43ea69c593", "commit_date": "2023-08-25T20:59:28Z", "commit_message": "switchroot: Use g_new/g_free consistently\n\nCoverity complains about this, even though they're the same thing.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d3ede20ba00ddee262d1a53db1f63dd20aa9125f", "commit_date": "2023-08-25T20:57:12Z", "commit_message": "sign/ed25519: Fix two memory leaks\n\nSpotted by coverity.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a87789e818dddfad26d9870592ff441b765f2afc", "commit_date": "2023-08-25T20:56:07Z", "commit_message": "commit: Drop dead code\n\nCoverity points out that since we're now *always* initializing\nmetadata, the `create_empty_gvariant_dict()` is unreachable.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d36bf35c10a91d75e829f255f75ba16127943bbd", "commit_date": "2023-08-25T19:59:34Z", "commit_message": "switchroot: Lower config parser to otcore, add unit tests\n\nPart of the continuation of unit testing coverage.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "38880bff01a4ed858b8b3d53aa00057b27d5bfc9", "commit_date": "2023-08-25T19:23:06Z", "commit_message": "composefs: Hard error except on ENOENT even in \"optional\" case\n\nSince we enabled composefs at build time, the default (non-composefs)\ncase now always prints\n`composefs: Optional support failed: No such file or directory`\nBut that's normal and expected.\n\nRework things here so that in the very special case where\nwe are in \"maybe/optional\" mode and we get ENOENT, then we\noutput a much more normal-looking message that doesn't include\nthe string \"failed\".\n\nNow on the flip side - if I have explicitly enabled signature\nchecking, I think we *do* want to make that fatal even if\ncomposefs is in \"maybe\" mode.\n\n(This part is more debatable; perhaps we should just disallow\n the case of \"maybe\" + signatures at all; but I think this is\n an improvement in that direction)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e952b1bf1413feb21eb0cc9e2514eb9e1895f2cf", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Fold together composefs signature cases\n\nNow that we don't support digest-but-not-signature verification\nfor composefs, the logic here was unnecessarily complicated.\nWith a prior prep patch that moved the composefs option\ninitialization up, we can just have everything related to signature\nverification in a single conditonal.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1d316e31093e33eff6c3ae7f8081547ef93e72ed", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Init composefs options earlier\n\nPrep for a later patch.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa9b7c3b1b5866eb107e403f8c56d859fc4e22cb", "commit_date": "2023-08-25T19:22:21Z", "commit_message": "prepare-root: Drop redundant print about signature/digest\n\nWe print if we're doing a signature+digest verification; its absence is\nsufficient in the other case.  The goal here is to avoid polluting\nthe logs when signatures are not enabled.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4dd3cb3520a051536910441a06d2ef891ce48966", "commit_date": "2023-08-25T15:11:17Z", "commit_message": "Merge pull request #3005 from cgwalters/release\n\nRelease", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "97d83e6225c15763d4450f73f5f194f0b0ba2f3b", "commit_date": "2023-08-25T01:18:02Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "dab8051fd8b9aa464bd05b6401bf676ef9b1fcb5", "commit_date": "2023-08-25T01:18:02Z", "commit_message": "Release 2023.6", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bd91fda636075c05655b4336434bc036e6b92df9", "commit_date": "2023-08-25T01:13:07Z", "commit_message": "Merge pull request #3010 from cgwalters/more-composefs-fixes\n\nbuild-sys: Really fix composefs check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3648c5ae29ce823592708cc1b9cca4f202d282a4", "commit_date": "2023-08-24T23:58:20Z", "commit_message": "build-sys: Really fix composefs check\n\nThe ordering of the includes apparently matters...and I didn't\nactually check that the previous change enables composefs on c9s.\nBut I did now.  For reals.\n\nWhile we have the patient open, I switched to `AC_LANG_PROGRAM`\nbecause I originally thought the bug had something to do with that.\nAs far as I understand, more cleanly separating the includes\nfrom the injected body text is a useful thing in `AC_LANG_PROGRAM`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "db3b286d6ba1252ad87c2524de632c1ad736fb6e", "commit_date": "2023-08-24T23:38:22Z", "commit_message": "Merge pull request #3009 from cgwalters/c9s-ci\n\nC9s CI && composefs build detection fix", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bcd4d0260659eec066a9ee2928a458e2191258cf", "commit_date": "2023-08-24T22:01:26Z", "commit_message": "Merge pull request #3007 from cgwalters/optin-new-bootloader-naming\n\ndeploy: Add bootloader-naming-2 opt-in", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "33ef4ae620a1854d8f146b4506dcb5a5c5709cd0", "commit_date": "2023-08-24T21:25:14Z", "commit_message": "build-sys: Look for both linux/mount.h and sys/mount.h\n\nSince that's what composefs uses.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bd8339bda257d1d868be8817e076921600b99ea6", "commit_date": "2023-08-24T21:24:07Z", "commit_message": "ci: Add c9s build\n\nSince it's an active target of this project.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cbe36c3a3585f1fe849a6547a4caff72266360db", "commit_date": "2023-08-24T15:45:22Z", "commit_message": "Merge pull request #3008 from ostreedev/maybe_ostree\n\nprepare-root: If composefs is configured as \"maybe\" don't fail", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "29423a893c2a179eb7f64afd9800a474cda71d5a", "commit_date": "2023-08-24T14:20:25Z", "commit_message": "prepare-root: If composefs is configured as \"maybe\" don't fail\n\nIf composefs is configured as \"maybe\", we should continue even if\ncomposefs support is not built in.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "02d419079d649f18a62ee64542b3f3f28ea14edb", "commit_date": "2023-08-24T13:40:54Z", "commit_message": "deploy: Add bootloader-naming-2 opt-init\n\nI've verified that this fixes compatibility with GRUB, which\nparses the filename:\nhttps://github.com/ostreedev/ostree/issues/2961\n\nHowever, out of a large degree of conservatism I've made this\nan opt-in behavior for now.\n\nMy plan is to test it out in the FCOS development streams first.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fb06d59e75b720c0957148c04e488000a8e6af91", "commit_date": "2023-08-24T08:59:46Z", "commit_message": "Merge pull request #3003 from cgwalters/prepare-root-oscore-and-units\n\nMove prepare-root karg helpers into otcore, add unit tests", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cce1814c50d1062001df6c51e0fde454e7109b95", "commit_date": "2023-08-24T01:22:49Z", "commit_message": "cmd/show-remote-url: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "116fdc3c585fd6c71a175c8dc05a7035787649e8", "commit_date": "2023-08-24T01:21:01Z", "commit_message": "cmd/log: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e578c019c5d20348663e0371ad2d5bc4664f76ed", "commit_date": "2023-08-24T01:17:27Z", "commit_message": "cmd/export: Fold libarchive error handling\n\nThe helper function here doesn't quite carry its weight; this\nbrings us inline with having single line (no braces) error\nreturn paths.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88334b8f33792de715cdcfd64431608ccb41ce2f", "commit_date": "2023-08-24T01:14:53Z", "commit_message": "cmd/export: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "20b8cb174c3e3aa482a856f0a4323849ce7b05de", "commit_date": "2023-08-23T21:11:10Z", "commit_message": "Move prepare-root karg helpers into otcore, add unit tests\n\nAdd long overdue unit testing coverage for this, which\nat least slightly closes out the android boot CI gap.\n\nActually, this *copies* the karg parsing code into otcore because\nit now uses glib, which we're not yet using in the static\nprepare-root.  It's pretty tempting to drop support for the\nstatic prepare root entirely.  But for now we'll live with some\ncode duplication.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "445194921365d5552a052e8b91f51812799ac764", "commit_date": "2023-08-23T14:38:16Z", "commit_message": "Merge pull request #2997 from cgwalters/test-cleanups-1\n\ntests/destructive: Port more to xshell", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "37f247da02b391ce3c8c429ba4413820adcea314", "commit_date": "2023-08-23T14:37:48Z", "commit_message": "Merge pull request #2999 from cgwalters/add-oscore-units\n\ntests: Add otcore unit tests", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa8ad204d549743286ab73366bcf657dec23c9ed", "commit_date": "2023-08-22T23:06:14Z", "commit_message": "Merge pull request #3001 from cgwalters/misc-c99-style-4\n\nMisc c99 style 4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "75a43deb306e602b6e96d971ea305e7f62ac2355", "commit_date": "2023-08-22T21:51:33Z", "commit_message": "cmd/grub2-generate: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "767ca134b55ee057fd2100ae44c3adafb64854d9", "commit_date": "2023-08-22T21:49:28Z", "commit_message": "cmd/init: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3ef72ea8a385417d1c740c91ff701c7aac515c3", "commit_date": "2023-08-22T20:56:46Z", "commit_message": "Merge pull request #3000 from cgwalters/test-inst-update\n\ntests/inst: Update to latest ostree-ext", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6eeb8b5623659290af3b7f1d85746bab367cd77b", "commit_date": "2023-08-22T20:41:00Z", "commit_message": "Merge pull request #2995 from ostreedev/dependabot/submodules/composefs-1aed878\n\nbuild(deps): bump composefs from `a6e827d` to `1aed878`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e751dd9a7bc5752f7d80671dff271ebf6844e703", "commit_date": "2023-08-22T19:08:26Z", "commit_message": "Merge pull request #2998 from cgwalters/disable-composefs-too-old\n\nbuild-sys: Disable composefs on too-old Linux headers", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "facb9a1a60dd1e0cffb9cb3e2afa1f7ef7daef09", "commit_date": "2023-08-22T18:23:56Z", "commit_message": "tests/inst: Update to latest ostree-ext\n\n(And glib, etc.)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7c82340d082ea416c55763971e59150f08f3a388", "commit_date": "2023-08-22T18:11:50Z", "commit_message": "Merge pull request #2975 from ostreedev/androidboot-single-slot-mode\n\nprepare-root: On a non-A/B androidboot system, boot system slot a", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3f0c4d49cb3607c5b40b9e89650f2cc02ea24ff", "commit_date": "2023-08-22T17:04:46Z", "commit_message": "tests: Add otcore unit tests\n\nThis just stubs out the basic infrastructure, to be expanded upon.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "16b97d8a40c827b6d508b68b3779cca1d595547b", "commit_date": "2023-08-22T15:08:10Z", "commit_message": "Merge pull request #2996 from cgwalters/misc-c99-style-3\n\ncli/set-origin: Port to C99 style", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8f302f2a462a7df87b124a1df751d9299affea68", "commit_date": "2023-08-22T13:44:39Z", "commit_message": "cli/set-origin: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ee1e585ee9524e7a672e6b7725596dbb1d5e23f1", "commit_date": "2023-08-18T21:12:24Z", "commit_message": "Merge pull request #2993 from cgwalters/misc-c99-style-2\n\nMisc c99 style 2", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "22b47781fba21059372ec31ab6b2dd7b37eca583", "commit_date": "2023-08-18T19:39:45Z", "commit_message": "checkout: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f7786e759f417441ff61564eb85108edfca3e7dd", "commit_date": "2023-08-18T12:49:31Z", "commit_message": "Merge pull request #2990 from cgwalters/init-is-stateroot\n\nTwo s/osname/stateroot/ patches", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "27266f90d92e2d42aea364d607eb30615da09ce3", "commit_date": "2023-08-18T01:49:33Z", "commit_message": "lzma: Port to C99 style\n\nJust keeping up momentum.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "722fc2d060a884de17c086113b1ce8f5433c6ef1", "commit_date": "2023-08-17T23:19:21Z", "commit_message": "Merge pull request #2991 from cgwalters/misc-c99-style\n\nMisc c99 style", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9f39f78e838605b7bcf626083199fc5b7ebc71b6", "commit_date": "2023-08-17T21:03:17Z", "commit_message": "remote-add: Port to c99 style\n\n- Drop `goto out`\n- Use declare-and-initialize", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9036c96a045df1aba8653815879da9da68c6bb33", "commit_date": "2023-08-17T20:59:41Z", "commit_message": "admin: Port to c99 style\n\n- Drop `goto out`\n- Use declare-and-initialize", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f4e56b910ffe33389f2671d7ce9a3ced07bf61a1", "commit_date": "2023-08-17T20:49:09Z", "commit_message": "admin-deploy: Add `--stateroot` as alias for `--os`\n\nTo further help deprecate the confusing \"osname\" terminology.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9d5ccfeffff9dec81e8862fc1030670f80b6f3bc", "commit_date": "2023-08-17T20:46:02Z", "commit_message": "Add `ostree admin stateroot-init` as alias for `os-init`\n\nTo further help deprecate the confusing \"osname\" terminology.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9ac938c4ff1ef814de135696b85f969ecc139860", "commit_date": "2023-08-17T13:38:30Z", "commit_message": "Merge pull request #2989 from cgwalters/lock-timeout-longer\n\nrepo: Bump lock timeout to 5 minutes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f4b420492f3b529edbded78f04e405e38d4918ee", "commit_date": "2023-08-17T13:36:20Z", "commit_message": "Merge pull request #2973 from ostreedev/dependabot/submodules/composefs-a6e827d\n\nbuild(deps): bump composefs from `1704f82` to `a6e827d`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e88ec69eefa1e53ae7d660cb7be3c5a399ec4a22", "commit_date": "2023-08-17T12:28:16Z", "commit_message": "repo: Bump lock timeout to 5 minutes\n\nAnd update the doc text to talk about having a timeout at all\nby default being a mistake.\n\nTimeouts are really best handled at a higher level; if two processes\nare contending for the ostree lock and one is actually frozen,\nresolving this is something an admin may want to handle and introspect/debug\ninstead of having the waiter error out.\n\nMost people using ostree are doing it in a way in which they have\nhigher level timeouts (e.g. on a container pod).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "55121cc4df5cc713bbc1891b6046181374575cac", "commit_date": "2023-08-16T22:20:15Z", "commit_message": "Merge pull request #2988 from cgwalters/prepare-root-binding-key\n\nprepare-root: Minor clarifications", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d648eea6316d4e26f10ea3358bb8b759ceba8b2d", "commit_date": "2023-08-16T21:37:06Z", "commit_message": "Merge pull request #2987 from cgwalters/prefix-stage-deploy\n\ndeploy: Add some error prefixing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "94cb37cb3080cb0377e0f922e84411ba256190a7", "commit_date": "2023-08-16T20:56:12Z", "commit_message": "prepare-root: Minor clarifications\n\nNo functional changes.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "25a458b94b89b1d97fae1fdf763776a47575ee29", "commit_date": "2023-08-16T20:16:24Z", "commit_message": "deploy: Add some error prefixing\n\nWe saw a bare\n`Txn Rebase on <osname> failed: Failed to find kernel in /usr/lib/modules, /usr/lib/ostree-boot or /boot`\nwhich isn't bad, but it'd be better to be a bit more specific.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8712a46756e25260f47ee45f4e35dc3903761527", "commit_date": "2023-08-16T18:31:35Z", "commit_message": "Merge pull request #2985 from cgwalters/cleanup-proc-cmdline\n\nswitchroot,generator: Only read /proc/cmdline once", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "083bad8cf22981831879995dfeb7c3124921831c", "commit_date": "2023-08-16T13:05:39Z", "commit_message": "Merge pull request #2984 from alexlarsson/prepare-root-no-raw-key\n\nprepare-root: Only support base64 formated public key files", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "28aed49d87902aff650d1df90e3b72d64c70729d", "commit_date": "2023-08-16T13:05:19Z", "commit_message": "switchroot,generator: Only read /proc/cmdline once\n\nChange the helper function to parse an existing cmdline instead\nof potentially reading `/proc/cmdline` multiple times.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0a79b3b1e298117d5d951e171caa569b041ec627", "commit_date": "2023-08-16T09:00:43Z", "commit_message": "prepare-root: Only support base64 formated public key files\n\nI've updated the automotive samples to not use the raw format, so\nthere is no use anymore to support both formats, as base64 is strictly\nbetter.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c94388f3dd0e4617f6183f74288e8827e06e61f7", "commit_date": "2023-08-16T08:56:20Z", "commit_message": "Merge pull request #2980 from cgwalters/prepare-root-minor\n\nPrepare root minor", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "871d32a591a256c4d0077c1d921b5d9d6e01903c", "commit_date": "2023-08-14T18:36:50Z", "commit_message": "prepare-root: Use ptrarray, not linked list\n\nLinked lists are a data structure with only very obscure\nuse cases, and this is a classic one where since we're appending\nit's O(N^2) behavior.\n\nAlso we were leaking the memory.\n\nIt's more ergonomic, clearer and efficient to use a ptrarray.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "678bfcd934e135a28fef172db675a0ae81ae85b1", "commit_date": "2023-08-14T18:30:42Z", "commit_message": "prepare-root: Check for empty string, not strlen > 0\n\nNo point in doing a full strlen, we can just check the first byte.\nAlso, invert the conditional using `continue` to avoid another\nlevel of indentation.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bea5d897a810302263779fcd1542310481626368", "commit_date": "2023-08-14T18:29:39Z", "commit_message": "prepare-root: Use declare-and-initialize\n\nThis is our default style.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3620d3c709a4083a7bd63323b24bd17db4f3ed4b", "commit_date": "2023-08-14T15:47:05Z", "commit_message": "Merge pull request #2979 from cgwalters/enabled-discussions\n\nREADME.md: Drop dead mailing list, link to GH discussions", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d324f6843b4dd459501d18f11990224428873be8", "commit_date": "2023-08-14T15:46:38Z", "commit_message": "Merge pull request #2974 from alexlarsson/composefs-config-file\n\nRead composefs configuration from initrd instead of commandline", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f1c1f819ff8632b9bdac8d859c54be4c09ab6d62", "commit_date": "2023-08-14T13:49:41Z", "commit_message": "README.md: Drop dead mailing list, link to GH discussions\n\nWhile I resisted taking the next step in binding ourselves\nmore to GH with discussions...it's way, way better than answering\nquestions out of band in private (also proprietary) chats.\n\nWe haven't been successful in using the GNOME discussion forums.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "81fa21415566ed45aa8aa154819b02955dc750a8", "commit_date": "2023-08-14T10:27:47Z", "commit_message": "Read composefs configuration from initrd instead of commandline\n\nThis drops the `ot-composefs` kernel commandline in favour\nof a `[composefs]` section in the `prepare-rootfs.conf` file.\n\nYou can set `composefs.enabled` to `signed`, `yes`, `no` or `maybe`,\nwith `maybe` being the default.\n\nYou can also set `composefs.keypath` (or rely on the default\n`/etc/ostree/initramfs-root-binding.key`) to point to ed25519 public\nkeys, one of which which the commit must be signed with, or boot\nfails.\n\nThe ostree dracut module adds `/etc/ostree/initramfs-root-binding.key`\nto the initrd if it exists.\n\nNOTE: This drop the option to define a digest in the commandline.\nHowever, that was currently unused\n(i.e. ComposefsConfig.expected_digest was never read).\n\nAdditionally it very hard to actually store the composefs digest in\nthe initrd, as the initrd is typically part of the commit and thus the\ncomposefs. It may be possible to handle this, but lets add it back\nwhen we know exactly how that will work.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2cc6b531996d016b3c6d114deb1c3f6f29162d02", "commit_date": "2023-08-08T13:24:35Z", "commit_message": "Merge pull request #2966 from cgwalters/ostree-admin-edit\n\nAdd `admin set-default`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b108e24c3191eadb85a99bc23f4e28182a0becc4", "commit_date": "2023-08-08T12:05:10Z", "commit_message": "build(deps): bump composefs from `1704f82` to `a6e827d`\n\nBumps [composefs](https://github.com/containers/composefs) from `1704f82` to `a6e827d`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/1704f823db41b1056cabfba51254f8afa8bae41d...a6e827df2dbebb65d6d19a7211f2fb4a61d989ac)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c57c00569c5ebb982882bdda9f399f1ad181df6a", "commit_date": "2023-08-05T15:48:28Z", "commit_message": "Merge pull request #2958 from cgwalters/deploy-loosen-etc-usretc\n\ndeploy: Support an empty `/etc` and populated `/usr/etc`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7f70614a1ac1950ebde3df0e26cc9ab1d72b2f1f", "commit_date": "2023-08-04T15:34:13Z", "commit_message": "Merge pull request #2969 from cgwalters/fix-sync-pthreads\n\ndeploy: Fix mutex locking for global sync timeout", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a31f7798716c071c12e4a91153ca6d5bcddb3834", "commit_date": "2023-08-04T09:07:09Z", "commit_message": "Merge pull request #2967 from cgwalters/drop-trivial-httpd-entrypoint\n\nMore fully drop `trivial-httpd` entrypoint", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "402e04280b54c058ad47be99fe6a9326caf2ae00", "commit_date": "2023-08-04T03:10:06Z", "commit_message": "deploy: Fix mutex locking for global sync timeout\n\nThe locking here was always too long - by holding the mutex\nduring the `sync()` call, it means `g_cond_wait_until()` can\nnever wake up (because its API requires the mutex to be locked).\n\nConfusingly though of course we do still print the \"timed out\"\nmessage, and I think that tricked us when we were doing testing\nhere.\n\nWe only need to lock the mutex when we're manipulating shared\nstate, which basically boils down to the `gboolean success`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "60b4655677b39bf4a69da9f395f787ed5a95fe3c", "commit_date": "2023-08-03T19:10:11Z", "commit_message": "More fully drop `trivial-httpd` entrypoint\n\nIt's just part of the tests and we should no longer\nsupport `ostree trivial-httpd`.\n\nThis is a followup cleanup to previous work.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3cd3251aa1bd8986b1a46ddaaf98563d149bf4d3", "commit_date": "2023-08-03T19:09:57Z", "commit_message": "Add `admin set-default`\n\nA core underlying primitive in the C library is the ability\nto arbitrarily reorder bootloader entries.\n\nLet's expose the basic functionality here with the ability to pick\nan arbitrarily deployment for the next boot.\n\nCloses: https://github.com/ostreedev/ostree/issues/2965", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "09160c1a2b553e39e417a64c254f62470ce2dce5", "commit_date": "2023-08-02T19:41:32Z", "commit_message": "Merge pull request #2962 from cgwalters/os-init-remount\n\nos-init: Create a mount namespace", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ac42e29d667d88858f44f2260b1153873e9261be", "commit_date": "2023-08-02T18:32:22Z", "commit_message": "os-init: Create a mount namespace\n\nToday on anything using readonly sysroot `os-init` fails, because\nwe don't create a mount namespace if the `UNLOCKED` flag is specified\nbecause we assume it's a readonly operation.\n\nSince technically this is a mutation, let's just lock the sysroot\nand use the tested path.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "113e575e8ed189d3fd5bfa793026f61992294343", "commit_date": "2023-08-02T17:44:05Z", "commit_message": "Merge pull request #2963 from cgwalters/more-gfileinfo-fix\n\ncomposefs: Only call `_get_symlink_target()` on symlinks", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "15cb0b47b1fa0f21fe1c935baa23ec4cde77f1cc", "commit_date": "2023-08-02T01:29:04Z", "commit_message": "composefs: Only call `_get_symlink_target()` on symlinks\n\nThis fixes a warning from newer glib that we're now seeing\nin the Debian testing CI runs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f44909f8a2ed084da241a9f241376b9b5ef98be7", "commit_date": "2023-07-31T15:04:26Z", "commit_message": "Merge pull request #2960 from ostreedev/dependabot/submodules/libglnx-c02eb59\n\nbuild(deps): bump libglnx from `07e3e49` to `c02eb59`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a16a14a67b673aa5db90810fc2c7a16a0514928f", "commit_date": "2023-07-31T12:29:54Z", "commit_message": "build(deps): bump libglnx from `07e3e49` to `c02eb59`\n\nBumps libglnx from `07e3e49` to `c02eb59`.\n\n---\nupdated-dependencies:\n- dependency-name: libglnx\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fd968d5939afdb601715d93db5e7da08ab9fe524", "commit_date": "2023-07-31T09:55:39Z", "commit_message": "Merge pull request #2957 from cgwalters/transaction-test-suppress-global-sync\n\ntests/destructive: Turn off global sync()", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0406fd3912d6e54f94698c2ad2a6da6c477a4eba", "commit_date": "2023-07-29T12:47:54Z", "commit_message": "deploy: Support an empty `/etc` and populated `/usr/etc`\n\nIn preparation for support for a transient `/etc`:\nhttps://github.com/ostreedev/ostree/issues/2868\nparticularly in combination with composefs.\n\nBasically it's just much more elegant if we can directly mount\nan overlayfs on the *empty* `etc` directory, using `usr/etc` as\nthe lower.\n\nIn the composefs case, we'd have to mount the composefs overlayfs\nitself writable (and call `mkdir`) *just* so we can make that\nempty `etc` directory which is ugly.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6470429b2b7ba720a3723533625db8f1296a0c7e", "commit_date": "2023-07-28T21:59:28Z", "commit_message": "tests/destructive: Turn off global sync()\n\nLet's verify that things work with that off, as they should.\n\nPreviously:\nhttps://github.com/ostreedev/ostree/pull/2519/commits/cb731294837736e957ee595ce11ab115277dbb36\n\"deploy: Add a 5s max timeout on global filesystem sync()\"\n\nBut we may still have problems even with that, see\nhttps://issues.redhat.com/browse/OCPBUGS-15917\nwhere it might be that even a thread doesn't work because\nwe're locked in the kernel.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a2663e8041ffadb764c71a055dd63dba4e7ff378", "commit_date": "2023-07-28T15:16:57Z", "commit_message": "Merge pull request #2956 from cgwalters/finalize-more-verbose\n\ndeploy: Be way more verbose about what we're doing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3d881fee4154636ca572e2b0b25dbccc22b771d5", "commit_date": "2023-07-27T18:08:15Z", "commit_message": "deploy: Be way more verbose about what we're doing\n\nThis will help us debug bugs like https://issues.redhat.com/browse/OCPBUGS-15917\nin the future.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1aed5d7cf9075199a4ab9b82cad3dc565c2d54e1", "commit_date": "2023-07-27T14:41:24Z", "commit_message": "Merge pull request #2954 from cgwalters/harden-gvariant-get-data\n\nHarden gvariant get data", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b37259607e476de178fc20753b1083ee89448bf", "commit_date": "2023-07-26T22:09:28Z", "commit_message": "checksum-utils: Add an assertion that `buf != NULL`\n\nAnother hardening against https://bugzilla.redhat.com/show_bug.cgi?id=2217401", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0392b5460276748576da5b4fbc00a361d847b4e3", "commit_date": "2023-07-26T22:09:28Z", "commit_message": "core, switchroot: Harden a bit against `g_variant_get_data() == NULL`\n\nI'm not totally sure this is the cause of\nhttps://bugzilla.redhat.com/show_bug.cgi?id=2217401\nbut analyzing the code a bit it seems the most likely.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d7d661218e556f8baddf888e297f60f046a524d7", "commit_date": "2023-07-26T14:10:27Z", "commit_message": "Merge pull request #2953 from samcday/patch-1\n\ndocs: update boot loader spec link", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "66e425534e99d83137831802ff75c62dd855a6a8", "commit_date": "2023-07-26T09:17:35Z", "commit_message": "Merge pull request #2930 from cgwalters/prepare-root-config3\n\nprepare-root: Introduce ostree/prepare-root.conf && sysroot.readonly improvements", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b5397887e32ccc47db270a3276326de3b184d13c", "commit_date": "2023-07-25T19:42:41Z", "commit_message": "docs: update boot loader spec link", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "af52a88d5fdc077ba43a19e1731614ed8747246f", "commit_date": "2023-07-25T16:36:12Z", "commit_message": "Merge pull request #2952 from cgwalters/silence-variant-lookup\n\ntree-wide: Consistently `(void)g_variant_lookup()`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "13e7ae907de35f364f9e2573175124aa0691c840", "commit_date": "2023-07-25T15:28:23Z", "commit_message": "tree-wide: Consistently `(void)g_variant_lookup()`\n\nCoverity warns when we're checking the return value in most-but-not-all\ninstances.  The code is correct in these instances; we're initializing\nthe values to defaults.  So add a `(void)` cast like we are doing\nin many other places.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "34656260154ad9affcd4d60c568d06c82b7149a6", "commit_date": "2023-07-25T13:15:11Z", "commit_message": "prepare-root: Don't parse target root when composefs enabled\n\nWe shouldn't load anything from the target root filesystem *before*\nverifying its integrity if composefs is enabled.\n\nIn effect, we want to force composefs users to migrate to\n`/usr/lib/ostree/prepare-root.conf` which lives in the initramfs.\n(But because we enable sysroot.readonly=true if composefs is enabled\n too, they don't actually need to)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "83d37d6d3cecf746bd63c0c97bf9154b889e67ba", "commit_date": "2023-07-25T13:15:11Z", "commit_message": "prepare-root: Default sysroot.readonly=true if composefs\n\nNot because it's logically required or anything, but because\nit's just a good idea.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "22b8e4f953ed183a368ec97ce7f74337b1574045", "commit_date": "2023-07-25T13:15:09Z", "commit_message": "prepare-root: Introduce `ostree/prepare-root.conf`\n\nUsing the repository configuration for configuration of this\nprogram was always a bit hacky.\n\nBut actually with composefs, we really must validate\nthe target root *before* we parse anything in it.\n\nLet's add a config file for `ostree-prepare-root` that can live\nin the initramfs, which will already have been verified.\n\nIn the future we'll also add configuration for composefs here.\n\nWe expect OS builders to drop this in `/usr/lib/ostree/prepare-root.conf`,\nbut system local configuration can live in `/etc`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "250c40a671488ac86fea985ec510488cd0fd2bb0", "commit_date": "2023-07-25T09:25:29Z", "commit_message": "Merge pull request #2948 from cgwalters/composefs-more-cleanups\n\ncomposefs: Use lowerdir in /run", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3f594b04aa0aa38bbfef9e0f471afc0b7dbbd12b", "commit_date": "2023-07-24T20:07:28Z", "commit_message": "Merge pull request #2951 from cgwalters/errprefix-sysroot\n\nsysroot: Add a bit more error prefixing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e2eedeec9d0bb307757e4db4f3bab8530ce5f67", "commit_date": "2023-07-24T20:06:59Z", "commit_message": "Merge pull request #2949 from cgwalters/kargs-cleanup\n\nkernel-args: Move private functions out of public header", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "cf525ee6198e20adbc014a86de6199d2f34aec29", "commit_date": "2023-07-24T12:54:29Z", "commit_message": "repo: Clarify when we fail to parse a remote\n\nThis would have directly pointed at the failing config file.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "70d790abeab6e8b6a0b7fe20f8cdd80af7028538", "commit_date": "2023-07-24T12:48:51Z", "commit_message": "sysroot: Add a bit more error prefixing\n\nWhile an error message I saw was pretty clear, this would\nbe even more explicit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "82da0e169bf82a24c4510bfa2f41c925694f23eb", "commit_date": "2023-07-24T09:52:41Z", "commit_message": "Merge pull request #2950 from cgwalters/generator-cleanup\n\ngenerator: Some cleanup", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d7fe9e54ed675aa7b82e59808a5ab1bac4b1c4a3", "commit_date": "2023-07-23T17:22:14Z", "commit_message": "kernel-args: Move private functions out of public header\n\nExternal users can't call `_` prefixed APIs, so move them\nto a `-private.h`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "303e7eb2e1191e4fc1798198e16becc925075bca", "commit_date": "2023-07-23T14:47:19Z", "commit_message": "src/generator: Move all logic into libostree-1.so\n\nThis pushes down the code for parsing the `ostree=` cmdline\nin the generator into code that's part of libostree-1.so.\n\nThis is prep for using logic shared in libotcore.la.\n\nBut in general it's just cleaner to also keep the binary\nentrypoint to just be a trampoline into the C library.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ec1109c7a93a2ed07503b12ffecf7048cf7cc0d0", "commit_date": "2023-07-23T14:40:20Z", "commit_message": "generator: Stop creating `/run/ostree-booted`\n\nThis must have always been dead code.  We're trying to iterate\ntowards a place where it's only `ostree-prepare-root.c` which\nparses the `ostree=` kernel argument, and canonically sets up\n`/run/ostree-booted`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "64afbcdeb0cb101ce302ae28f1c0852a9d73b907", "commit_date": "2023-07-22T20:46:17Z", "commit_message": "composefs: Use lowerdir in /run\n\nI just noticed that this was another constant string duplicated\nbetween prepare-root.c and libostree-1.so, and I went to make\nit a common `#define` in libotcore.la.\n\nBut then I thought \"it's ugly to have this directory mixed into\nthe deployment namespace\" because in some theoretical world\nit could also be in the ostree commit, which would cause weird\nbehavior.\n\nI think this is transient state that is better in `/run`, so move\nit there.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4c0e5b1ef7aa877c242e3ce20003392a585d4a25", "commit_date": "2023-07-20T20:58:11Z", "commit_message": "Merge pull request #2942 from ostreedev/android-bootloader-parsing\n\nbootloader: fold all Android Bootloader specific logic into prepare-root", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a035c2e21cdef1a8d57627bdd8c556c3d08a3c70", "commit_date": "2023-07-20T19:12:31Z", "commit_message": "Merge pull request #2946 from cgwalters/add-inode-fix-feature\n\nAdd an always-on `inode64` feature", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8ce7bbe1994366667e770986d11bc02a31655084", "commit_date": "2023-07-20T17:50:25Z", "commit_message": "Add an always-on `inode64` feature\n\nAs I (and others) will be backporting the fix in\nhttps://github.com/ostreedev/ostree/pull/2874/commits/de6fddc6adee09a93901243dc7074090828a1912\npretty far, I want a way for sysadmins and OS builders to\nbe able to reliably see when their version of ostree has this fix\n(Because comparing version numbers isn't portable).", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c89baaed771f604475b452f687f84e10e1565915", "commit_date": "2023-07-20T11:31:01Z", "commit_message": "bootloader: fold all Android Bootloader specific logic into prepare-root\n\nNow that we use androidboot.slot_suffix karg to determine whether we\nboot into /ostree/root.a or /ostree/root.b, we can use ostree= karg\nsimply for parsing the stateroot, although we will still boot into\nwhat's pointed to by /ostree/root.a or /ostree/root.b.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "559361655d164134379e9c395e3009ee0d2a9b96", "commit_date": "2023-07-19T14:35:27Z", "commit_message": "Merge pull request #2943 from cgwalters/mount-cleanup\n\nprepare-root: Drop code mounting `/proc`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "253e7758d379e99fe28846b7f6ac8213b7dea5cf", "commit_date": "2023-07-19T14:34:46Z", "commit_message": "Merge pull request #2944 from cgwalters/prepare-root-more-cleanup\n\nprepare-root: Drop more dead code", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e61226a8d74d026385ed5932e793133c96f7d1d7", "commit_date": "2023-07-19T13:13:53Z", "commit_message": "prepare-root: Drop more dead code\n\nMost of this was used for the old composefs signature model.  We\nnow reuse the core signature code and link to glib, so we don't\nneed reimplementations of hex strings and reading files.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "41cda3bd2abec6dc2786e141b15b9d5ce238db86", "commit_date": "2023-07-19T13:12:10Z", "commit_message": "prepare-root: Drop code mounting `/proc`\n\nThis must be done by the init process here; it was always\ndead code in the initramfs path.\n\nWe keep the copy of this code in the now-forked -static.c.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b258375f05d71133c9c818ee9771989d77c40392", "commit_date": "2023-07-18T13:35:45Z", "commit_message": "Merge pull request #2938 from cgwalters/dedup-ostree-parsing\n\ngenerator: Deduplicate ostree= karg parsing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b548ff74a26df21978e8675d8ab9ad23b9cdbcc8", "commit_date": "2023-07-18T13:33:58Z", "commit_message": "Merge pull request #2939 from cgwalters/ed25519-cleanups\n\nsign-ed25519: Minor cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6966979c5e3a216fccfb3312e11cb959ac4e4b30", "commit_date": "2023-07-18T12:29:09Z", "commit_message": "generator: Deduplicate ostree= karg parsing\n\nAvoid having two copies of a regular expression for parsing\nthe `ostree=` kernel argument.  Because the `ostree-system-generator`\nbinary already has access to the internals because it's implemented\nin the shared library, expose the sysroot version internally\nand use that.\n\nMotivated by an attempt to change one of these copies but not\nthe other.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fc303da67d9f5998b7b996c37e4738313978d589", "commit_date": "2023-07-18T12:25:36Z", "commit_message": "sign-ed25519: Don't set sk unless we've validated it\n\nThe semantics of this function now keep the key assigned\neven if we fail to validate it, which is ugly.  Only assign\nthe key after verifying its length.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3a18a5570d9f741ba2b883cd9da1f526b60a9bec", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "sign-ed25519: Add some comments for data structure\n\nLike poor man's generics.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "fb40e559903491bf1ff106a4fdb63b815280550a", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "sign-ed25519: More verbose errors for invalid length\n\nAdd a helper to compare lengths which includes the found\nand expected values.  Use it consistently.\n\nThe error message \"Incorrect\" is misleading; one might think\none had the *wrong* key.  \"Ill-formed\" makes it clearer that\nwe're not parsing it at all.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1a2fac371b3535f612b083fca1bf99b86a7c5306", "commit_date": "2023-07-18T11:55:14Z", "commit_message": "tests: Remove dead references to \"SEED\"\n\nNothing uses this.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1c0fd7d458066a965244c4551903e48b8e10359b", "commit_date": "2023-07-17T13:46:02Z", "commit_message": "Merge pull request #2937 from ericcurtin/ostree2androidboot.slot_suffix\n\nandroid-boot: Remove dependency on ostree= karg, use androidboot.slot_suffix=", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "355cd727055959337fcdbe0617aae66f5d7ef433", "commit_date": "2023-07-17T12:23:27Z", "commit_message": "Remove steal_pointer and steal_pointer_impl as we link in glib now\n\nThese were necessary to keep initramfs small, but now we link in glib\nanyway so these functions are now redundant.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6f0a5713443b93c4060991ffa16d58d62c27fa9", "commit_date": "2023-07-17T12:22:49Z", "commit_message": "android-boot: Remove dependency on ostree= karg, use androidboot.slot_suffix=\n\nGiven the kernel argument androidboot.slot_suffix= is required in\nAndroid AB updates [1] there is no need to check for ostree= or ostree=aboot\nat all in the aboot case. This also ensures if the dependancy on ostree=\nis removed, the android-boot technique will work regardless.\n\n[1]: https://source.android.com/docs/core/ota/ab/ab_implement", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "27a9fe30b34315e68bc30c69238721df0241c7c3", "commit_date": "2023-07-16T21:22:20Z", "commit_message": "Merge pull request #2936 from cgwalters/sign-from-file\n\ncommit: Add `--sign-from-file`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7bbe13cabbc442fa610e63521cf63b1bb0d2bd83", "commit_date": "2023-07-16T20:59:32Z", "commit_message": "Merge pull request #2931 from cgwalters/prepare-root-man\n\nman: Add ostree-prepare-root", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "de81a7e71ac2cfdab27051cb00720027196895d8", "commit_date": "2023-07-15T16:33:56Z", "commit_message": "Merge pull request #2929 from cgwalters/prepare-root-drop-pivot\n\nprepare-root: Drop dead `pivot_root` code", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8302a8add09946f2b731cc3ecebede4f33637aa3", "commit_date": "2023-07-15T16:31:53Z", "commit_message": "Merge pull request #2927 from cgwalters/sysroot-errprefix-bootlinks\n\nsysroot: Add some error prefixing for bootversion", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "845d68d1d4441c9f2662eb77612ec6b7a6b7ec39", "commit_date": "2023-07-15T13:52:11Z", "commit_message": "Merge pull request #2935 from cgwalters/prepare-root-config4\n\nprepare-root: Refactor composefs config handling", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "82d934916b6ececb8f9e5f975723bbf487b894cb", "commit_date": "2023-07-15T13:50:40Z", "commit_message": "commit: Add `--sign-from-file`\n\nPassing the private key via a direct command line argument\nis just a bad idea because it's highly likely to get logged\nor appear in `ps`.\nSpotted in review of work for composefs signatures.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d4ca834b0904166fb7691ddbb1e1e2ea8f76c55f", "commit_date": "2023-07-14T18:37:03Z", "commit_message": "prepare-root: Refactor composefs config handling\n\n- Convert the current enum into a struct, using `OtTristate` and\n  two member variables (expected signature and digest)\n- Factor out a helper function to parse this config\n- Clean up the logging by consistently using `composefs:` as a prefix\n- Add more assertions to more strictly verify our runtime state\n  since this is security relevant", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "18d6f5979331e8f890bf4b12473384b63754c450", "commit_date": "2023-07-14T15:40:42Z", "commit_message": "Merge pull request #2934 from cgwalters/enable-composefs-default\n\nbuild-sys: Enable composefs at *build time* by default", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "592351d1b09f3afca92a388263c87a2c3338518c", "commit_date": "2023-07-14T14:34:46Z", "commit_message": "build-sys: Enable composefs at *build time* by default\n\nThere's no additional dependencies, and it's a small amount\nof new code.\n\nThe riskiest thing is the changes to ostree-prepare-root, but\nI believe that things are in a good state now there.\n\nAgain, this just enables it at *build time* - it's still\noff at runtime by default.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3d29f89c0ecc98bae8a4faa7dc7ee69944dca87f", "commit_date": "2023-07-14T14:26:25Z", "commit_message": "Merge pull request #2928 from cgwalters/prepare-root-config\n\nMore prepare-root cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c1ac6bc3460521e0b336cf8e36befc995892a6e5", "commit_date": "2023-07-14T12:48:17Z", "commit_message": "Merge pull request #2932 from cgwalters/aboot-fix-nullderef\n\nmount: Fix gcc -fanalyzer warning for parsing androidboot.slot_suffix", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c078e8bea381349dfc2c3a34188603764b0161ff", "commit_date": "2023-07-14T10:51:34Z", "commit_message": "mount: Fix gcc -fanalyzer warning for parsing androidboot.slot_suffix\n\nIf the karg wasn't present, we'd do a NULL deref which is undefined\nbehavior.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c4f1d18a30ec954042551700e4deaa6c537b3f93", "commit_date": "2023-07-13T21:53:10Z", "commit_message": "Merge pull request #2920 from ostreedev/dependabot/submodules/composefs-1704f82\n\nbuild(deps): bump composefs from `ac729b5` to `1704f82`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6cdc5ce595deca6bf7f14171d35258ee4c38cc53", "commit_date": "2023-07-13T11:10:59Z", "commit_message": "Merge pull request #2926 from cgwalters/otcore-cfs-constants\n\nprepare-root: A few cleanups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "18cc447230c2ed43d0834d771b03a8d41300c920", "commit_date": "2023-07-12T11:56:17Z", "commit_message": "prepare-root: Drop unused verity flag querying\n\nThis logic got pushed down into libcomposefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2b738a995d00761caf3cfcbd2651bdf415aa56ca", "commit_date": "2023-07-12T11:56:17Z", "commit_message": "prepare-root: Use otutil and g_print\n\nNow that we link to libotutil (and glib) we don't need separate\nhandling for conditionalizing on the presence of systemd.\n\nFurther, there's no value in `sd_journal_send(MESSAGE=)` over\njust printing to stdout.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1b7b4fbd2bbd9010b0e3e1ad4f6f391f9f0f22fd", "commit_date": "2023-07-11T21:50:43Z", "commit_message": "Add an internal constant for the composefs image name\n\nJust a minor cleanup.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c0c2c9bd800da8eeb72801a0007248a15080662b", "commit_date": "2023-07-11T19:31:14Z", "commit_message": "Merge pull request #2924 from cgwalters/drop-syntax-check\n\nbuild: Drop `make syntax-check`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6591210661b55baf2f24c654b0581d1a4daf274c", "commit_date": "2023-07-11T18:17:05Z", "commit_message": "build: Drop `make syntax-check`\n\nAs of lately it emits a ton of errors from `grep` about having `*`\nat the start of a line, but more generally it's only generally\nfound papercut-style issues that aren't worth carrying a distinct\nchecking system for.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "57fe33f07ef1e6beac466edc00cac9c38d2883ff", "commit_date": "2023-07-11T18:09:07Z", "commit_message": "Merge pull request #2921 from alexlarsson/composefs-sign-v2\n\nostree-prepare-root: Validate ed25519 signatures when requested", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c29f4193cd7e431f0f49a3af98df9830e5fea8c5", "commit_date": "2023-07-11T18:08:33Z", "commit_message": "ostree-prepare-root: Validate ed25519 signatures when requested\n\nIf requested, by specifying ot-composefs=signed=/path/to/pub.key then\nthe commit object is validated against the specified ed25519 public\nkey, and if valid, the composefs digest from the commit object is used\nto ensure we boot the right digest.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b8ff2109413a123111eba30f0ae776956d56e081", "commit_date": "2023-07-11T18:08:32Z", "commit_message": "Factor out a libotcore\n\nThis will contain logic shared between ostree-prepare-root\nand libostree-1.so.  It will just link to libgio.so, so as\nto avoid pulling in e.g. libcurl and other things.\n\nIn other words, `ostree-prepare-root` will not link to `libostree-1.so`,\nbut will pull in just what it needs from this library.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "265cf7d786ffa3972d1698aeeb8bb4e5b50385b5", "commit_date": "2023-07-08T19:42:12Z", "commit_message": "build-sys: Add libsodium to OT_DEP_CRYPTO\n\nThere's no reason to have these distinct really.  If we're using\nlibsodium, we want it in the same places we're using openssl.\n\nPrep for further refactoring.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6d9c714c64a4bfee02154800257715827b10d4b", "commit_date": "2023-07-07T19:25:27Z", "commit_message": "Merge pull request #2922 from alexlarsson/openssl-ed25519\n\nImplement ed255519 using openssl too", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "744967a6e4118ddb3b70ba30623e639fde1a77f9", "commit_date": "2023-07-07T18:19:59Z", "commit_message": "libotutil: Link to crypto libs\n\nThe checksum utils uses the crypto lib, but we're not explicitly linking\nto it. I think this is why the CI got this error when using openssl\non debian, during ostree binary linking:\n\n/usr/bin/ld: ./.libs/libotutil.a(libotutil_la-ot-checksum-utils.o): undefined reference to symbol 'EVP_DigestInit_ex@@OPENSSL_3.0.0'\n/usr/bin/ld: /lib/x86_64-linux-gnu/libcrypto.so.3: error adding symbols: DSO missing from command line\ncollect2: error: ld returned 1 exit status", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "474c2b100bd31aac00cb3e2bfec4a5591c4c626d", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "CI: Enable --with-crypto=openssl on debian testing to test openssl signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7b85adfbbd97054e4b14ca4365c11fbadf97c70c", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "sign-ed25519: Implement sign and verify using openssl\n\nlibsodium is used if configured to keep the old behaviour, but if\nit is not enabled, and openssl is used, then ed25519 is now supported.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "501575c1e44cf2a7d58c39944da405f802023325", "commit_date": "2023-07-07T15:16:30Z", "commit_message": "sign-ed25519: Drop some uses of libsodium\n\nThis adds some defines for ed25519 key sizes and drops uses\nof the libsodium defines for these, as well as replacing sodium_bin2hex\nuse with ot_bin2hex. Some code that wes optionally built before are now\nalways built.\n\nThe goal for this is to support both libsodium and openssl.\n\nAlso fixes return value of _load_pk_from_stream(). It used\nto always return FALSE.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5b7277513b951c7fe352b53d1d90fbcd7c4b5597", "commit_date": "2023-07-07T15:12:52Z", "commit_message": "Merge pull request #2923 from alexlarsson/fix-composefs-test\n\ntests: Fix composefs test", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "62e4f376536a86ca8d707a75ffc62a3c728389c3", "commit_date": "2023-07-07T13:57:00Z", "commit_message": "tests: Fix composefs test\n\n- Was using the wrong metadata key\n- We were missing setting the canonical commit args which assigns\n  e.g. owner uid 0, which is important for reproducibility\n- Use the new --print-hex to make things easier to read", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "eb01112083e7ce45239fc711b9cda311085302ca", "commit_date": "2023-07-07T13:22:30Z", "commit_message": "show: Add --print-hex\n\nThe default GVariant output for byte arrays is illegible to humans,\nand byte arrays are super common for us.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6056ec130ffff4ac310583f4f4ebffef64919fc3", "commit_date": "2023-07-06T00:00:30Z", "commit_message": "Merge pull request #2913 from cgwalters/tmpfile-not-on-revokefs\n\nfetcher: Always open tmpfiles in repo (except on FUSE)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8a4a0c1673090990803aa483d4f7fce3afcb1828", "commit_date": "2023-07-05T12:48:46Z", "commit_message": "build(deps): bump composefs from `ac729b5` to `1704f82`\n\nBumps [composefs](https://github.com/containers/composefs) from `ac729b5` to `1704f82`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/ac729b579dd332938c6ad43ba83b2b896631dad4...1704f823db41b1056cabfba51254f8afa8bae41d)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "43fb27877225a89a69fbcf3d4f5c455c9559067d", "commit_date": "2023-07-05T10:26:42Z", "commit_message": "Merge pull request #2918 from ostreedev/dependabot/submodules/composefs-ac729b5\n\nbuild(deps): bump composefs from `412cb5e` to `ac729b5`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "25120bd7adf9c4167e9b2bd76f6daded65518d0d", "commit_date": "2023-07-05T09:47:05Z", "commit_message": "Merge pull request #2912 from cgwalters/itest-transactionality-debug\n\ntests/inst: A few small patches", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "61720180904655b9adab80bf2aecd7a20e809b70", "commit_date": "2023-07-05T08:51:29Z", "commit_message": "Merge pull request #1633 from cgwalters/pkglibexec-tests\n\nDrop \"ostree trivial-httpd\" CLI, move to tests directory", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ba9c9dedffb953738c609fda6502b9b37ee1b6ba", "commit_date": "2023-07-05T08:27:36Z", "commit_message": "fetcher: Always open tmpfiles in repo (except on FUSE)\n\nThis reverts commit 4e61e6f7d0d6aebd6abcdc455ec53164afe39e8d\nand re-instates the fix for ensuring that we download temporary\nfiles into the repository location.\n\nHowever in order to ensure we don't re-introduce\nhttps://github.com/ostreedev/ostree/issues/2900\nwe detect the case where we're writing to a FUSE mount\nand keep the prior behavior.\n\nI've verified that this works with flatpak.\n\nNote a downside of this is the change needs to be triplicated\nacross the 3 http backends.\n\nThis then again\nCloses: https://github.com/ostreedev/ostree/issues/2571", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9104c54f2b9356e693b97a007dfbc9f3fe3c23ce", "commit_date": "2023-07-04T13:05:31Z", "commit_message": "Merge pull request #2905 from cgwalters/prepare-root-static-split\n\nSeparate prepare-root static path + link to glib", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "01be14e6c045b64974541230e215722c17b383dd", "commit_date": "2023-07-04T12:25:19Z", "commit_message": "build(deps): bump composefs from `412cb5e` to `ac729b5`\n\nBumps [composefs](https://github.com/containers/composefs) from `412cb5e` to `ac729b5`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/412cb5e6aaf516c5e2a7f67e426a25ed2926e101...ac729b579dd332938c6ad43ba83b2b896631dad4)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c36e8143d3c95d454b65c38f923cf71d08d5eb7", "commit_date": "2023-07-04T12:18:24Z", "commit_message": "Drop \"ostree trivial-httpd\" CLI, move to tests directory\n\nSee https://github.com/ostreedev/ostree/issues/1593\n\nBasically this makes it easier for people packaging, as the trivial-httpd\nis only for tests, and this way the binary will live with the tests.\n\nAlso at this point nothing should depend on `ostree trivial-httpd`.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8ad8a79c2a8551d08a296e9dc16e7d38683aa0a8", "commit_date": "2023-06-30T19:07:15Z", "commit_message": "Merge pull request #2916 from cgwalters/release\n\nRelease 2023.5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b2cfee722e82821c76e26dd3606417c49a86d50c", "commit_date": "2023-06-30T15:49:30Z", "commit_message": "Merge pull request #2914 from cgwalters/doc-usergroups\n\ndocs: Update user and group section", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5aadb6ec26b07ac29f84b08b6d458079e1aedb14", "commit_date": "2023-06-30T15:10:25Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "26b833e90a1dcd3d40e06e43f5597a9951df8641", "commit_date": "2023-06-30T15:07:18Z", "commit_message": "Release 2023.5", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7d192d079ac656893b7056f054f2596592592b0d", "commit_date": "2023-06-30T15:01:59Z", "commit_message": "Merge pull request #2899 from ostreedev/dependabot/submodules/composefs-412cb5e\n\nbuild(deps): bump composefs from `08bdb03` to `412cb5e`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "875915f6c977d359ca1e3e818a1b3b8286f6b6bc", "commit_date": "2023-06-30T09:18:23Z", "commit_message": "prepare-root: Link to glib\n\nSince we've split off the \"prepare root as init\" code\ninto a separate file, we can now use glib to parse\nthe config file again, which is a lot less hacky.\n\nThis is particularly motivated by composefs, where\nwe want to do more in the initramfs.  Future patches\nmay also link to parts of libostree.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d6799ecc243befcf714bcf54dbbd41da13a6e290", "commit_date": "2023-06-30T09:18:23Z", "commit_message": "Separate prepare-root static path\n\nWe should have done this a long time ago.  We don't have any test\ncoverage for the no-initramfs path, and I think it's not long\nterm supportable as we want to add more features like composefs.\n\nParticularly now that there's good support for embedding an\ninitramfs in a kernel image, I see little value in a path for\nhaving custom static linking for this prepare root flow.\n\nThat said, we will continue to make a best-effort \"it compiles\"\nattempt to support it.\n\nFork the \"pid 1\" prepare root code into a new\n`ostree-prepare-root-static.c` file, and drop the runtime conditionals.\n\nWe can drop the composefs logic from `-static.c` which ends up\nkeeping that file much smaller.\n\nA further next step here will be to actually fold the\n`prepare-root.c` logic into the main `ostree` binary which we\ncan then just include in the initramfs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6e5753f574779e7762802d1c5b04682efcde8200", "commit_date": "2023-06-30T09:13:46Z", "commit_message": "build(deps): bump composefs from `08bdb03` to `412cb5e`\n\nBumps [composefs](https://github.com/containers/composefs) from `08bdb03` to `412cb5e`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/08bdb030fcff4f55ef63aa828b09b57a6cd4d234...412cb5e6aaf516c5e2a7f67e426a25ed2926e101)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "786e64ced799dcd1571d5dff42cb80bab999cc5c", "commit_date": "2023-06-29T15:05:31Z", "commit_message": "docs: Update user and group section\n\n- mention `DynamicUser=yes`\n- mention the recent systemd JSON bits\n- mention sysusers.doc\n\nAnd briefly talk about the tradeoffs in these.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c2ad2d23aeb23c474f01ee64adee8953559773ab", "commit_date": "2023-06-29T08:16:52Z", "commit_message": "Merge pull request #2911 from cgwalters/fix-generator-regression\n\nFix return value of generator on non-ostree systems", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8999d41127572d27ab12474f1754d1ae0c19f187", "commit_date": "2023-06-29T06:38:00Z", "commit_message": "Merge pull request #2910 from cgwalters/more-ci-fixes\n\nci: Fix executability", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8bba482bc8b40a0601f7997ecf00f020c1b09cca", "commit_date": "2023-06-29T06:11:09Z", "commit_message": "tests: Enable mtime test\n\nI think this just accidentally was never enabled.\n\nWhile looking at the code, add a sleep here to be resilient to\nfilesystems with only second mtime granularity.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0b519c25732adfbc19b159e1d9173dd7f83f86e7", "commit_date": "2023-06-29T06:09:51Z", "commit_message": "tests: Drop unused alias", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "54c731554ea2f73bd0553d22628fb0d438d1ee96", "commit_date": "2023-06-29T06:08:56Z", "commit_message": "tests/transactionality: Port a bit to xshell\n\nThis will give us more useful error messages which should\nhelp debug a flake.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a0d17a730da4b5661eb5eb1f2563f3e69e35430f", "commit_date": "2023-06-28T23:44:52Z", "commit_message": "Merge pull request #2907 from cgwalters/test-composefs\n\ntests: Source libtest before exiting", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aeef8221c430a3b7ae86bfbedc01b82848d4430a", "commit_date": "2023-06-28T15:58:20Z", "commit_message": "test-composefs: Sync flow with other tests\n\nI am not sure why this is failing on older Debian systems,\nbut I'm wildly guessing that something being done in `libtest.sh`\nis setting up automake in a way that we need.  This is done\nin other tests.\n\nOr maybe it's the missing `$CMD_PREFIX`?  Let's see...", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c76d03af24de5ac8fa3a834fde8e8d11179021c", "commit_date": "2023-06-28T15:45:15Z", "commit_message": "Fix return value of generator on non-ostree systems\n\nCommit aa72caffb540114a0e8635ab2990b9c8b0b8f9db\nregressed the `ostree-system-generator` on non-ostree systems.\nIf there's no `ostree=` karg, we need to just exit 0.\n\nCloses: https://github.com/ostreedev/ostree/issues/2909\nFixes: aa72caffb540114a0e8635ab2990b9c8b0b8f9db", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "531b4ab055a814566d4fabd9e55e4a842a5d2104", "commit_date": "2023-06-28T06:37:31Z", "commit_message": "ci: Fix executability", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e0e2144e12899d615441e9e13e522d973c5354c9", "commit_date": "2023-06-27T21:16:18Z", "commit_message": "Merge pull request #2904 from cgwalters/prow-ci\n\nci/prow: Build tests before trying to install", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88e399a780731f71e0b6f90b8f02a58a5c939238", "commit_date": "2023-06-27T13:55:15Z", "commit_message": "Merge pull request #2906 from cgwalters/compiletest-static-prepareroot\n\nci: Add \"it compiles\" coverage for --with-static-compiler", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6ed6a7e6990c3f53a1f750be67fd2a8c582dbddb", "commit_date": "2023-06-27T10:36:52Z", "commit_message": "ci: Add \"it compiles\" coverage for --with-static-compiler\n\nPrep for further changes.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5e2b5aca40ec50be8948f6250223c28374d452da", "commit_date": "2023-06-27T09:27:23Z", "commit_message": "ci/prow: Build tests before trying to install\n\nOur `install` target doesn't depend on `all` unlike the\nrpm-ostree version; not doing so is arguably better, so let's\nexplicitly build before installing.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "132bb6a82e4e8798be7ee7a1b3e7311352792716", "commit_date": "2023-06-27T06:50:49Z", "commit_message": "Merge pull request #2902 from ericcurtin/ostree-aboot-pass-options\n\nbootloader: Pass \"options\" to aboot bootloader backend", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8deb97a778e486298c91cf94347f9bae673bec1c", "commit_date": "2023-06-27T04:18:17Z", "commit_message": "Merge pull request #2901 from cgwalters/revert-fetcher-change\n\nRevert \"fetcher: Always open tmpfiles in repo location\"", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4e61e6f7d0d6aebd6abcdc455ec53164afe39e8d", "commit_date": "2023-06-27T03:03:10Z", "commit_message": "Revert \"fetcher: Always open tmpfiles in repo location\"\n\nThis reverts commit f7f6f87c513c9f35bc24f35e909779c19cb49d3a.\n\nThis seems to have broken flatpak, so we'll revert and then\ninvestigate.\n\nCloses: https://github.com/ostreedev/ostree/issues/2900", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7a91035c09d300a127521722b50148aad2ea38a7", "commit_date": "2023-06-26T23:08:48Z", "commit_message": "Merge pull request #2903 from dbnicholson/composefs-digest-fix\n\nprepare-root: Adjust to composefs mount struct changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "94b49b41e7b10b550757df77ba32138c0d5a36dd", "commit_date": "2023-06-26T15:47:00Z", "commit_message": "prepare-root: Adjust to composefs mount struct changes\n\nThis fixes a regression from the latest composefs submodule update in\n1582edd1d4a6b26874d3897de8a5586f979a0715. In composefs commit\n7560a4fd388481f479c0b3fc2e6d20c6321d9b74 the struct field was changed\nfrom the generic `expected_digest` with the thought that there may be\nother signatures or digests in the future.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "4429923681b8950953adb1f81ed5e73082d370d2", "commit_date": "2023-06-26T10:44:56Z", "commit_message": "bootloader: Pass \"options\" to aboot bootloader backend\n\naboot-deploy must know where the next root filesystem to boot is to set\nup a symlink /ostree/root.a or /ostree/root.b , this location is in the\nostree= part of these passed in options.\n\nSigned-off-by: Eric Curtin <ecurtin@redhat.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "363a1f14a8ca83842a2f27fbc76dd8cc89599b5a", "commit_date": "2023-06-21T12:06:52Z", "commit_message": "Merge pull request #2896 from akiernan/main\n\nlib/deploy: Use off_t not __off_t", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e0342d2da10db5f232a7bd162cf72b5c1dcfd6e2", "commit_date": "2023-06-21T06:31:14Z", "commit_message": "lib/deploy: Use off_t not __off_t\n\nNot clear why this was __off_t which is the sole appearance in the code\nbase, but it breaks musl builds.\n\nSigned-off-by: Alex Kiernan <alex.kiernan@gmail.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "24dd9bbe0292066c7fcf66d835484908c05c84ee", "commit_date": "2023-06-20T16:25:17Z", "commit_message": "Merge pull request #2895 from cgwalters/release\n\nRelease 2023.4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f07c93e167848cae6cc91d2fd186fc5d36178b94", "commit_date": "2023-06-20T16:22:49Z", "commit_message": "Merge pull request #2893 from cgwalters/update-prow-config\n\nci: Add some composefs testing", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ebb96242044243bac02b74327898818dce7753c9", "commit_date": "2023-06-20T15:01:57Z", "commit_message": "Merge pull request #2892 from ostreedev/dependabot/submodules/composefs-08bdb03\n\nbuild(deps): bump composefs from `c9188cd` to `08bdb03`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6035125d5b8652fb3f1c06dea4c3fc0a6556e6b", "commit_date": "2023-06-20T13:39:43Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c35149c7e06245bc4fb8b4e210cb3bfcb3c7726", "commit_date": "2023-06-20T13:39:04Z", "commit_message": "Release 2023.4", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a113b2be3f597c2e4368f840063da70389e26fb0", "commit_date": "2023-06-20T11:44:38Z", "commit_message": "Merge pull request #2891 from cgwalters/commit-compute-composefs-digest\n\nlib: Rework composefs metadata, drop custom signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6df69880de0399a22aa98f549466a30961331d3d", "commit_date": "2023-06-19T23:07:01Z", "commit_message": "ci: Sync prow config with rpm-ostree, enable composefs there\n\nI want to gain testing over the composefs path; but without\nyet changing the main Jenkins build.  Because we have duplicate/overlapping\nCI systems, we can take advantage of this by testing the composefs\nflow via Prow.\n\nSync the Prow build scripts with what's in coreos/rpm-ostree\nright now.\n\nThen let's test the composefs flow a bit more e2e there.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3c7e256cee075e2c43cd5c9b37142423c9a98342", "commit_date": "2023-06-19T23:02:20Z", "commit_message": "tests: Add a sanity check for composefs\n\nPrep for adding some coverage of this flow when booting with\ncomposefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b56da3409d8f1eb6551c9901cbe8bafbe4382d5b", "commit_date": "2023-06-19T21:29:31Z", "commit_message": "docs/composefs: Updates\n\n- fix URL\n- Document requirements\n- Document kernel argument\n- Adjust for recent changes", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1582edd1d4a6b26874d3897de8a5586f979a0715", "commit_date": "2023-06-19T12:59:34Z", "commit_message": "build(deps): bump composefs from `c9188cd` to `08bdb03`\n\nBumps [composefs](https://github.com/containers/composefs) from `c9188cd` to `08bdb03`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/c9188cd1f80374d0785e90d2e4d31749b9f91395...08bdb030fcff4f55ef63aa828b09b57a6cd4d234)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a6f2d053c89657a4542286d13460a7ef3c632bb4", "commit_date": "2023-06-17T21:08:46Z", "commit_message": "lib: Rework composefs metadata, drop custom signatures\n\nWe will be switching to handling signature verification of\nthe target ostree commit.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "dd47090e2fc3f884cced6245cfa43885b28ea694", "commit_date": "2023-06-17T15:30:49Z", "commit_message": "Merge pull request #2890 from cgwalters/composefs-err-frees\n\ncomposefs: Avoid double free in error path", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "79adccee38afb01d5d410ca61c721aa0ffafde9a", "commit_date": "2023-06-17T13:11:51Z", "commit_message": "composefs: Avoid double unref\n\nThe interaction of `iter_loop` and autofree is way too subtle;\nI happened to be reading this code and noticed we did the NULL\nreset in one path but not another.\n\nThe real fix is Rust...", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1fe2bb9f5a3ee2d138dc04124a34b17a06468525", "commit_date": "2023-06-16T18:26:01Z", "commit_message": "Merge pull request #2885 from cgwalters/doc-composefs\n\ncomposefs: Add some basic docs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "95f2c72c9f76a2514476b7bb574367e6a74809d5", "commit_date": "2023-06-15T21:35:45Z", "commit_message": "Merge pull request #2886 from daissi/wip/daissi/disable-http2\n\nostree-fetcher-curl: explicitly use HTTP1.1 when HTTP2 is disabled", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "186055d6dd962dbb4039529c89294d219e53b426", "commit_date": "2023-06-15T19:25:12Z", "commit_message": "Merge pull request #2888 from cgwalters/more-error-prefixing\n\nAdd more error prefixing when parsing commit objects", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c71fc3d9940a09287e215797926e591cd72f72c6", "commit_date": "2023-06-15T18:39:02Z", "commit_message": "Add more error prefixing when parsing commit objects\n\nI've got more debug information in the error case that motivated\nhttps://github.com/ostreedev/ostree/pull/2884/commits/bae4347abeaa2a66d213758f790058f42cb71fd1\n\"pull: Add error prefixing for corrupt checksums\"\nwhere the sole error is\n\n`error: Invalid checksum of length 0 expected 32`\n\nThis must be coming from the pull code in the case where we've\nalready fetched the commit object.\n\n- Add some error prefixing here in the core commit validation code\n- Ensure that we do the validation immediately after loading, including\n  of the parent commit reference where I think this error must be coming\n  from\n- Then the pull code can just safely call `ostree_commit_get_parent`\n  which already does the hex conversion etc.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d1ec6cdf8632f596da2fae8a105ca24724072bf7", "commit_date": "2023-06-15T13:41:16Z", "commit_message": "ostree-fetcher-curl: explicitly use HTTP1.1 when HTTP2 is disabled\n\nThe current logic to select the HTTP version to be use relies on\nthe fact that curl don't use by default HTTP2. This assumption seems wrong with\nrecent versions of curl.\n\nSigned-off-by: Dylan A\u00efssi <dylan.aissi@collabora.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "91c6b1a6d2c1b7965bbb4f63fb6a343b2b6fb0cf", "commit_date": "2023-06-14T20:41:48Z", "commit_message": "composefs: Add some basic docs\n\nLet's describe the state of things at a high level, independent\nof the tracking issue which has a lot more detail (and hence noise).\n\nThis document keeps things at a high level and describes how to\nenable things today.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "ff805f1c4f404c3501bedddc8f70c22aa2b04024", "commit_date": "2023-06-14T18:09:47Z", "commit_message": "Merge pull request #2880 from kraj/main\n\nfix build with lld linker", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c3bd439d3e9c8cfad40a8080d35c5d6b29041039", "commit_date": "2023-06-14T16:39:34Z", "commit_message": "libostree: Link with libgpg-error for gpg_strerror_r API\n\nWith f461c02bb55bf2853a3b81ed5c8618040ab54e98 use of gpg_strerror_r\nwas added this symbol comes from libgpg-error however, therefore its\nneeded to add -lgpg-error to cmdline to resolve this symbol especially\nwith gold and lld linker. Fixes\n\naarch64-yoe-linux-ld.lld: error: undefined reference due to --no-allow-shlib-undefined: gpg_strerror_r\n>>> referenced by ./.libs/libostree-1.so", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c555ad7556ea1a1a5a1fc68926823ccd9243c6ee", "commit_date": "2023-06-14T16:29:46Z", "commit_message": "Merge pull request #2884 from cgwalters/errprefix-pull-checksums\n\npull: Add error prefixing for corrupt checksums", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bae4347abeaa2a66d213758f790058f42cb71fd1", "commit_date": "2023-06-14T15:19:44Z", "commit_message": "pull: Add error prefixing for corrupt checksums\n\nI got a bug report with the bare error\n```\nerror: Invalid checksum of length 0 expected 32\n```\n\nAnd I'm pretty sure it's from here.  Add error prefixing so we\nknow exactly which metadata object was corrupt.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8971bd05ee505bd86d9e0689a31b4ff43235ae55", "commit_date": "2023-06-14T13:36:06Z", "commit_message": "Merge pull request #2881 from ostreedev/dependabot/submodules/composefs-c9188cd\n\nbuild(deps): bump composefs from `af8e1a7` to `c9188cd`", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e79591501c3b407c8e0b456272800ffb107784cb", "commit_date": "2023-06-13T22:36:32Z", "commit_message": "Merge pull request #2882 from cgwalters/more-test-concurrency\n\ntest-concurrency: Don't lower timeout", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "7892818fb183e9b510e920a6f0658a214e4aa173", "commit_date": "2023-06-13T20:17:16Z", "commit_message": "test-concurrency: Don't lower timeout\n\nI think there's never been a real race condition here.  Instead\nthe problem is:\n\n- We have a timeout on the lock, after which we error out (30s)\n- This test actually *lowers* the timeout\n\nLooking through the failures for test-concurrency what I see\nis\n`error: Locking repo exclusive failed: Resource temporarily unavailable`\nwhich is us hitting the timeout.\n\nHardcoded timeouts are just going to be subject to race conditions.\nI understand not wanting to block forever in some cases, but any\narbitrary timeout is just going to get hit in real world conditions\ntoo.\n\nAnyways for now, stop shooting ourselves in the foot and at least\nkeep the timeout at the default.\n\nCloses: https://github.com/ostreedev/ostree/issues/2038", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "92445188960d03d5b8dd1ad681beb776611984b2", "commit_date": "2023-06-13T15:02:48Z", "commit_message": "Merge pull request #2865 from barthalion/increase-metadata-size\n\nIncrease the metadata size limit to 128MB", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "40c07362c1e6cf81fa949b8c7907c0206466dfb8", "commit_date": "2023-06-13T13:46:56Z", "commit_message": "Update big metadata size in test-pull-large-metadata", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f142b7deeabaee1d1ad70643ef2a0191f4c54769", "commit_date": "2023-06-13T12:58:56Z", "commit_message": "build(deps): bump composefs from `af8e1a7` to `c9188cd`\n\nBumps [composefs](https://github.com/containers/composefs) from `af8e1a7` to `c9188cd`.\n- [Release notes](https://github.com/containers/composefs/releases)\n- [Commits](https://github.com/containers/composefs/compare/af8e1a7cf6864c27e2ceac44cc145bd78734df30...c9188cd1f80374d0785e90d2e4d31749b9f91395)\n\n---\nupdated-dependencies:\n- dependency-name: composefs\n  dependency-type: direct:production\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c4591c2d285a890c0db3789f9d8e1d727aa174af", "commit_date": "2023-06-10T15:36:03Z", "commit_message": "Merge pull request #2879 from alexlarsson/composefs-new-signature-approach\n\ncomposefs: Change how we do signatures", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "2d476611a00439e2c3744d0dad2e82156c37fa8c", "commit_date": "2023-06-10T15:13:33Z", "commit_message": "composefs: Change how we do signatures\n\nCurrently we generate a signature for the actual composefs image, and\nthen we apply that when we enable fsverity on the composefs\nimage. However, there are some issues with this.\n\nFirst of all, such a signed fs-verity image file can only be read if\nthe corresponding puiblic keyring is loaded into the fs-verity\nkeyring. In a typical secure setup we will have a per-commit key that\nis loaded from the initrd. Additionally, the keyring is often sealed\nto avoid loading more keys later.\n\nThis means you can only ever mount (or even look at) composefs images\nfrom the current boot. While this is not a huge issue it is something\nof a pain for example when debugging things.\n\nSecondly, and more problematic, during a deploy we can't enable\nfs-verity on the newly created composefs file, because and at that\npoint you need to pass in the signature. Unfortunately this will fail\nif the matching public key is not in the keyring, which will fail for\nsimilar reasons as the first issue.\n\nThe current workaround is to *not* enable fs-verity during deploy, but\nwrite the signature to a file. Then the first time the particular\ncommit is booted we apply the signature to the iamge. This works\naround issue two, but not issue one. But it causes us to do a lot of\nwrites and computation during the first boot as we need to write the\nfs-verity merkle tree to disk. It would be much better and robust if\nthe merkle tree could be written during the deployment of the update\n(i.e. before boot).\n\nThe new apporach is to always deploy an unsigned, but fs-verity\nenabled composefs image. Then we create separate files that contain\nthe expected digest, and a signature of that file. On the first boot\nwe sign the digest file, and on further boots we can just verify\nthat it is signed before using it.\n\nThis fixes issue 1, since all deploys are always readable, and it\nmakes the workaround for issue 2 much less problematic, as we only\nneed to change a much smaller file on the first boot.\n\nLong term I would like to avoid the first-boot writing totally, and\nI've been chatting with David Howells (kernel keyring maintainer) and\nhe proposed adding a new keyring syscall that verifies a PKCS#7\nsignature from userspace directly. This would be exactly what\nfs-verity does, except we wouldn't have to write the digest to disk\nduring boot, we would just read the digest file and the signature file\neach boot and ask the kernel to verify it.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "05faa1d8906c5a6d07dc4da7d1009765ac1a57c1", "commit_date": "2023-06-09T11:56:25Z", "commit_message": "Merge pull request #2877 from ericcurtin/ostree-aboot\n\nAdd ostree=aboot for signed Android Boot Images", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bb4a89e23cb7834956681159d9eac3b76cbe021c", "commit_date": "2023-06-08T17:14:50Z", "commit_message": "Update submodule: composefs\n\nWe will need the new fsverity computation helpers.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "adf60e26ce6e44bbd55d69926ab4a450bac59493", "commit_date": "2023-06-08T14:27:16Z", "commit_message": "Fix read_proc_cmdline_key (\"ot-composefs\") memory leak\n\nMake it an autofree_char rather than a char", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "aa72caffb540114a0e8635ab2990b9c8b0b8f9db", "commit_date": "2023-06-08T14:27:07Z", "commit_message": "Add ostree=aboot for signed Android Boot Images\n\nSome kernel images are delivered in a signed kernel + cmdline +\ninitramfs + dtb blob. When this is added to the commit server side, only\nafter this do you know what the cmdline is, this creates a recursion\nissue. To avoid this, in the case where we have ostree=aboot karg\nset, create a symlink after deploy to the correct ostree target in the\nrootfs, as the cmdline can't be malleable and secured client-side at\nthe same time.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "59a653c9dd3aa7aa5f0b5b49c6bec288c6cd747a", "commit_date": "2023-06-07T17:34:56Z", "commit_message": "Merge pull request #2875 from cgwalters/tempf-always-repo\n\nfetcher: Always open tmpfiles in repo location", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0a3dd22f83703972a489cd4dd26a6e712aef136c", "commit_date": "2023-06-07T08:52:06Z", "commit_message": "Merge pull request #2872 from cgwalters/composefs-followups\n\nComposefs followups", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f7f6f87c513c9f35bc24f35e909779c19cb49d3a", "commit_date": "2023-06-06T21:09:30Z", "commit_message": "fetcher: Always open tmpfiles in repo location\n\nIn an installation environment (like a live ISO) we may\nnot have significant space outside of the target installation\nrepository.\n\nThere's no reason not to always open a linkable tempfile.  In\nthe future we should fix the pull path to verify the checksum\nand then just directly link in the object instead of copying.\n\nCloses: https://github.com/ostreedev/ostree/issues/2571", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "8762062648bb72b44a5cb21a83b303bbfcfc2253", "commit_date": "2023-06-06T16:37:41Z", "commit_message": "Merge pull request #2874 from aospan/inode64-fix\n\ncommit: fix ostree deployment on 64-bit inode fs", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "de6fddc6adee09a93901243dc7074090828a1912", "commit_date": "2023-06-06T13:37:47Z", "commit_message": "commit: fix ostree deployment on 64-bit inode fs\n\nThis commit addresses a bug that was causing ostree deployment\nto become corrupted on the large fs, when any package was installed using\n'rpm-ostree install'.\n\nIn such instances, multiple files were assigned the same inode. For\nexample, the '/home' directory and a regular file 'pkg-get' were\nassigned the same inode (2147484070), making the deployment unusable.\n\nA root cause analysis was performed, running the process under gdb,\nwhich revealed a lossy conversion from guint64 to guint32, for example\n6442451366 converted to 2147484070:\n\n(gdb) p name\n$10 = 0x7fe9224d2d70 \"home\"\n\n(gdb) p inode\n$73 = 6442451366\n\n(gdb) s\n    device=66311, modifier=0x7fe914791840) at\nsrc/libostree/ostree-repo-commit.c:1590\n\nThe conversion resulted in entirely independent files potentially\nreceiving the same inode.\n\nThe issue was discovered on PoC machine equipped with a large NVME\n(3.4TB), but the bug can be easily reproduced using `cosa run -m 4000\n--qemu-size +3TB', followed by installation of any package using\n`rpm-ostree install`. The resulting deployment will be unusable due to\nmany files being \"corrupted\" by the aforementioned issue.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "12b7f328e226f151caecb26af06081da85d40744", "commit_date": "2023-06-05T17:17:58Z", "commit_message": "prepare-root: More logging in composefs, minor cleanup\n\n- Hoist the `.ostree.cfs` to a shared constant\n- Add more logging in general for extra visibility", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "624b1084ab93181ede31571db8226e4322a6171c", "commit_date": "2023-06-02T17:10:12Z", "commit_message": "prepare-root: Add another missing O_CLOEXEC", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "624512f9a7b53d31f0f6b26a9d285bc08309c477", "commit_date": "2023-06-02T14:59:34Z", "commit_message": "composefs: Factor out a shared helper for setting error\n\nTo keep the error messages consistent.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "1f9607a8e92603d505f1709ee3e7c4424614edbd", "commit_date": "2023-06-02T13:28:19Z", "commit_message": "mount-util: Add missing O_CLOEXEC\n\nSeen in review.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b6c054e1fa7d64be8c7d3ed1b815f9c82e6ceb16", "commit_date": "2023-06-02T13:26:04Z", "commit_message": "Merge pull request #2640 from alexlarsson/composefs\n\nAdd initial composefs integration", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "67929db1dc3e60e958220a018ff0665c8052b4ee", "commit_date": "2023-06-01T14:34:13Z", "commit_message": "Merge pull request #2871 from dustymabe/dusty-fallocate-einval\n\nlib/deploy: skip fallocate call when requested size is 0", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "68d1d9a7fc08c281174f57b638fa06f7aea73601", "commit_date": "2023-06-01T13:25:35Z", "commit_message": "lib/deploy: skip fallocate call when requested size is 0\n\nIf the requested size is 0 then of course we have enough room \ud83d\ude42\n\nThis avoids the fallocate call returning an EINVAL.\n\nCloses: #2869", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "5eacc96df321039e36bd237824d0c1b7ed8af6ef", "commit_date": "2023-06-01T12:24:48Z", "commit_message": "Merge pull request #2870 from dustymabe/dusty-log-messages\n\nlib/deploy: Disambiguate error messages for early prune space check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a51535b0cd9f64702c35a04d54f42b2998403b67", "commit_date": "2023-06-01T04:00:28Z", "commit_message": "lib/deploy: Disambiguate error messages for early prune space check\n\nHaving the same error message in multiple places means it's not\nclear which case failed. Let's make them unique.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "733380394922f441f743ee57d626ad631f418d5c", "commit_date": "2023-05-31T16:35:44Z", "commit_message": "composefs: When using signatures, delay application until first boot\n\nWe can't safely apply the fs-verity with signature until we have\nbooted with the new initrd, because the public key that matches the\nsignature is loaded from it. So, instead we save the .sig file next\nto the compoosefs, and on the first boot we detect that it is there, and\nthe composefs file isn't fs-verity, so we apply it.\n\nThings get a bit more complex due to having to temporarily make\n/sysroot read-write for the fsverity operation too.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "6d2dc959686e530dfd0b4e1ef8c4b480d9a01e1b", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "CI: Build with composefs on some versions\n\nThis enables --with-composefs on:\n * Fedora Latest\n * Debian Testing\n * Ubuntu Latest\n\nThese all should have new enough version of dependencies.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e3be4ee52acc4079eaae6e87ffe7f210763e76ad", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "Update submodule: composefs\n\nInstead of using pkg-config, etc we just include composefs.\nIn the end the library is just 5 c source files, and it is set up\nto be easy to use as a submodule.\n\nFor now, composefs support is disabled by default.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f9bdc66649a90e8834d5fa9adb65ede9b2453b8b", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "ostree-remount: Don't skip remount if root is composefs\n\nWhen using composefs the root fs will always be read-only, but in this\ncase we should still continue remounting /sysroot. So, we record a\n/run/ostree-composefs-root.stamp file in ostree-prepare-root if composefs\nis used, and then react to it in ostree-remount.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "d47a90347ba4e72ae223d4eb59287a42d32a5df0", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "sysroot: Ensure deployment detection works when using composefs\n\nIn the case of composefs, we cannot compare the devino of the rootfs\nand the deploy dir, because the root is the composefs mount, not a\nbind mount. Instead we check the devino of the etc subdir of the\ndeploy, because this is a bind mount even when using composefs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "11d7587e403c897ad918ed8bc6d437e17f86c4c0", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "prepare-root: Support using composefs as root filesystem\n\nThis changes ostree-prepare-root to use the .ostree.cfs image as a\ncomposefs filesystem, instead of the checkout.\n\nBy default, composefs is used if support is built in and the .ostree.cfs\nfile exists in the deploy dir, otherwise we fall back to the old\nmethod. However, if the ot-composefs kernel option is specified this\ncan be tweaked as per:\n * off: Never use composefsz\n * maybe: Use if possible\n * on: Fail if not possible\n * signed: Fail if the cfs image is not fs-verity signed with\n   a key in the keyring.\n * digest=....: Fail if the cfs image does not match the specified\n   digest.\n\nThe final layout when composefs is active is:\n\n /        ro overlayfs mount for composefs\n /sysroot \"real\" root\n /etc     rw bind mount to $deploydir/etc\n /var     rw bind mount to $vardir\n\nWe also specify the $deploydir/.ostree-mnt directory as the (internal)\nmountpoint for the erofs mount for composefs. This can be used to map\nthe root fs back to the deploy id/dir in use,\n\nA further note: I didn't test the .usr-ovl-work overlayfs case, but a\ncomment mentions that you can't mount overlayfs on top of a readonly\nmount. That seems incompatible with composefs. If this is needed we\nhave to merge that with the overlayfs that composefs itself sets up,\nwhich is possible with the libcomposefs APIs.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "bba3109fe2a746b59424369f839c8380fb9b35a7", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "switchroot: Make read_proc_cmdline_ostree() take a key argument\n\nThis changes it into read_proc_cmdline_key(), as this will later be\nused to read additional keys.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "3fcebe454ed78df378b656af2013e43c648dbe46", "commit_date": "2023-05-31T08:57:37Z", "commit_message": "composefs deploy: Store cfs signature in .ostree.cfs.sig file\n\nIn many cases, such as when using osbuild, we are not preparing the final\ndeployment but rather a rootfs tree that will eventually be copied to the\nfinal location. In that case we don't want to apply the signature directly\nbut when the deployment is copied in place.\n\nTo make this situateion workable we also write the signature to a file\nnext to the composefs image file. Then whatever mechanism that does\nthe final copy can apply the signature.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c988ff79387b5b61a1134c5f0d91010b0a280fd6", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "deploy: Write a .ostree.cfs composefs image in the deploy dir\n\nThis can be used as a composefs source for the root fs instead of\nthe checkout by pointing the basedir to /ostree/repo/objects.\n\nWe only write the file is `composefs` is enabled.\n\nWe enable ensure_rootfs_dirs when building the image which adds the\nrequired root dirs to the image. In particular, this includes /etc\nwhich often isn't in ostree commits in use.\n\nWe also create an (empty) .ostree.mnt directory, where composefs\nwill mount the erofs image that will be used as overlayfs lowerdir\nfor the root overlayfs mount. This way we can find the deploy\ndir from the root overlayfs mount options.\n\nIf the commit has composefs digests recorded we verify those with the\ncreated file. It also applies the fs-verity signature if it is\nrecorded, unless this is disabled with the\nex-integrity.composefs-apply-sign=false option.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0c3d9894be1f1fa0a825aa7b16c119b72c4edc7e", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "Commit: Add composefs digest and sig to the commit metadata\n\nIf `composefs-apply-sig` is enabled (default no) we add an\nostree.composefs digest to the commit metadata. This can be verified\non deploy.\n\nThis is a separate option from the generic `composefs` option which\ncontrols whether composefs is used during deploy. It is separate\nbecause we want to not have to force use of fs-verity, etc during the\nbuild.\n\nIf the `composefs-certfile` and `composefs-keyfile` keys in the\nex-integrity group are set, then the commit metadata also gets a\nostree.composefs-sig containing the signature of the composefs file.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "e2956e2c08fb3e11e249b540db3a5b760dd04fac", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "lib: Add (private) API for checking out commits into a composefs image\n\nThis supports checking out a commit into a tree which is then\nconverted into a composefs image containing fs-verity digests for all\nthe regular files, and payloads that are relative to a the\n`repo/objects` directory of a bare ostree repo.\n\nSome specal files are always created in the image. This ensures that\nvarious directories (usr, etc, boot, var, sysroot) exists in the\ncreated image, even if they were not in the source commit. These are\nneeded (as bindmount targets) if you want to boot from the image. In\nthe non-composefs case these are just created as needed in the checked\nout deploydir, but we can't do that here.\n\nThis is all controlled by the new ex-integrity config section, which\nhas the following layout:\n\n```\n[ex-integrity]\nfsverity=yes/no/maybe\ncomposefs=yes/no/maybe\ncomposefs-apply-sig=yes/no\ncomposefs-add-metadata=yes/no\ncomposefs-keyfiile=/a/path\ncomposefs-certfile=/a/path\n```\n\nThe `fsverity` key overrides the old `ex-fsverity` section if\nspecified.  The default for all these is for the new behaviour to be\ndisabled. Additionally, enabling composefs implies fsverity defaults\nto `maybe`, to avoid having to set both.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "9ba98cd8e98ae9501dc1c03ff69920b94f8cd429", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "fsverity: Support passing a signature when enabling fs-verity\n\nThe composefs code will need this.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c6ed5cc7b2e09730fda8d7c0b2502774796020e8", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "fsverity: Add _ostree_fsverity_sign helper\n\nThis code signs a fsverity digest (using openssl) such that the\nresulting signature can be used with the FS_IOC_ENABLE_VERITY ioctl.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "02d24d2a3854185cb1f4174f04efa59f1c6d53e9", "commit_date": "2023-05-31T08:55:14Z", "commit_message": "Add ot_keyfile_get_tristate_with_default() helper\n\nThis parses keys like yes/no/maybe. The introduced OtTristate type\nis compatible with the existing _OstreeFeatureSupport type.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "0dd2788410be83a588501e3589947f5ce70f6d37", "commit_date": "2023-05-30T13:15:40Z", "commit_message": "Merge pull request #2864 from cgwalters/prepare-root-prepare-composefs\n\nprepare-root: Move sysroot.tmp creation earlier", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "f903d6af6735289abc6b0c50a742f1d29df22df6", "commit_date": "2023-05-30T12:38:16Z", "commit_message": "Merge pull request #2866 from jlebon/pr/autoprune-tweaks\n\nlib/deploy: Use `fallocate` for early prune space check", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "193ef29f3f0886e3d59e6580e394f8817f2f123e", "commit_date": "2023-05-29T16:17:05Z", "commit_message": "lib/deploy: Use `fallocate` for early prune space check\n\nThe `f_bfree` member of the `statvfs` struct is documented as the\n\"number of free blocks\". However, different filesystems have different\ninterpretations of this. E.g. on XFS, this is truly the number of blocks\nfree for allocating data. On ext4 however, it includes blocks that\nare actually reserved by the filesystem and cannot be used for file\ndata. (Note this is separate from the distinction between `f_bfree` and\n`f_bavail` which isn't relevant to us here since we're privileged.)\n\nIf a kernel and initrd is sized just right so that it's still within the\n`f_bfree` limit but above what we can actually allocate, the early prune\ncode won't kick in since it'll think that there is enough space. So we\nend up hitting `ENOSPC` when we actually copy the files in.\n\nRework the early prune code to instead use `fallocate` which guarantees\nus that a file of a certain size can fit on the filesystem. `fallocate`\nrequires filesystem support, but all the filesystems we care about for\nthe bootfs support it (including even FAT).\n\n(There's technically a TOCTOU race here that existed also with the\n`statvfs` code where free space could change between when we check\nand when we copy. Ideally we'd be able to pass down that fd to the\ncopying bits, but anyway in practice the bootfs is pretty much owned by\nlibostree and one doesn't expect concurrent writes during a finalization\noperation.)", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "76649127d1f415abdfd2e8de62ce8a2beef5f412", "commit_date": "2023-05-28T22:39:03Z", "commit_message": "lib/deploy: Rename variable for clarity\n\n`size_to_remove` looks cryptic in contrast to\n`new_new_bootcsum_dirs_total_size`. Rename it in the style of the latter\nfor easier reading.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "a3c0d6a3fee7958ebfb6f8bc3c70f053be5c3085", "commit_date": "2023-05-28T22:38:53Z", "commit_message": "lib/deploy: Log case when auto-pruning is hopeless\n\nFor easier diagnostics.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "115d5cf0730cd39b3a27799bd15dfb17ba97c9b4", "commit_date": "2023-05-28T22:38:38Z", "commit_message": "lib/deploy: Drop unused variable\n\nNoticed this diagnostic in my editor with clangd hooked up.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "632ffa430205473e6727e3402016ad8077164dea", "commit_date": "2023-05-27T14:38:14Z", "commit_message": "lib/deploy: Initialize var to pacify gcc static analysis\n\nClassic case of analysis getting confused by variables initialized by\na function.", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "c22576c41de469637b4e6098644295ba65d7e21d", "commit_date": "2023-05-24T19:50:38Z", "commit_message": "prepare-root: Move sysroot.tmp creation earlier\n\nMain motivation is prep for composefs in\nhttps://github.com/ostreedev/ostree/pull/2640\nIn the interest of that, we add a `bool using_composefs` but\nit's currently always `false`.\n\nCo-authored-by: Alexander Larsson <alexl@redhat.com>", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "50790b285e5b5c72c76ea4017850cafa26f40e51", "commit_date": "2023-05-22T17:37:10Z", "commit_message": "Merge pull request #2860 from cgwalters/xshell2\n\ntests: A bit more xshell porting", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "b5b3ef78af6c6a52a7ac11c06f80cb8eea67782b", "commit_date": "2023-05-18T21:09:04Z", "commit_message": "Merge pull request #2859 from jmarrero/release-2023.3\n\nRelease 2023.3", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88e8b671ce03135b30411a129664f9ac46e24adb", "commit_date": "2023-05-18T12:14:50Z", "commit_message": "tests: A bit more xshell porting\n\nPart of https://github.com/ostreedev/ostree/issues/2857", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}, {"commit_oid": "88fe600ff8e498e0648258d9a56fd4008808ea33", "commit_date": "2023-05-17T20:32:43Z", "commit_message": "configure: post-release version bump", "commit_author": "", "message_analysis": {"glm6b_2": [], "manual": [], "noob_engine": []}}]}